var $n=Object.defineProperty;var An=(n,e,t)=>e in n?$n(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var g=(n,e,t)=>(An(n,typeof e!="symbol"?e+"":e,t),t),Ya=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var o=(n,e,t)=>(Ya(n,e,"read from private field"),t?t.call(n):e.get(n)),p=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},h=(n,e,t,i)=>(Ya(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t);var c=(n,e,t)=>(Ya(n,e,"access private method"),t);import*as Bn from"https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.mjs";import"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.js";import"https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.4.0/backbone.js";import"https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.5.5/joint.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(a){if(a.ep)return;a.ep=!0;const r=t(a);fetch(a.href,r)}})();var $t,Ui,wo,ji,Io;class Dn{constructor(){p(this,Ui);p(this,ji);p(this,$t,"applicationNameInputField")}renderApplicationFrame(e){$("#"+e).empty(),$("#"+e).append(this.getApplicationFrameTemplate)}getApplicationFrameTemplate(){return`${c(this,Ui,wo).call(this)}${c(this,ji,Io).call(this)}`}get getApplicationNameElementId(){return o(this,$t)}}$t=new WeakMap,Ui=new WeakSet,wo=function(){return`<div id="init-overlay" class="init-overlay">
            <div class="init-overlay-content">
                <h2 class="user-select-none text-center">Welcome to the CNA Modeling Application!</h2>
                <div id="init-firstInformation">
                    <p class="user-select-none">The modeling application allows you to model cloud-native application (CNA) architectures using thirteen different entities. It is based on the CNA quality model 
                    as introduced here: https://github.com/r0light/cna-quality-model/tree/9058f6236e8e0b1cceee9abf67a96e927140d0fa. In addition, the application supports exporting the graphical model into an 
                    extended version of the TOSCA architecture description language. The extended TOSCA version is being introduced here: https://github.com/KarolinDuerr/MA-CNA-ModelingSupport/tree/main/TOSCA_Extension.</p>
                    <button id="createNewDiagramBtn" type="button" class="btn btn-outline-dark btn-light"><i
                            class="fa-solid fa-pencil"></i> Create new
                        diagram</button>
                </div>
                <div id="startModelingForm">
                    <p class="user-select-none">Please type the application name of the System entity you want to model 
                        in the following form. Afterwards, you can start modeling your application's architecture.</p>
                    <form class="needs-validation" novalidate>
                        <div class="form-row">
                            <div class="input-group has-validation">
                                <div class="input-group-prepend">
                                    <span class="user-select-none input-group-text">Application Name</span>
                                </div>
                                <input name="systemName" type="text" class="form-control"
                                    id="${o(this,$t)}" placeholder="Application name of your System"
                                    required>
                                <div class="validationError invalid-feedback">
                                    Please provide an application name.
                                </div>
                            </div>
                            <div class="startModelingBtnArea form-group row">
                                <div class="col-auto">
                                    <button id="startModelingBtn" type="button" class="btn btn-outline-dark"><i
                                            class="fa-solid fa-pencil"></i> Start
                                        modeling</button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>`},ji=new WeakSet,Io=function(){return`<div id="app">
            <div id="appToolbarContainer" class="app-header d-print-none"></div>
            <div class="app-body">
                <div class="entityShapes-sidebar-container d-print-none"></div>
                <div class="visible-modeling-area"></div>
                <div class="details-container d-print-none"></div>
            </div>
            <div id="modals" class="d-print-none"></div>
        </div>`};const d=Object.freeze({COMPONENT:"component",SERVICE:"service",BACKING_SERVICE:"backing-service",STORAGE_BACKING_SERVICE:"storage-backing-service",ENDPOINT:"endpoint",EXTERNAL_ENDPOINT:"external-endpoint",LINK:"link",INFRASTRUCTURE:"infrastructure",DEPLOYMENT_MAPPING:"deployment-mapping",REQUEST_TRACE:"request-trace",DATA_AGGREGATE:"data-aggregate",BACKING_DATA:"backing-data"});var Xi,At,Bt;class It{constructor(e,t,i){p(this,Xi,void 0);g(this,"name");p(this,At,void 0);p(this,Bt,void 0);this.name=t,h(this,Bt,i),h(this,At,e)}get getId(){return o(this,Xi)}get getName(){return this.name}get getModelId(){return o(this,At)}get getIncludedData(){return o(this,Bt)}toString(){return"BackingData "+JSON.stringify(this)}}Xi=new WeakMap,At=new WeakMap,Bt=new WeakMap;Object.freeze({SEND_TO:"send-to",RECEIVE_FROM:"receive-from",GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE"});var Dt,Rt,_t,Vi,ko;class kt{constructor(e,t,i,a,r){p(this,Vi);p(this,Dt,void 0);p(this,Rt,void 0);p(this,_t,void 0);g(this,"endpointType");g(this,"endpointName");g(this,"port");h(this,Rt,e),this.endpointType=t,this.endpointName=i,this.port=a,h(this,_t,r),h(this,Dt,c(this,Vi,ko).call(this,r))}get getNameId(){return o(this,Dt)}get getModelId(){return o(this,Rt)}get getEndpointType(){return this.endpointType}get getEndpointName(){return this.endpointName}get getPort(){return this.port}get getParentName(){return o(this,_t)}toString(){return"Endpoint "+JSON.stringify(this)}}Dt=new WeakMap,Rt=new WeakMap,_t=new WeakMap,Vi=new WeakSet,ko=function(e){var i;let t;if((i=this.endpointType)!=null&&i.toLowerCase().includes("topic"))t=this.endpointName+"-"+this.endpointType.replace(/Topic/gi,"").trim();else{let a=`${this.endpointType.slice(0,1).toUpperCase()}${this.endpointType.slice(1).toLowerCase()}`,r=this.endpointName.split("/"),s="";for(const l of r)if(l.includes("?")){let u=l.split("?"),m=u[1].split("=");console.log(m),s+=`${u[0].slice(0,1).toUpperCase()}${u[0].slice(1).toLowerCase()}By${m[0].slice(0,1).toUpperCase()}${m[0].slice(1).toLowerCase()}`}else if(l.includes("{")){let u=l.replace("{","").replace("}","");s+=`By${u.slice(0,1).toUpperCase()}${u.slice(1).toLowerCase()}`}else l===""||(s+=`${l.slice(0,1).toUpperCase()}${l.slice(1).toLowerCase()}`);t=a+s}return`${e}-${t}`};class zi extends kt{constructor(e,t,i,a,r){super(e,t,i,a,r)}toString(){return"ExternalEndpoint "+JSON.stringify(this)}}var Ot,ze;class qi{constructor(e,t){g(this,"name");p(this,Ot,void 0);p(this,ze,void 0);this.name=e,h(this,Ot,t),h(this,ze,new Array)}addPersistedByEntity(e){o(this,ze).push(e)}get getModelId(){return o(this,Ot)}get getName(){return this.name}get getPersistedBy(){return o(this,ze)}toString(){return"DataAggregate "+JSON.stringify(this)}}Ot=new WeakMap,ze=new WeakMap;const we=Object.freeze({COMPUTE:"compute",DBMS:"dbms"});var Ki,Pt,Mt,Ft,Lt;class re{constructor(e,t,i){p(this,Ki,void 0);p(this,Pt,void 0);p(this,Mt,void 0);g(this,"name");p(this,Ft,void 0);p(this,Lt,new Array);this.name=e,h(this,Pt,t),h(this,Mt,Object.values(we).includes(i)?i:we.COMPUTE)}addBackingDataEntity(e){if(e instanceof It){o(this,Lt).push(e);return}const t="The provided entity cannot be added. Only BackingData entities are allowed. However, the object to add was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t,"component.js")}addHostingEntity(e){h(this,Ft,e)}get getId(){return o(this,Ki)}get getModelId(){return o(this,Pt)}get getInfrastructureType(){return o(this,Mt)}get getName(){return this.name}get getBackingDataEntities(){return o(this,Lt)}get getHostedBy(){return o(this,Ft)}toString(){return"Infrastructure "+JSON.stringify(this)}toJson(){return JSON.stringify(this.getModelId)}}Ki=new WeakMap,Pt=new WeakMap,Mt=new WeakMap,Ft=new WeakMap,Lt=new WeakMap;var Ji,Gt,Wt,zt,qt,Ht,Ut,jt;class te{constructor(e,t,i){p(this,Ji,void 0);p(this,Gt,void 0);g(this,"name");p(this,Wt,void 0);p(this,zt,new Array);p(this,qt,new Array);p(this,Ht,new Array);p(this,Ut,new Array);p(this,jt,new Array);this.name=e,h(this,Gt,t),h(this,Wt,i)}addEntity(e){let t=a=>this.getEndpointEntities.some(r=>JSON.stringify(r)===JSON.stringify(a))?!0:!!this.getExternalEndpointEntities.some(r=>JSON.stringify(r)===JSON.stringify(a));if(e instanceof zi){if(t(e))return;o(this,qt).push(e);return}else if(e instanceof kt){if(t(e))return;o(this,zt).push(e);return}else if(e instanceof qi){o(this,Ut).push(e);return}else if(e instanceof It){o(this,Ht).push(e);return}const i="The provided entity cannot be added. Only Endpoint, ExternalEndpoint, DataAggregate or BackingData entities are allowed. However, the object to add was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(i,"component.js")}addLinkEntity(e){o(this,jt).push(e)}get getId(){return o(this,Ji)}get getModelId(){return o(this,Gt)}get getName(){return this.name}get getHostedBy(){return o(this,Wt)}get getEndpointEntities(){return o(this,zt)}get getExternalEndpointEntities(){return o(this,qt)}get getDataAggregateEntities(){return o(this,Ut)}get getBackingDataEntities(){return o(this,Ht)}get getIncludedLinkEntities(){return o(this,jt)}toString(){return"Component "+JSON.stringify(this)}toJson(){return JSON.stringify(this.getModelId)}}Ji=new WeakMap,Gt=new WeakMap,Wt=new WeakMap,zt=new WeakMap,qt=new WeakMap,Ht=new WeakMap,Ut=new WeakMap,jt=new WeakMap;class uo extends te{constructor(e,t,i){super(e,t,i)}toString(){return"BackingService "+JSON.stringify(this)}}class go extends te{constructor(e,t,i){super(e,t,i)}toString(){return"Service "+JSON.stringify(this)}}var Xt,Vt,Ie,ke;class Za{constructor(e,t,i){p(this,Xt,void 0);p(this,Vt,void 0);p(this,Ie,void 0);p(this,ke,void 0);if(t.toJson()===i.toJson()){const a="The entities for which the DeploymentMapping is defined have to be distinguishable.";throw new Error(a)}if(!(t instanceof te||t instanceof re)){const a="Wrong entity type provided. Only Component, Service, BackingService, StorageBackingService or Infrastructure entities can be deployed by an underlying Infrastructure. However, the provided entity was: "+Object.getPrototypeOf(t)+JSON.stringify(t);throw new TypeError(a)}if(!(i instanceof re)){const a="Wrong entity type provided. Only an Infrastructure entity is able to deploy other entities. However, the provided entity was: "+Object.getPrototypeOf(i)+JSON.stringify(i);throw new TypeError(a)}h(this,Vt,e),h(this,Ie,t),h(this,ke,i),h(this,Xt,t.name+"-"+i.name)}get getId(){return o(this,Xt)}get getModelId(){return o(this,Vt)}get getDeployedEntity(){return o(this,Ie)}set setDeployedEntity(e){if(!(e instanceof te||e instanceof re)){const t="Wrong entity type provided. Only Component, Service, BackingService, StorageBackingService or Infrastructure entities can be deployed by an underlying Infrastructure. However, the provided entity was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t)}if(JSON.stringify(e)===JSON.stringify(o(this,ke))){const t="The entity is already included as the underyling infrastructure.";throw new Error(t)}h(this,Ie,e)}get getUnderlyingInfrastructure(){return o(this,ke)}set setUnderlyingInfrastructure(e){if(!(underlyingInfrastructure instanceof re)){const t="Wrong entity type provided. Only an Infrastructure entity is able to deploy other entities. However, the provided entity was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t)}if(JSON.stringify(e)===JSON.stringify(o(this,Ie))){const t="The entity is already included as the underyling infrastructure.";throw new Error(t)}h(this,ke,e)}toString(){return"DeploymentMapping "+JSON.stringify(this)}}Xt=new WeakMap,Vt=new WeakMap,Ie=new WeakMap,ke=new WeakMap;class yo extends te{constructor(e,t,i){super(e,t,i)}toString(){return"StorageBackingService "+JSON.stringify(this)}}var Yi,Kt,qe,be,Jt;class Hi{constructor(e,t,i){p(this,Yi,void 0);p(this,Kt,void 0);p(this,qe,void 0);p(this,be,void 0);p(this,Jt,void 0);if(!(t instanceof te)){const r="Wrong entity type provided. Only Component, Service, BackingService or StorageBackingService entity allowed. However, the provided entity was: "+Object.getPrototypeOf(t)+JSON.stringify(t);throw new TypeError(r)}if(!(i instanceof kt)){const r="Wrong entity type provided. Only Endpoint or ExternalEndpoint entity allowed. However, the provided entity was: "+Object.getPrototypeOf(i)+JSON.stringify(i);throw new TypeError(r)}if((r=>t.getEndpointEntities.some(s=>JSON.stringify(s)===JSON.stringify(r))?!0:!!t.getExternalEndpointEntities.some(s=>JSON.stringify(s)===JSON.stringify(r)))(i)){const r="A Link cannot be created from an entity to its own included Endpoint.";throw new Error(r)}h(this,Kt,e),h(this,qe,t),h(this,be,i)}addRelationType(e){h(this,Jt,e)}get getId(){return o(this,Yi)}get getModelId(){return o(this,Kt)}get getSourceEntity(){return o(this,qe)}set setSourceEntity(e){if(!(newSourceEndpoint instanceof te)){const t="Wrong entity type provided. Only Component, Service, BackingService or StorageBackingService entity allowed. However, the provided entity was: "+Object.getPrototypeOf(newSourceEndpoint)+JSON.stringify(newSourceEndpoint);throw new TypeError(t)}if(endpointAlreadyIncluded(o(this,be))){const t="A Link cannot connect an entity to its own included Endpoint.";throw new Error(t)}h(this,qe,e)}get getTargetEntity(){return o(this,be)}set setTargetEntity(e){if(!(targetEndpoint instanceof kt)){const t="Wrong entity type provided. Only Endpoint or ExternalEndpoint entity allowed. However, the provided entity was: "+Object.getPrototypeOf(targetEndpoint)+JSON.stringify(targetEndpoint);throw new TypeError(t)}if(endpointAlreadyIncluded(o(this,be))){const t="A Link cannot connect an entity to its own included Endpoint.";throw new Error(t)}h(this,be,e)}get getRelationType(){return o(this,Jt)}toString(){return"Link "+JSON.stringify(this)}}Yi=new WeakMap,Kt=new WeakMap,qe=new WeakMap,be=new WeakMap,Jt=new WeakMap;var Qi,Yt,Qt,He,Ee,Ue;class eo{constructor(e,t,i,a){p(this,Qi,void 0);p(this,Yt,void 0);p(this,Qt,void 0);p(this,He,void 0);p(this,Ee,new Set);p(this,Ue,new Map);if(!(i instanceof zi)){const s="Wrong entity type provided. Only an ExternalEndpoint entity is allowed. However, the provided entity was: "+(i?Object.getPrototypeOf(i)+JSON.stringify(i):"null");throw new TypeError(s)}if(a instanceof Array)for(const r of a){if(o(this,Ee).has(r))return;o(this,Ee).add(r)}else{if(o(this,Ee).has(linkEntity))return;o(this,Ee).add(linkEntity)}h(this,Qt,e),h(this,Yt,t),h(this,He,i)}addLinkEntity(e){if(!(e instanceof Hi)){const i="Wrong entity type provided. Only an Link entity is allowed. However, the provided entity was: "+(e?Object.getPrototypeOf(e)+JSON.stringify(e):"null");throw new TypeError(i)}o(this,Ue).has(e.getModelId)||o(this,Ue).set(e.getModelId,e)}get getId(){return o(this,Qi)}get getModelId(){return o(this,Yt)}get getName(){return o(this,Qt)}get getExternalEndpoint(){return o(this,He)}set setExternalEndpoint(e){if(!(e instanceof zi)){const t="Wrong entity type provided. Only an ExternalEndpoint entity is allowed. However, the provided entity was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t)}h(this,He,e)}get getLinkEntityIds(){return o(this,Ee)}get getLinkEntities(){var e;return(e=Array.from(o(this,Ue).values()))!=null?e:new Array}toString(){return"RequestTrace "+JSON.stringify(this)}}Qi=new WeakMap,Yt=new WeakMap,Qt=new WeakMap,He=new WeakMap,Ee=new WeakMap,Ue=new WeakMap;var je,Xe,Ve,Ke,Je,Ye,Qe,Ze;class Rn{constructor(e){p(this,je,void 0);p(this,Xe,new Map);p(this,Ve,new Map);p(this,Ke,new Map);p(this,Je,new Map);p(this,Ye,new Map);p(this,Qe,new Map);p(this,Ze,new Map);h(this,je,e)}addEntities(e){for(const t of e)this.addEntity(t)}addEntity(e){switch(e.constructor){case te:case go:case uo:case yo:this.addComponentEntity(e);break;case Hi:this.addLinkEntity(e);break;case re:this.addInfrastructureEntity(e);break;case Za:this.addDeploymentMappingEntity(e);break;case eo:this.addRequestTraceEntity(e);break;case qi:this.addDataAggregateEntity(e);break;case It:this.addBackingDataEntity(e);break;default:const t="Wrong entity type provided. The provided entity was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t)}}addComponentEntity(e){if(!(e instanceof te)){const t="Wrong entity type provided. Only Component, Service, BackingService or StorageBackingService entity can be added here. However, the provided entity was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t)}o(this,Xe).set(e.getModelId,e)}addLinkEntity(e){if(!(e instanceof Hi)){const t="Wrong entity type provided. Only Link entity can be added here. However, the provided entity was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t)}o(this,Ve).set(e.getModelId,e)}addInfrastructureEntity(e){if(!(e instanceof re)){const t="Wrong entity type provided. Only Infrastructure entity can be added here. However, the provided entity was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t)}o(this,Ke).set(e.getModelId,e)}addDeploymentMappingEntity(e){if(!(e instanceof Za)){const t="Wrong entity type provided. Only Deployment Mapping entity can be added here. However, the provided entity was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t)}o(this,Je).set(e.getModelId,e)}addRequestTraceEntity(e){if(!(e instanceof eo)){const t="Wrong entity type provided. Only RequestTrace entity can be added here. However, the provided entity was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t)}o(this,Ye).set(e.getModelId,e)}addDataAggregateEntity(e){if(!(e instanceof qi)){const t="Wrong entity type provided. Only DataAggregate entity can be added here. However, the provided entity was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t)}o(this,Qe).set(e.getName,e)}addBackingDataEntity(e){if(!(e instanceof It)){const t="Wrong entity type provided. Only Component, Service, BackingService or StorageBackingService entity can be added here. However, the provided entity was: "+Object.getPrototypeOf(e)+JSON.stringify(e);throw new TypeError(t)}o(this,Ze).set(e.getName,e)}resetAllIncludedSystemEntities(){h(this,Xe,new Map),h(this,Ve,new Map),h(this,Ke,new Map),h(this,Je,new Map),h(this,Ye,new Map),h(this,Qe,new Map),h(this,Ze,new Map)}set setSystemName(e){!e||!e.trim()||h(this,je,e)}get getSystemName(){return o(this,je)}get getComponentEntities(){return o(this,Xe)}get getLinkEntities(){return o(this,Ve)}get getInfrastructureEntities(){return o(this,Ke)}get getDeploymentMappingEntities(){return o(this,Je)}get getRequestTraceEntities(){return o(this,Ye)}get getDataAggregateEntities(){return o(this,Qe)}get getBackingDataEntities(){return o(this,Ze)}toString(){return"System "+JSON.stringify(this)}}je=new WeakMap,Xe=new WeakMap,Ve=new WeakMap,Ke=new WeakMap,Je=new WeakMap,Ye=new WeakMap,Qe=new WeakMap,Ze=new WeakMap;const A=Object.freeze({MISSING_INFORMATION:"missing information",INVALID_MODEL_ENTIY:"invalid model entity"});var Zt,ei,ti,ii,ai;class B{constructor(e,t,i,a,r){p(this,Zt,void 0);p(this,ei,void 0);p(this,ti,void 0);p(this,ii,void 0);p(this,ai,void 0);!Object.values(d).includes(e)||!Object.values(A).includes(t)||!i||!r||(h(this,Zt,e),h(this,ti,t),h(this,ei,i),h(this,ii,a),h(this,ai,r))}get getAffectedEntityType(){return o(this,Zt)}get getErrorType(){return o(this,ti)}get getEntityName(){return o(this,ei)}get getAffectedInformation(){return o(this,ii)}get getMessage(){return o(this,ai)}}Zt=new WeakMap,ei=new WeakMap,ti=new WeakMap,ii=new WeakMap,ai=new WeakMap;class No{constructor(e,t="",i=""){g(this,"modelId");g(this,"position");g(this,"size");this.modelId=e,this.position=t,this.size=i}}class _n{constructor(e,t,i,a,r){g(this,"type","cna.qualityModel.entities.Compute.Infrastructure");g(this,"metadata");g(this,"requirements");var s,l;if(this.metadata=new No(e,a,r),this.requirements=new Array,t){let u={node:(s=t.infrastructure)==null?void 0:s.replace(/\s+/g,""),relationship:(l=t.deploymentMapping)==null?void 0:l.replace(/\s+/g,"")};this.requirements.push({host:u})}for(const u of i)this.requirements.push({uses_backing_data:u==null?void 0:u.replace(/\s+/g,"")})}}class On{constructor(e,t,i,a,r){g(this,"type","cna.qualityModel.entities.DBMS.Infrastructure");g(this,"metadata");g(this,"requirements");var s,l;if(this.metadata=new No(e,a,r),this.requirements=new Array,t){let u={node:(s=t.infrastructure)==null?void 0:s.replace(/\s+/g,""),relationship:(l=t.deploymentMapping)==null?void 0:l.replace(/\s+/g,"")};this.requirements.push({host:u})}for(const u of i)this.requirements.push({uses_backing_data:u==null?void 0:u.replace(/\s+/g,"")})}}class Pn{constructor(e){g(this,"modelId");this.modelId=e}}class Mn{constructor(){g(this,"provided_data");this.provided_data={type:"tosca.capabilities.Attachment"}}}class Fn{constructor(e,t){g(this,"type","cna.qualityModel.entities.DataAggregate");g(this,"metadata");g(this,"requirements");g(this,"capabilities");this.metadata=new Pn(e),this.requirements=new Array;for(const i of t)this.requirements.push({persistence:i==null?void 0:i.replace(/\s+/g,"")});this.capabilities=new Mn}}class Ln{constructor(e){g(this,"modelId");this.modelId=e}}class Gn{constructor(e){g(this,"included_data");this.included_data={};for(const t of e)this.included_data[t.key]=t.value}}class Wn{constructor(){g(this,"provided_data");this.provided_data={type:"tosca.capabilities.Attachment"}}}class zn{constructor(e,t){g(this,"type","cna.qualityModel.entities.BackingData");g(this,"metadata");g(this,"properties");g(this,"capabilities");this.metadata=new Ln(e),this.properties=new Gn(t),this.capabilities=new Wn}}class qn{constructor(e,t){g(this,"modelId");g(this,"type_of_relation");this.modelId=e,this.type_of_relation=t}}class Hn{constructor(e,t,i){g(this,"type","cna.qualityModel.entities.ConnectsTo.Link");g(this,"metadata");g(this,"properties");this.metadata=new qn(e,i),this.properties={target_endpoint:t}}}class Un{constructor(e){g(this,"modelId");this.modelId=e}}class jn{constructor(e){g(this,"type","tosca.relationships.HostedOn");g(this,"metadata");this.metadata=new Un(e)}}class Xn{constructor(e,t){g(this,"node_templates");g(this,"relationship_templates");this.node_templates=e,this.relationship_templates=t}}class Vn{constructor(e){g(this,"template_name");this.template_name=e}}class Kn{constructor(e,t,i){g(this,"tosca_definitions_version","tosca_simple_yaml_1_3");g(this,"metadata");g(this,"topology_template");this.metadata=new Vn(e),this.topology_template=new Xn(t,i)}}class Jn{constructor(e,t,i){g(this,"modelId");g(this,"position");g(this,"size");this.modelId=e,this.position=t,this.size=i}}class Yn{constructor(e,t,i,a,r,s,l,u,m,f){g(this,"type","cna.qualityModel.entities.Root.Component");g(this,"metadata");g(this,"requirements");g(this,"capabilities");var x,w;this.metadata=new Jn(e,m,f),this.requirements=new Array;let T={node:(x=t.infrastructure)==null?void 0:x.replace(/\s+/g,""),relationship:(w=t.deploymentMapping)==null?void 0:w.replace(/\s+/g,"")};this.requirements.push({host:T});for(const b of i)this.requirements.push({endpoint_link:{node:b.targetEntity,relationship:b.linkName}});for(const b of a)this.requirements.push({uses_data:b==null?void 0:b.replace(/\s+/g,"")});for(const b of r)this.requirements.push({uses_backing_data:b==null?void 0:b.replace(/\s+/g,"")});this.capabilities=new Array;for(const b of s)this.capabilities.push({endpoint:{type:"tosca.capabilities.Endpoint",metadata:{position:b.metadata.position,size:b.metadata.size,label:b.metadata.label},properties:{protocol:b.protocol,port:b.port,url_path:b.path}}});for(const b of l)this.capabilities.push({external_endpoint:{type:"tosca.capabilities.Endpoint.Public",metadata:{position:b.metadata.position,size:b.metadata.size,label:b.metadata.label},properties:{protocol:b.protocol,port:b.port,url_path:b.path}}});u&&this.capabilities.push({persist_data:{type:"cna.qualityModel.capabilities.DataStorage"}})}}class Qn{constructor(e,t,i){g(this,"modelId");g(this,"position");g(this,"size");this.modelId=e,this.position=t,this.size=i}}class Zn{constructor(e,t,i,a,r,s,l,u,m,f){g(this,"type","cna.qualityModel.entities.SoftwareComponent.Service");g(this,"metadata");g(this,"requirements");g(this,"capabilities");var x,w;this.metadata=new Qn(e,m,f),this.requirements=new Array;let T={node:(x=t.infrastructure)==null?void 0:x.replace(/\s+/g,""),relationship:(w=t.deploymentMapping)==null?void 0:w.replace(/\s+/g,"")};this.requirements.push({host:T});for(const b of i)this.requirements.push({endpoint_link:{node:b.targetEntity,relationship:b.linkName}});for(const b of a)this.requirements.push({uses_data:b==null?void 0:b.replace(/\s+/g,"")});for(const b of r)this.requirements.push({uses_backing_data:b==null?void 0:b.replace(/\s+/g,"")});this.capabilities=new Array;for(const b of s)this.capabilities.push({endpoint:{type:"tosca.capabilities.Endpoint",metadata:{position:b.metadata.position,size:b.metadata.size,label:b.metadata.label},properties:{protocol:b.protocol,port:b.port,url_path:b.path}}});for(const b of l)this.capabilities.push({external_endpoint:{type:"tosca.capabilities.Endpoint.Public",metadata:{position:b.metadata.position,size:b.metadata.size,label:b.metadata.label},properties:{protocol:b.protocol,port:b.port,url_path:b.path}}});u&&this.capabilities.push({persist_data:{type:"cna.qualityModel.capabilities.DataStorage"}})}}class er{constructor(e,t,i){g(this,"modelId");g(this,"position");g(this,"size");this.modelId=e,this.position=t,this.size=i}}class tr{constructor(e,t,i,a,r,s,l,u,m,f,T){g(this,"type","cna.qualityModel.entities.Database.StorageBackingService");g(this,"metadata");g(this,"properties");g(this,"requirements");g(this,"capabilities");var w,b;this.metadata=new er(e,f,T),m&&(m.databaseName||m.port)&&(this.properties={name:m.databaseName,port:m.port}),this.requirements=new Array;let x={node:(w=t.infrastructure)==null?void 0:w.replace(/\s+/g,""),relationship:(b=t.deploymentMapping)==null?void 0:b.replace(/\s+/g,"")};this.requirements.push({host:x});for(const v of i)this.requirements.push({endpoint_link:{node:v.targetEntity,relationship:v.linkName}});for(const v of a)this.requirements.push({uses_data:v==null?void 0:v.replace(/\s+/g,"")});for(const v of r)this.requirements.push({uses_backing_data:v==null?void 0:v.replace(/\s+/g,"")});this.capabilities=new Array;for(const v of s)this.capabilities.push({database_endpoint:{type:"tosca.capabilities.Endpoint.Database",metadata:{position:v.metadata.position,size:v.metadata.size,label:v.metadata.label},properties:{protocol:v.protocol,port:v.port,url_path:v.path}}});for(const v of l)this.capabilities.push({external_endpoint:{type:"tosca.capabilities.Endpoint.Public",metadata:{position:v.metadata.position,size:v.metadata.size,label:v.metadata.label},properties:{protocol:v.protocol,port:v.port,url_path:v.path}}});u&&this.capabilities.push({persist_data:{type:"cna.qualityModel.capabilities.DataStorage"}})}}class ir{constructor(e,t,i){g(this,"modelId");g(this,"position");g(this,"size");this.modelId=e,this.position=t,this.size=i}}class ar{constructor(e,t,i,a,r,s,l,u,m,f,T){g(this,"type","cna.qualityModel.entities.BackingService");g(this,"metadata");g(this,"properties");g(this,"requirements");g(this,"capabilities");var w,b;this.metadata=new ir(e,f,T),m&&(this.properties={provided_functionality:m}),this.requirements=new Array;let x={node:(w=t.infrastructure)==null?void 0:w.replace(/\s+/g,""),relationship:(b=t.deploymentMapping)==null?void 0:b.replace(/\s+/g,"")};this.requirements.push({host:x});for(const v of i)this.requirements.push({endpoint_link:{node:v.targetEntity,relationship:v.linkName}});for(const v of a)this.requirements.push({uses_data:v==null?void 0:v.replace(/\s+/g,"")});for(const v of r)this.requirements.push({uses_backing_data:v==null?void 0:v.replace(/\s+/g,"")});this.capabilities=new Array;for(const v of s)this.capabilities.push({endpoint:{type:"tosca.capabilities.Endpoint",metadata:{position:v.metadata.position,size:v.metadata.size,label:v.metadata.label},properties:{protocol:v.protocol,port:v.port,url_path:v.path}}});for(const v of l)this.capabilities.push({external_endpoint:{type:"tosca.capabilities.Endpoint.Public",metadata:{position:v.metadata.position,size:v.metadata.size,label:v.metadata.label},properties:{protocol:v.protocol,port:v.port,url_path:v.path}}});u&&this.capabilities.push({persist_data:{type:"cna.qualityModel.capabilities.DataStorage"}})}}class or{constructor(e,t,i,a){g(this,"modelId");g(this,"position");g(this,"size");g(this,"label");this.modelId=e,this.position=t,this.size=i,this.label=a}}class nr{constructor(e,t){g(this,"endpoint");g(this,"links");this.endpoint=e,this.links=new Array;for(const i of t)this.links.push(i==null?void 0:i.replace(/\s+/g,""))}}class rr{constructor(e,t,i,a,r,s,l){g(this,"type","cna.qualityModel.entities.RequestTrace");g(this,"metadata");g(this,"properties");g(this,"requirements");this.metadata=new or(e,r,s,l),this.properties=new nr(i,a),this.requirements=new Array,this.requirements.push({external_endpoint:t==null?void 0:t.replace(/\s+/g,"")})}}var G,W,et,S,I,tt,Di,it,Ri;class sr{constructor(e){p(this,S);p(this,tt);p(this,it);p(this,G,void 0);p(this,W,{});p(this,et,{});h(this,G,e)}convert(){this.convertComponent(),this.convertInfrastructure(),this.convertDataAggregate(),this.convertBackingData(),this.convertRequestTrace(),this.convertLink(),this.convertDeploymentMapping();const e=new Kn(o(this,G).getSystemName,o(this,W),o(this,et)),t=Bn.dump(e,{styles:{"!!null":"empty"}});let i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),i.setAttribute("download",`${o(this,G).getSystemName}.tosca`),i.click()}convertComponent(){const e=o(this,G).getComponentEntities;for(const t of e.values()){let i={infrastructure:t.getHostedBy.getName,deploymentMapping:t.getHostedBy.getName+"_host_"+t.getName},a=t.getIncludedLinkEntities.map(f=>({targetEntity:c(this,S,I).call(this,f.getTargetEntity.getParentName),linkName:c(this,S,I).call(this,c(this,tt,Di).call(this,f))})),r=t.getDataAggregateEntities.map(f=>c(this,S,I).call(this,f.getName)),s=t.getBackingDataEntities.map(f=>c(this,S,I).call(this,f.getName)),l=t.getEndpointEntities.map(f=>({metadata:{position:f.position,size:f.size,label:f.label},protocol:f.getEndpointType.toLowerCase().includes("topic")?"udp":"http",port:f.getPort,path:c(this,it,Ri).call(this,f)})),u=t.getExternalEndpointEntities.map(f=>({metadata:{position:f.position,size:f.size,label:f.label},protocol:f.getEndpointType.toLowerCase().includes("topic")?"udp":"http",port:f.getPort,path:c(this,it,Ri).call(this,f)})),m="";t instanceof go?o(this,W)[c(this,S,I).call(this,t.getName)]=new Zn(t.getModelId,i,a,r,s,l,u,m,t.position,t.size):t instanceof uo?o(this,W)[c(this,S,I).call(this,t.getName)]=new ar(t.getModelId,i,a,r,s,l,u,m,t.providedFunctionality,t.position,t.size):t instanceof yo?o(this,W)[c(this,S,I).call(this,t.getName)]=new tr(t.getModelId,i,a,r,s,l,u,m,t.properties,t.position,t.size):o(this,W)[c(this,S,I).call(this,t.getName)]=new Yn(t.getModelId,i,a,r,s,l,u,m,t.position,t.size)}}convertInfrastructure(){const e=o(this,G).getInfrastructureEntities;for(const t of e.values()){const i=t.getBackingDataEntities.map(a=>c(this,S,I).call(this,a.getName));t.getInfrastructureType===we.DBMS?o(this,W)[c(this,S,I).call(this,t.getName)]=new On(t.getModelId,c(this,S,I).call(this,t.getHostedBy),i,t.position,t.size):o(this,W)[c(this,S,I).call(this,t.getName)]=new _n(t.getModelId,c(this,S,I).call(this,t.getHostedBy),i,t.position,t.size)}}convertDataAggregate(){const e=o(this,G).getDataAggregateEntities;for(const t of e.values()){const i=t.getPersistedBy.map(a=>c(this,S,I).call(this,a));o(this,W)[c(this,S,I).call(this,t.getName)]=new Fn(t.getModelId,i)}}convertBackingData(){const e=o(this,G).getBackingDataEntities;for(const t of e.values())o(this,W)[c(this,S,I).call(this,t.getName)]=new zn(t.getModelId,t.getIncludedData)}convertRequestTrace(){const e=o(this,G).getRequestTraceEntities;for(const t of e.values()){const i=`RT_${c(this,S,I).call(this,t.getExternalEndpoint.getEndpointType)}_${c(this,S,I).call(this,t.getExternalEndpoint.getNameId)}`;let a=t.getLinkEntities.map(r=>c(this,S,I).call(this,c(this,tt,Di).call(this,r)));o(this,W)[c(this,S,I).call(this,i)]=new rr(t.getModelId,c(this,S,I).call(this,t.getExternalEndpoint.getParentName),c(this,it,Ri).call(this,t.getExternalEndpoint),a,t.position,t.size,t.getName)}}convertLink(){var t;const e=o(this,G).getLinkEntities;for(const i of e.values()){const a=c(this,tt,Di).call(this,i),r=(t=i.getTargetEntity.getEndpointType)!=null&&t.toLowerCase().includes("topic")?`${i.getTargetEntity.getEndpointName} ${i.getTargetEntity.getEndpointType}`:`${i.getTargetEntity.getEndpointType} ${i.getTargetEntity.getEndpointName}`;o(this,et)[c(this,S,I).call(this,a)]=new Hn(i.getModelId,r,i.getRelationType)}}convertDeploymentMapping(){const e=o(this,G).getDeploymentMappingEntities;for(const t of e.values()){const i=t.getUnderlyingInfrastructure.getName+"_host_"+t.getDeployedEntity.getName;o(this,et)[c(this,S,I).call(this,i)]=new jn(t.getModelId)}}}G=new WeakMap,W=new WeakMap,et=new WeakMap,S=new WeakSet,I=function(e){return!e||!e.trim()?e:e.replace(/\s+/g,"")},tt=new WeakSet,Di=function(e){return e.getSourceEntity.getName+"_connects-to_"+e.getTargetEntity.getNameId},it=new WeakSet,Ri=function(e){var t;return(t=e.getEndpointType)!=null&&t.toLowerCase().includes("topic")?`${e.getEndpointName} ${e.getEndpointType}`:`${e.getEndpointType} ${e.getEndpointName}`};const L=Object.freeze({BUTTON:"button",BUTTON_DROPDOWN:"button-dropdown"});var oi,at,ni,ot,nt,rt,_i,ri,to,Zi,$o,ea,Ao,Ne,vt;class lr{constructor(){p(this,rt);p(this,ri);p(this,Zi);p(this,ea);p(this,Ne);p(this,oi,"");p(this,at,"");p(this,ni,"");p(this,ot,"");p(this,nt,"")}getCreatedToolbarTemplate(){return`<div class="app-header-first-row">
            <div class="input-group app-title">
                ${o(this,oi)}
            </div>
            <div id="modelAppToolbar" class="toolbar-container">
                <div class="app-toolbar">
                    <div class="app-toolbar-tools">
                        ${o(this,at)}
                    </div>
                    <div class="button-group" data-group="first-row-config-button">
                        ${o(this,ot)}
                    </div>
                </div>            
            </div>
        </div>
        <div class="app-header-second-row">
            <div class="entity-tools">
                <div class="entity-overall-group" data-group="entity-overall-group">
                ${o(this,ni)}
                </div>
            </div>
            <div class="second-row-tools" data-group="second-row-config-tools">
                ${o(this,nt)}
            </div>
        </div>`}addSystemTitle(){const e=`<input id="appNameTitle" type="text" class="user-select-all form-control" value="" aria-label="Application name of current System entity"
        aria-describedby="app-title-description" disabled>`,t=`<div class="input-group-append" id="app-title-description">
            <span class="user-select-none input-group-text">Current System</span>
            ${c(this,Ne,vt).call(this,"editApplicationNameBtn","btn-outline-secondary","fa-solid fa-pen-to-square","Edit name of System entity")}
            ${c(this,Ne,vt).call(this,"cancelEditApplicationNameBtn","btn-outline-danger submitEditApplicationNameBtnGroup","fa-solid fa-xmark","Cancel editing")}
            ${c(this,Ne,vt).call(this,"submitEditApplicationNameBtn","btn-outline-success submitEditApplicationNameBtnGroup","fa-solid fa-check","Submit name of System entity")}
            ${c(this,Ne,vt).call(this,"addNewSystemEntity","btn-outline-secondary","fa-solid fa-plus","Add new System entity")}
        </div>`;h(this,oi,`${e}${t}`)}addButtonGroup(e){var a;const t=c(this,rt,_i).call(this,e.buttonGroupId,e);let i="";((a=e.content)==null?void 0:a.length)<=1&&(i="buttonInitialHide"),h(this,at,o(this,at)+t+`<div class="${i} group-divider"></div>`)}addEntityCheckboxTool(e,t,i=""){const a=`<input id="${e}-checkBox" data-entity-type="${e}" class="entityCheckBox form-check-input" type="checkbox" value="${e}" checked>`,r=`<label id="${e}-checkBoxLabel" class="user-select-none entityCheckBoxLabel form-check-label" for="${e}-checkBox">
            ${t}
            <span class="numberOfEntities badge badge-primary badge-pill" data-entity-type="${e}">0</span>
        </label>`;h(this,ni,o(this,ni)+`<div class="entity-group form-check form-check-inline" data-group="${e}" ${i?`title="${i}"`:""} 
        data-toggle="tooltip" data-placement="bottom">
            ${a}${r}
        </div>`)}addAdditionalFirstRowConfigTool(e){let t="";for(const i of e)t=t+(t?`<div id="${i.groupId}-groupDivider" class="group-divider buttonInitialHide"></div>`:""),t=t+c(this,rt,_i).call(this,i.groupId,i);h(this,ot,`${o(this,ot)}${t}`)}addAdditionalSecondRowConfigTool(e){let t="";for(const i of e)t=t+c(this,rt,_i).call(this,i.groupId,i);h(this,nt,o(this,nt)+'<div class="group-divider"></div>'+t)}}oi=new WeakMap,at=new WeakMap,ni=new WeakMap,ot=new WeakMap,nt=new WeakMap,rt=new WeakSet,_i=function(e,t){let i="";for(const a of t.content)switch(a.buttonType){case L.BUTTON:i=i+c(this,ri,to).call(this,e,a.providedFeature,a.tooltipText,a.text,a.iconClass,a.additionalCssClass);break;case L.BUTTON_DROPDOWN:i=i+c(this,Zi,$o).call(this,e,a.providedFeature,a.tooltipText,a.text,a.iconClass,a.additionalCssClass,a.dropdownButtons);break;default:i=i+c(this,ri,to).call(this,e,a.providedFeature,a.tooltipText,a.text,a.iconClass,a.additionalCssClass);break}return`<div class="button-group" ${t.buttonGroupId?`data-group="${t.buttonGroupId}"`:""}>
            ${i}
        </div>`},ri=new WeakSet,to=function(e,t,i="",a="",r="",s=""){return e&&t&&(a||r?1:0)?`<button id="${t}-button" class="toolbarButton btn ${s}" type="button" title="${i}"
        data-toggle="tooltip" data-placement="bottom">
            ${r?`<i class="${r}"></i>`:""}
            ${a!=null?a:""}
        </button>`:void 0},Zi=new WeakSet,$o=function(e,t,i="",a="",r="",s="",l=[]){if(!(e&&t&&Array.isArray(l)&&l.length&&(a||r?1:0)))return;const m=c(this,ea,Ao).call(this,t,l),f=`<button id="${t}-buttonDropDown" class="toolbarDropdownButton btn dropdown-toggle ${s}" type="button" title="${i}"
        data-toggle="dropdown" data-tooltip-toggle="tooltip" data-placement="bottom" aria-expanded="false">
            ${r?`<i class="${r}"></i>`:""}
            ${a!=null?a:""}
        </button>`;return`<div id="${t}-buttonDropDownGroup" class="buttonDropDownGroup dropdown">
            ${f}
            ${m}
        </div>`},ea=new WeakSet,Ao=function(e,t){let i="";for(const a of t){const r=`<button id="${a.providedFeature}-dropdownItemButton" class="toolbarDropdownButtonItem btn dropdown-item ${a.additionalCssClass}" type="button">
                ${a.iconClass?`<i class="${a.iconClass}" style="font-size: 1.1em"></i>`:""}
                ${a.text?`<span> ${a.text}</span>`:""}
            </button>`;i=i+r}return`<div id="${e}-dropdownItemsGroup" class="dropdown-menu" aria-labelledby="${e}-buttonDropDown">
            ${i}
        </div>`},Ne=new WeakSet,vt=function(e,t="",i,a){return`<button id="${e}" class="btn ${t}" type="button" data-toggle="tooltip" data-placement="bottom" title="${a}">
            <i class="${i}"></i>
        </button>`};const Qa=Object.freeze({BUTTON:"button",CHECKBOX:"checkbox"}),Y=Object.freeze({SINGLE_TEXTBLOCK:"textBlock",GROUP_FORMS:"groupForms"}),dr={Tools:[{buttonGroupId:"general-paper-actions",content:[{providedFeature:"fullScreen",tooltipText:"Open fullscreen",text:"",iconClass:"fa-solid fa-expand",additionalCssClass:"",buttonType:L.BUTTON},{providedFeature:"closefullScreen",tooltipText:"Close fullscreen",text:"",iconClass:"fa-solid fa-compress",additionalCssClass:"buttonInitialHide",buttonType:L.BUTTON},{providedFeature:"fitActivePaperToContent",tooltipText:"Fit paper to content",text:"",iconClass:"fa-solid fa-crop",additionalCssClass:"",buttonType:L.BUTTON}]},{buttonGroupId:"extern-clear",content:[{providedFeature:"clearActivePaper",tooltipText:"Clear current paper",text:"",iconClass:"fa-solid fa-trash-can",additionalCssClass:"",buttonType:L.BUTTON},{providedFeature:"printActivePaper",tooltipText:"Print current paper",text:"",iconClass:"fa-solid fa-print",additionalCssClass:"",buttonType:L.BUTTON},{providedFeature:"convertModeledSystemEntity",tooltipText:"Export modeled System",text:"",iconClass:"fa-solid fa-download",additionalCssClass:"",buttonType:L.BUTTON_DROPDOWN,dropdownButtons:[{providedFeature:"convertModeledSystemEntityToJson",tooltipText:"Export modeled System to JSON",text:"Export to JSON",iconClass:"bi bi-filetype-json",additionalCssClass:""},{providedFeature:"convertModeledSystemEntityToTosca",tooltipText:"Export modeled System to TOSCA",text:"Transform to TOSCA",iconClass:"bi bi-filetype-yml",additionalCssClass:""}]}]},{buttonGroupId:"zoom",content:[{providedFeature:"zoomOutPaper",tooltipText:"Zoom out from modeling area",text:"",iconClass:"fa-solid fa-magnifying-glass-minus",additionalCssClass:"",buttonType:"range-label-buttons"},{providedFeature:"zoomInPaper",tooltipText:"Zoom into modeling area",text:"",iconClass:"fa-solid fa-magnifying-glass-plus",additionalCssClass:"",buttonType:"range-label-buttons"}]},{buttonGroupId:"paper-background",content:[{providedFeature:"changeGrid",tooltipText:"Clear grid",text:"",iconClass:"fa-solid fa-border-all",additionalCssClass:"",buttonType:L.BUTTON},{providedFeature:"fitAllElementsToEmbedded",tooltipText:"Fit elements to embedded",text:"",iconClass:"bi bi-aspect-ratio-fill",additionalCssClass:"",buttonType:L.BUTTON}]},{buttonGroupId:"paper-individual-elements",content:[{providedFeature:"expandAll",tooltipText:"Expand all entities",text:"",iconClass:"fa-regular fa-square-plus",additionalCssClass:"",buttonType:L.BUTTON},{providedFeature:"collapseAll",tooltipText:"Collapse all entities",text:"",iconClass:"fa-regular fa-square-minus",additionalCssClass:"",buttonType:L.BUTTON}]},{buttonGroupId:"requestTraceView",content:[{providedFeature:"exitRequestTraceView",tooltipText:"Exit current Request Trace view",iconClass:"fa-solid fa-arrow-right-from-bracket",additionalCssClass:"buttonInitialHide btn-danger exitRequestTraceView",buttonType:L.BUTTON}]}],EntityConfig:[{entityType:d.COMPONENT,labelText:"Component",tooltipText:"Show/Hide all Component entities"},{entityType:d.SERVICE,labelText:"Service",tooltipText:"Show/Hide all Service entities"},{entityType:d.BACKING_SERVICE,labelText:"Backing Service",tooltipText:"Show/Hide all Backing Service entities"},{entityType:d.STORAGE_BACKING_SERVICE,labelText:"Storage Backing Service",tooltipText:"Show/Hide all Storage Backing Service entities"},{entityType:d.ENDPOINT,labelText:"Endpoint",tooltipText:"Show/Hide all Endpoint entities"},{entityType:d.EXTERNAL_ENDPOINT,labelText:"External Endpoint",tooltipText:"Show/Hide all External Endpoint entities"},{entityType:d.LINK,labelText:"Link",tooltipText:"Show/Hide all Link entities"},{entityType:d.INFRASTRUCTURE,labelText:"Infrastructure",tooltipText:"Show/Hide all Infrastructure entities"},{entityType:d.DEPLOYMENT_MAPPING,labelText:"Deployment Mapping",tooltipText:"Show/Hide all Deployment Mapping entities"},{entityType:d.REQUEST_TRACE,labelText:"Request Trace",tooltipText:"Show/Hide all Request Trace entities"},{entityType:d.DATA_AGGREGATE,labelText:"Data Aggregate",tooltipText:"Show/Hide all Data Aggregate entities"},{entityType:d.BACKING_DATA,labelText:"Backing Data",tooltipText:"Show/Hide all Backing Data entities"}],ToolbarRowConfig:[{rowIndex:1,tools:[{groupId:"settings",content:[{buttonType:Qa.BUTTON,providedFeature:"applicationSettings",tooltipText:"Edit application settings",text:"",iconClass:"fa-solid fa-gear",additionalCssClass:""}]},{groupId:"additionalToolbar",content:[{buttonType:Qa.BUTTON,providedFeature:"showEntityToolbarRow",tooltipText:"Show entity specific options",text:"",iconClass:"fa-solid fa-angles-down",additionalCssClass:"buttonInitialHide"}]}]},{rowIndex:2,tools:[{groupId:"entireToolbarSecondRow",content:[{buttonType:Qa.BUTTON,providedFeature:"hideEntityToolbarRow",tooltipText:"Hide entity specific options",text:"",iconClass:"fa-solid fa-angles-up",additionalCssClass:""}]}]}],ToolbarButtonActionConfig:{clearActivePaper:{type:"modalDialog",header:{iconClass:"fa-solid fa-triangle-exclamation",type:"warning",text:"Warning",closeButton:!0},footer:{cancelButtonText:"No, cancel",saveButtonIconClass:"fa-solid fa-trash-can",saveButtonText:"Yes, clear paper"},content:{contentType:Y.SINGLE_TEXTBLOCK,text:"Are you sure you want to clear the entire paper? You won't be able to undo this action."}},convertToTosca:{type:"modalDialog",header:{iconClass:"fa-solid fa-triangle-exclamation",type:"warning",text:"Warning",closeButton:!0},footer:{cancelButtonText:"No, cancel",saveButtonIconClass:"fa-solid fa-download",saveButtonText:"Yes, start TOSCA transformation."},content:{contentType:Y.SINGLE_TEXTBLOCK,text:`The TOSCA export uses the labels of the respective entities as keys for the node_templates that represent the modeled entities. Therefore, please make sure, each entity
                has a unique label name, otherwise an entity might be missing in the export. Are you sure, you want to continue?`}}}},E=Object.freeze({BUTTON:"button",CHECKBOX:"checkbox",CHECKBOX_WITHOUT_LABEL:"checkbox-without-label",INPUT_TEXTBOX:"text",INPUT_TEXTBOX_LABEL_PREPEND:"text-label-prepend",INPUT_NUMBERBOX:"number",INPUT_RANGE:"range",TEXTAREA:"textarea",INFO:"info",DROPDOWN:"select",INPUT_LIST:"list",TABLE_DIALOG:"table-dialog",TABLE:"table",TOGGLE:"toggle",FORMGROUP:"formgroup"}),Bi=Object.freeze({USED:"used",PERSISTED:"persisted"}),Tt=(n="",e="white",t=1)=>`<ellipse ${n?`id="${n}"`:""} cx="13" cy="9" rx="12" ry="6" stroke="black" fill="${e}" opacity="${t}"/>`,Fe=(n="",e="white",t=1)=>`<path ${n?`id="${n}"`:""} d="M 0 0 L 16.8 0 Q 24 0 24 7.2 Q 24 14.4 16.8 14.4 L 0 14.4 Z" transform="translate(1, 1.5)" opacity="${t}" stroke-width="1" stroke-dasharray="0" stroke="black" fill="${e}"></path>`,pr={EntityHighlighting:[{type:d.DATA_AGGREGATE,labelText:"Data Aggregate",svgRepresentation:`<svg width="30" height="20">${Tt("data-aggregate-highlightingRepresentation","gold",.4)}</svg>`,highlightColour:"gold"},{type:d.BACKING_DATA,labelText:"Backing Data",svgRepresentation:`<svg width="30" height="20">${Fe("backing-data-highlightingRepresentation","limegreen",.4)}</svg>`,highlightColour:"limegreen"}],GeneralProperties:{entity:{headline:"Entity Specific",iconClass:"fa-solid fa-sliders",options:[{providedFeature:"entity-specific-info",contentType:E.INFO,content:{iconClass:"fa-solid fa-info",text:"Properties included here will not change any presentation details but provide additional information, which is especially relevant for a TOSCA transformation."}}]},label:{headline:"Entity Label",iconClass:"fa-solid fa-font",options:[{providedFeature:"entity-text",contentType:E.TEXTAREA,label:"Text:",properties:{disabled:!1},attributes:{rows:1,maxlength:200,helpText:{text:"Use enter key to submit change."},provideEnterButton:!1}},{providedFeature:"entity-font-size",contentType:E.INPUT_RANGE,label:"Font Size:",properties:{disabled:!1},attributes:{min:8,max:24,defaultValue:14,step:1,helpText:{text:"Use enter key to submit change."},provideEnterButton:!1}}]},size:{headline:"Entity Size",iconClass:"fa-solid fa-vector-square",options:[{providedFeature:"entity-width",contentType:E.INPUT_NUMBERBOX,label:"Width:",properties:{disabled:!1},attributes:{min:40,maxlength:5}},{providedFeature:"entity-height",contentType:E.INPUT_NUMBERBOX,label:"Height:",properties:{disabled:!0},attributes:{min:40,maxlength:5,helpText:{text:"The value will be calculated based on the given width to preserve the aspect ratio of the entity shape"}}},{providedFeature:"entity-aspect-ratio",contentType:E.CHECKBOX,label:"Preserve aspect ratio",properties:{disabled:!0,checked:!0}}]},position:{headline:"Entity Position",iconClass:"fa-solid fa-crosshairs",options:[{providedFeature:"entity-x-position",contentType:E.INPUT_NUMBERBOX,label:"X-Coordinate:",properties:{disabled:!1},attributes:{min:21}},{providedFeature:"entity-y-position",contentType:E.INPUT_NUMBERBOX,label:"Y-Coordinate:",properties:{disabled:!1},attributes:{min:21}}]}}},_={"entity-text":{isProperty:!1,modelPath:"label/textWrap/text",defaultPropPath:"",min:""},"entity-font-size":{isProperty:!1,modelPath:"label/fontSize",defaultPropPath:"defaults/fontSize",min:"6"},"entity-width":{isProperty:!0,hasProvidedMethod:!0,modelPath:"size/width",defaultPropPath:"defaults/size/width",minPath:"defaults/size/width"},"entity-height":{isProperty:!0,hasProvidedMethod:!0,modelPath:"size/height",defaultPropPath:"defaults/size/height",minPath:"defaults/size/height"},"entity-aspect-ratio":{isProperty:!0,modelPath:"defaults/size",defaultPropPath:"",helpText:"The value will be calculated based on the given width to preserve the aspect ratio of the entity shape",min:""},"entity-x-position":{isProperty:!0,hasProvidedMethod:!0,modelPath:"position/x",defaultPropPath:"",min:"21"},"entity-y-position":{isProperty:!0,hasProvidedMethod:!0,modelPath:"position/y",defaultPropPath:"",min:"21"}},bo={Component:{type:d.COMPONENT,specificProperties:[]},Service:{type:d.SERVICE,specificProperties:[]},BackingService:{type:d.BACKING_SERVICE,specificProperties:[{providedFeature:"providedFunctionality",contentType:E.INPUT_TEXTBOX,label:"Provided Functionality:",properties:{disabled:!1,required:!1},attributes:{placeholder:"e.g. Logging",helpText:{text:"A short description of the provided functionality."}}}]},StorageBackingService:{type:d.STORAGE_BACKING_SERVICE,specificProperties:[{providedFeature:"databaseName",contentType:E.INPUT_TEXTBOX,label:"Database Name:",properties:{disabled:!1,required:!1},attributes:{placeholder:"e.g. Order"}},{providedFeature:"databasePort",contentType:E.INPUT_NUMBERBOX,label:"Port:",properties:{disabled:!1,required:!1},attributes:{placeholder:"e.g. 3306",maxlength:4}}]},Endpoint:{type:d.ENDPOINT,specificProperties:[{providedFeature:"endpointType",contentType:E.INPUT_LIST,label:"Endpoint Type:",properties:{disabled:!1,required:!0},attributes:{placeholder:"e.g. GET",datalistItems:[{value:"GET",text:"GET"},{value:"POST",text:"POST"},{value:"Topic send-to",text:"Topic send-to"},{value:"Topic receive-from",text:"Topic receive-from"}]}},{providedFeature:"endpointPath",contentType:E.INPUT_TEXTBOX,label:"Endpoint Path:",properties:{disabled:!1,required:!0},attributes:{placeholder:"e.g. /orders"}},{providedFeature:"port",contentType:E.INPUT_NUMBERBOX,label:"Port:",properties:{disabled:!1,required:!1},attributes:{placeholder:"e.g. 3306",maxlength:4}}]},ExternalEndpoint:{type:d.EXTERNAL_ENDPOINT,specificProperties:[{providedFeature:"endpointType",contentType:E.INPUT_LIST,label:"Endpoint Type:",properties:{disabled:!1,required:!0},attributes:{placeholder:"e.g. GET",datalistItems:[{value:"GET",text:"GET"},{value:"POST",text:"POST"},{value:"Topic send-to",text:"Topic send-to"},{value:"Topic receive-from",text:"Topic receive-from"}]}},{providedFeature:"endpointPath",contentType:E.INPUT_TEXTBOX,label:"Endpoint Path:",properties:{disabled:!1,required:!0},attributes:{placeholder:"e.g. /orders"}},{providedFeature:"port",contentType:E.INPUT_NUMBERBOX,label:"Port:",properties:{disabled:!1,required:!1},attributes:{placeholder:"e.g. 3306",maxlength:4}}]},Link:{type:d.LINK,specificProperties:[{providedFeature:"relationType",contentType:E.INPUT_TEXTBOX,label:"Relation Type:",properties:{disabled:!1,required:!1},attributes:{placeholder:"e.g. subscribes to"}}]},Infrastructure:{type:d.INFRASTRUCTURE,specificProperties:[]},DeploymentMapping:{type:d.DEPLOYMENT_MAPPING,specificProperties:[]},DataAggregate:{type:d.DATA_AGGREGATE,specificProperties:[]},BackingData:{type:d.BACKING_DATA,specificProperties:[]}},cr={entityHighlighting:"orange"};var y,M,X,Z,z,si,ee,de,P,F,V,ie,ve,Le,Te,Ge,ta,Bo,ia,Do,$e,xt,aa,Ro,li,io,oa,_o,na,Oo;class j{constructor(e="",t=""){p(this,ee);p(this,P);p(this,V);p(this,ve);p(this,Te);p(this,ta);p(this,ia);p(this,$e);p(this,aa);p(this,li);p(this,oa);p(this,na);p(this,y,"");p(this,M,"");p(this,X,"");p(this,Z,"");p(this,z,"");p(this,si,"");h(this,y,e),h(this,M,t)}getCreatedFormTemplate(e=!1,t="",i=!1){const a=e?`class="form-group needs-validation ${i?"form-check":""}" novalidate`:'class="form-group"',r=e?'class="input-group has-validation"':"input-group";return`<form id="${o(this,y)}-form" ${a}>
            ${"before".localeCompare(t==null?void 0:t.toLowerCase())===0?"<hr>":""}
            ${o(this,Z)}
            <div id="${o(this,y)}-inputGroup" ${r}>
                ${o(this,X)}
            </div>
            ${o(this,z)}
            ${o(this,si)}
            ${"after".localeCompare(t==null?void 0:t.toLowerCase())===0?"<hr>":""}
        </form>`}addDropdownElementWithLabelAndOptions(e,t,i,a){var u;h(this,Z,c(this,ee,de).call(this,e,t));const r=c(this,ta,Bo).call(this,a,t.placeholder),s=c(this,P,F).call(this,i,a.length===0),l=`<select class="custom-select" id="${o(this,y)}" size="${(u=t.size)!=null?u:1}" ${t.multiple?'multiple="multiple"':""} 
           data-property-type="${o(this,M)}" ${s}>
                ${r}
        </select>`;h(this,z,c(this,V,ie).call(this,t.helpText)),h(this,X,l)}_addDataListElementWithLabel(e,t,i){h(this,Z,c(this,ee,de).call(this,e,t));const a=c(this,P,F).call(this,i),r=`<input class="form-control" id="${o(this,y)}" list="${o(this,y)}-datalist" 
            ${t.placeholder?`placeholder="${t.placeholder}"`:""}   
            data-property-type="${o(this,M)}" ${a}>`,s=c(this,ia,Do).call(this,t),l=`<datalist id="${o(this,y)}-datalist">
                ${s}
        </datalist>`,u=t.provideEditButton?c(this,ve,Le).call(this,i.additionalButton):c(this,Te,Ge).call(this,i,t.provideEnterButton);h(this,z,c(this,V,ie).call(this,t.helpText)),h(this,X,`${r}${l}${u}`)}_addButtonElementWithLabel(e="",t={},i={}){const a=c(this,ee,de).call(this,e,t),r=t.buttonIconClass?`<i id="${o(this,y)}-buttonIcon" class="${t.buttonIconClass}"></i>`:"",s=c(this,P,F).call(this,i),l=`<button id="${o(this,y)}" class="btn btn-dark btn-block" type="button" ${t.helpText?`aria-describedby="${o(this,y)}-helpText"`:""} 
            data-property-type="${o(this,M)}" ${s}>
                ${r}
                ${r&&t.buttonText?" ":""} 
                ${t.buttonText}
        </button>`;h(this,z,c(this,V,ie).call(this,t.helpText)),h(this,X,`${a}${l}`)}addSwitchElementWithLabels(e={},t={},i={}){const a=!!i.checked,r=`<label id="${o(this,y)}-leftLabel" class="detailsSidebar-toggle-leftLabel user-select-none ${a?"text-muted":""}" for="${o(this,y)}">${e.leftLabel}</label>`,s=`<label id="${o(this,y)}-rightLabel" class="detailsSidebar-toggle-rightLabel custom-control-label user-select-none" for="${o(this,y)}">${e.rightLabel}</label>`,l=c(this,P,F).call(this,i),m=`<div class="custom-control custom-switch toggle-group">${`<input id="${o(this,y)}" class="custom-control-input detailsSidebar-toggle" type="checkbox" ${t.helpText?`aria-describedby="${o(this,y)}-helpText"`:""}
            data-property-type="${o(this,M)}" ${l}>`}${s}</div>`;h(this,Z,c(this,ee,de).call(this,e.headLabel,t)),h(this,z,c(this,V,ie).call(this,t.helpText)),h(this,X,`${r}${m}`)}_addTextAreaElementWithLabel(e="",t={},i={}){h(this,Z,c(this,ee,de).call(this,e,t));const a=c(this,P,F).call(this,i),r=`<textarea id="${o(this,y)}" class="form-control" type="text" 
            ${t.rows?`rows="${t.rows}`:'rows="1"'}
            ${t.maxlength?`maxlength="${t.maxlength}"`:""}
            ${t.value?`value="${t.value}"`:""}
            ${t.helpText?`aria-describedby="${o(this,y)}-helpText"`:""}
            ${t.title?`title="${t.title}"`:""}
            data-property-type="${o(this,M)}" ${a}></textarea>`,s=t.provideEditButton?c(this,ve,Le).call(this,i.additionalButton):c(this,Te,Ge).call(this,i,t.provideEnterButton);h(this,z,c(this,V,ie).call(this,t.helpText)),h(this,X,`${r}${s}`)}addTextElementWithLabel(e="",t={},i={}){h(this,Z,c(this,ee,de).call(this,e,t));const a=c(this,P,F).call(this,i),r=`<input id="${o(this,y)}" class="form-control" type="text" 
            ${t.placeholder?`placeholder="${t.placeholder}"`:""}
            ${t.maxlength?`maxlength="${t.maxlength}"`:""}
            ${t.value?`value="${t.value}"`:""}
            ${t.pattern?`pattern="${t.pattern}"`:""}
            ${t.helpText?`aria-describedby="${o(this,y)}-helpText"`:""}
            ${t.title?`title="${t.title}"`:""}
            data-property-type="${o(this,M)}" ${a}>`,s=t.provideEditButton?c(this,ve,Le).call(this,i.additionalButton):c(this,Te,Ge).call(this,i,t.provideEnterButton);h(this,z,c(this,V,ie).call(this,t.helpText)),h(this,X,`${r}${s}`)}addTextElementWithPrependLabel(e="",t={},i={}){const a=`<div class="input-group-prepend">
            <span class="input-group-text">
                ${t.labelIcon?`<i class="${t.labelIcon}"></i>`:""}
                <span class="modalInputLabel">${e}</span>
            </span>
        </div>`,r=c(this,P,F).call(this,i),s=`<input id="${o(this,y)}" class="form-control" type="text" 
            ${t.placeholder?`placeholder="${t.placeholder}"`:""}
            ${t.maxlength?`maxlength="${t.maxlength}"`:""}
            ${t.value?`value="${t.value}"`:""}
            ${t.pattern?`pattern="${t.pattern}"`:""}
            ${t.helpText?`aria-describedby="${o(this,y)}-helpText"`:""}
            ${t.title?`title="${t.title}"`:""}
            data-property-type="${o(this,M)}" ${r}>`,l=t.provideEditButton?c(this,ve,Le).call(this,i.additionalButton):c(this,Te,Ge).call(this,i,t.provideEnterButton);h(this,z,c(this,V,ie).call(this,t.helpText)),h(this,X,`${a}${s}${l}`)}addNumberElementWithLabel(e="",t={},i={}){h(this,Z,c(this,ee,de).call(this,e,t));const a=c(this,P,F).call(this,i),r=`<input id="${o(this,y)}" class="form-control" type="number" 
            ${t.min?`min="${t.min}"`:""}
            ${t.max?`max="${t.max}"`:""}
            ${t.step?`step="${t.step}"`:""}
            ${t.maxlength?`maxlength="${t.maxlength}"`:""}
            ${t.value?`value="${t.value}"`:""}
            ${t.helpText?`aria-describedby="${o(this,y)}-helpText"`:""}
            ${t.title?`title="${t.title}"`:""}
            data-property-type="${o(this,M)}" ${a}>`,s=t.provideEditButton?c(this,ve,Le).call(this,i.additionalButton):c(this,Te,Ge).call(this,i,t.provideEnterButton);h(this,z,c(this,V,ie).call(this,t.helpText)),h(this,X,`${r}${s}`)}_addCheckboxElementWithLabel(e="",t={},i={}){const a=c(this,ee,de).call(this,e,t,"form-check-label"),r=c(this,P,F).call(this,i),s=`<input id="${o(this,y)}" class="form-check-input" type="checkbox"
            ${t.helpText?`aria-describedby="${o(this,y)}-helpText"`:""}
            ${t.title?`title="${t.title}"`:""}
            data-property-type="${o(this,M)}" ${r}>`;h(this,z,c(this,V,ie).call(this,t.helpText)),h(this,Z,`${s}${a}`)}_addFormFeedbackSection(e="Reset: Invalid input provided",t="Sucessfully changed"){const i=Eo(e),a=vo(t);h(this,si,`${i}${a}`)}configureEnterButtonBehaviour(){$("#"+o(this,y)+"-enterButton").click(e=>{var t=$.Event("keydown",{which:13});$("#"+o(this,y)).trigger(t),$(":focus").blur(),$("#"+o(this,y)).focus()}),$("#"+o(this,y)).focusout(e=>{c(this,$e,xt).call(this)}),$("#"+o(this,y)).on("change input",()=>{c(this,$e,xt).call(this)})}create(e=!1){let t=e?'class="form-group needs-validation" novalidate':'class="form-group"',i=e?'class="input-group has-validation"':"input-group";return`<form id="${o(this,y)}-form" ${t}><div id="${o(this,y)}-inputGroup" ${i}></div></form>`}addInputRangeElementWithLabel(e="",t={},i={}){var s,l,u,m;c(this,aa,Ro).call(this,e);let a='<span id="'+o(this,y)+'-currentValue" class="rangeBoxCurrentValue ml-2 align-baseline badge badge-primary badge-pill">'+t.defaultValue+" px</span>";$("#"+o(this,y)+"-label").append(a);let r='<input class="col px-md-2 form-control-range form-check" id="'+o(this,y)+'">';$("#"+o(this,y)+"-inputGroup").append(r),$("#"+o(this,y)).attr({type:"range",min:(s=t.min)!=null?s:0,max:(l=t.max)!=null?l:100,value:(u=t.defaultValue)!=null?u:null,step:(m=t.step)!=null?m:1,"aria-describedby":t.helpText?o(this,y)+"-helpText":null,"data-property-type":o(this,M)}),c(this,li,io).call(this,i),c(this,na,Oo).call(this,i,t.provideEnterButton),c(this,oa,_o).call(this,t.helpText),$("#"+o(this,y)+"-enterButton").addClass("ml-2 btn-sm"),$("#"+o(this,y)).on("change input",()=>{$("#"+o(this,y)+"-currentValue").text($("#"+o(this,y)).val()+" px")})}addFormFeedbackSection(e="",t=""){let i=Eo(e),a=vo(t);$("#"+o(this,y)+"-form").append(a),$("#"+o(this,y)+"-form").append(i),$("#"+o(this,y)).focusout(r=>{c(this,$e,xt).call(this)}),$("#"+o(this,y)).on("change input",()=>{c(this,$e,xt).call(this)})}}y=new WeakMap,M=new WeakMap,X=new WeakMap,Z=new WeakMap,z=new WeakMap,si=new WeakMap,ee=new WeakSet,de=function(e="",t={},i=""){return`<label id="${o(this,y)}-label" for="${o(this,y)}" ${i?`class="${i}"`:""}>
            ${t.svgRepresentation?`<span id="${o(this,y)}-svgRepresentation">${t.svgRepresentation}</span>`:""}
            ${t.iconClass?`<i id="${o(this,y)}-labelIcon" class="${t.iconClass}"></i>`:""}
            ${e}
        </label>`},P=new WeakSet,F=function(e={},t="",i="",a="",r="",s=""){if(!e||!joint.util.isObject(e)||Object.keys(e).length<=0)return"";let l=e.disabled?!0:t||!1,u=e.checked?!0:i||!1,m=e.required?!0:a||!1,f=e.selected?!0:r||!1,T=e.readonly?!0:s||!1;return`${l?"disabled":""} ${u?"checked":""} ${m?"required":""} ${f?"selected":""} ${T?"readonly":""}`},V=new WeakSet,ie=function(e={}){return!e||!joint.util.isObject(e)||Object.keys(e).length<=0?"":`<small id="${o(this,y)}-helpText" class="form-text text-muted">${e.text}</small>`},ve=new WeakSet,Le=function(e={},t=!0){if(!e||t===!1)return"";const i=c(this,P,F).call(this,e);return`<div class="input-group-append">
            <button id="${o(this,y)}-editButton" class="editPropertyButton btn btn-outline-secondary" type="button" ${i}>
                <i class="editPropertyButtonIcon fa-solid fa-pencil"></i>
            </button>
        </div>`},Te=new WeakSet,Ge=function(e={},t=!0){if(!e||e.disabled||t===!1)return"";const i=c(this,P,F).call(this,e);return`<div class="input-group-append">
            <button id="${o(this,y)}-enterButton" class="enterPropertyButton btn btn-outline-secondary" type="button" ${i}>
                <i class="enterPropertyButtonIcon fa-solid fa-check"></i>
            </button>
        </div>`},ta=new WeakSet,Bo=function(e,t){if(!e||Array.isArray(e)===!1)return`<option value="" disabled selected hidden>${t||"Choose..."}</option>`;let i=`<option value="" disabled selected hidden>${t||"Choose..."}</option>`;for(const a of e){if(!a.optionValue&&!a.optionText)continue;const r=c(this,P,F).call(this,a);i=i+`<option value="${a.optionValue}" 
            ${a.optionTitle?`title="${a.optionTitle}"`:""} 
            ${a.optionRepresentationClass?`class="${a.optionRepresentationClass}"`:""}
            ${r}>
                ${a.optionText}
            </option>`}return i},ia=new WeakSet,Do=function(e){if(!e||Array.isArray(e.datalistItems)===!1||e.datalistItems.length<=0)return"";let t="";for(const i of e.datalistItems)t=t+`<option value="${i.value}">${i.text}</option>`;return t},$e=new WeakSet,xt=function(){$("#"+o(this,y)+"-form .valid-feedback").hide(),$("#"+o(this,y)+"-form .invalid-feedback").hide(),$("#"+o(this,y)+"-form .is-valid").removeClass("is-valid"),$("#"+o(this,y)+"-form .is-invalid").removeClass("is-invalid")},aa=new WeakSet,Ro=function(e=""){let t='<label id="'+o(this,y)+'-label" for="'+o(this,y)+'">'+e+"</label>";$("#"+o(this,y)+"-form").prepend(t)},li=new WeakSet,io=function(e={},t=o(this,y)){var i,a,r;!e||!joint.util.isObject(e)||Object.keys(e).length<=0||$("#"+t).prop({disabled:(i=e.disabled)!=null?i:!1,checked:(a=e.checked)!=null?a:!1,required:(r=e.required)!=null?r:!1})},oa=new WeakSet,_o=function(e={}){if(!e||!joint.util.isObject(e)||Object.keys(e).length<=0)return;let t='<small id="'+o(this,y)+'-helpText" class="form-text text-muted">'+e.text+"</small>";$("#"+o(this,y)+"-form").append(t)},na=new WeakSet,Oo=function(e={},t=!0){if(!e||e.disabled||t===!1)return;let a='<div class="input-group-append">'+('<button id="'+o(this,y)+'-enterButton" class="enterPropertyButton btn btn-outline-secondary" type="button"><i class="enterPropertyButtonIcon fa-solid fa-check"></i></button>')+"</div>";$("#"+o(this,y)+"-inputGroup").append(a),c(this,li,io).call(this,e,o(this,y)+"-enterButton"),$("#"+o(this,y)+"-enterButton").click(r=>{var s=$.Event("keydown",{which:13});$("#"+o(this,y)).trigger(s),$(":focus").blur(),$("#"+o(this,y)).focus()})};const Eo=(n="")=>`<div class="invalid-feedback">${n}</div>`,vo=(n="")=>`<div class="valid-feedback">${n}</div>`;var ra,xe,di,pi,ci,sa,Po,la,Mo;class hr{constructor(e,t){p(this,sa);p(this,la);p(this,ra,"");p(this,xe,"");p(this,di,"");p(this,pi,"");p(this,ci,0);h(this,ra,e),h(this,xe,t)}render(e){const t=this.getCreatedTableTemplate();let i=$("#"+e);i.length&&i.append(t)}getCreatedTableTemplate(e=!0){return`<div class="table-responsive">
            <table id="${o(this,xe)}-table" class="table ${e?"table-hover":""}">
                <thead id="${o(this,xe)}-tableHead" class="thead-dark">
                    ${o(this,di)}
                </thead>
                <tbody id="${o(this,xe)}-tableBody">
                    ${o(this,pi)}
                </tbody>
            </table>
        </div>`}create(e){this.createColumnHeaders(e.tableColumnHeaders),this.createRows(e.tableRows)}createColumnHeaders(e){if(!e||!Array.isArray(e))return;h(this,ci,e.length);let t="<tr>";for(const i of e)t=t+`<th scope="col" ${i.colspan?`colspan="${i.colspan}"`:""}>${i.text}</th>`;t=t+"</tr>",h(this,di,t)}createRows(e){if(!e||!Array.isArray(e))return;let t="";for(const i of e)t=t+this.createRow(i);h(this,pi,t)}createRow(e){let t="attributes"in e,i=t?Object.keys(e).length-1:Object.keys(e).length;if(!e||i!==o(this,ci))throw new Error("The provided row includes too many or too less row elements for the number of available columns.");let a="";return Object.keys(e).forEach(r=>{const s=e[r];if("attributes".localeCompare(r)!==0)if(joint.util.isObject(s)){const l=c(this,sa,Po).call(this,s,r);a=a+`<td data-table-context="${r}">${l}</td>`}else a=a+`<td data-table-context="${r}">${s}</td>`}),`<tr class="tableRow ${t?e.attributes.representationClass:""}${t&&e.attributes.disabled?" text-muted":""}">
            ${a}
        </tr>`}}ra=new WeakMap,xe=new WeakMap,di=new WeakMap,pi=new WeakMap,ci=new WeakMap,sa=new WeakSet,Po=function(e,t=""){let i="";switch(e.contentType){case E.CHECKBOX_WITHOUT_LABEL:const a=c(this,la,Mo).call(this,e);i=`<div class="form-check">
                    <input class="dialogCheckBox form-check-input position-static" type="checkbox" id="${e.id}-dialogCheckBox" 
                    value="${e.id}" data-entity-property="${o(this,xe)}-${t}" ${a}>
                </div>`;break}return i},la=new WeakSet,Mo=function(e){return`${e.disabled?"disabled":""} ${e.checked?"checked":""} ${e.required?"required":""}`};const Nt=Object.freeze({SMALL:"modal-sm",DEFAULT:"",LARGE:"modal-lg",EXTRA_LARGE:"modal-xl"});var st,N,hi,Ce,pe,da,ui,gi,yi,pa,Fo,ca,Lo,ha,Go,ua,Wo,ae,fe,ga,zo;class se{constructor(e,t){p(this,pa);p(this,ca);p(this,ha);p(this,ua);p(this,ae);p(this,ga);g(this,"$modalDialog");p(this,st,"");p(this,N,"");p(this,hi,new Map);p(this,Ce,()=>{c(this,ae,fe).call(this)});p(this,pe,()=>{c(this,ae,fe).call(this)});p(this,da,"fa-solid fa-info");p(this,ui,"");p(this,gi,"");p(this,yi,"");h(this,st,e),h(this,N,t)}getCreatedDialogTemplate(e=!1,t=""){const i=e?'data-backdrop="static" data-keyboard="false"':"";return`<div class="modal" id="${o(this,N)}-dialog" ${i||""} tabindex="-1" aria-labelledby="${o(this,N)}-dialogTitle" aria-hidden="true">
            <div class="modal-dialog ${t} modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    ${o(this,ui)}
                    ${o(this,gi)}
                    ${o(this,yi)}
                </div>
            </div>
        </div>`}render(e,t=!1,i=""){const a=this.getCreatedDialogTemplate(t,i);if($("#"+e).length){$("#"+e).append(a),this.$modalDialog=$("#"+o(this,N)+"-dialog"),this.hide(),$("#"+o(this,N)+"-dialog [data-dismiss=modal]").click(o(this,pe)),this.$modalDialog.keydown(l=>{c(this,ga,zo).call(this,l)});let s=$("#"+o(this,N)+"-dialogSaveButton");s.length&&s.click(o(this,Ce))}}create(e){!e||!joint.util.isObject(e)||!e.header||!e.footer||!e.content||(this.createHeader(e.header),this.createContent(e.content),this.createFooter(e.footer))}createHeader(e){if(!e||!joint.util.isObject(e))return;const t=e.svgRepresentation?'<span id="'+o(this,N)+'-dialogTitleSvgRepresentation">'+e.svgRepresentation+"</span>":"",i=e.iconClass?`<i id="${o(this,N)}-dialogTitleIcon" class="${e.iconClass}" data-type="${e.type?e.type:"normal"}"></i>`:t?"":`<i class="${o(this,da)}"></i>`,a=`<div id="${o(this,N)}-dialogHeader" class="modal-header">
            <h5 class="modalTitleIcon modal-title">${t}${i}</h5>
            <h5 class="modal-title">${e.text}</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" ${e.closeButton?"":'style="visibility: hidden;"'}><span aria-hidden="true">&times;</span></button>
            </div>`;h(this,ui,a)}createFooter(e){if(!e||!joint.util.isObject(e))return;const t=e.saveButtonIconClass?`<i id="${o(this,N)}-dialogSaveButtonIcon" class="${e.saveButtonIconClass}"></i>`:"",i=`<div id="${o(this,N)}-dialogFooter" class="modal-footer">
            <button id="${o(this,N)}-dialogCancelButton" type="button" class="btn btn-secondary" data-dismiss="modal" tabindex="0">${e.cancelButtonText?e.cancelButtonText:"Close"}</button>
            ${e.saveButtonText?`<button id="${o(this,N)}-dialogSaveButton" type="button" class="btn btn-primary" tabindex="0">${t} <span id="${o(this,N)}-dialogSaveButtonText">${e.saveButtonText}</span></button>`:""}
        </div>`;h(this,yi,i)}createContent(e){if(!e||!joint.util.isObject(e))return;let t="";switch(e.contentType){case Y.SINGLE_TEXTBLOCK:t=`<p>${e.text}</p>`;break;case Y.GROUP_FORMS:t=c(this,pa,Fo).call(this,e.groups);break}const a=`<div class="modal-body">${`<div class="container-fluid">${t}</div>`}</div>`;h(this,gi,a)}getIncludedTable(e){return o(this,hi).get(e)}provideCloseButtonActionConfiguration(e){if(e&&"close".localeCompare(e)===0)h(this,pe,()=>{this.hide()});else if(e&&"destroy".localeCompare(e)===0)h(this,pe,()=>{c(this,ae,fe).call(this)});else{if(!e||typeof e!="function")throw new TypeError("The provided action for the close button has to be a function.");h(this,pe,()=>{e()})}}provideSaveButtonActionConfiguration(e,t="destroy",i={}){let a=()=>{c(this,ae,fe).call(this)};if(t&&"close".localeCompare(t)===0?a=()=>{this.hide()}:t&&"destroy".localeCompare(t)===0&&(a=()=>{c(this,ae,fe).call(this)}),!e||typeof e!="function")throw new TypeError("The provided action for the save button has to be a function.");h(this,Ce,()=>{e(i),a()})}configureSaveButtonAction(e){if(!e||typeof e!="function")throw new TypeError("The provided action for the save button has to be a function.");let t=$("#"+o(this,N)+"-dialogSaveButton");t.length?(h(this,Ce,()=>{e(),c(this,ae,fe).call(this)}),t.click(o(this,Ce))):h(this,Ce,()=>{e(),c(this,ae,fe).call(this)})}configureCloseButtonAction(e){if(e&&typeof e!="function")throw new TypeError("The provided action for the close button has to be a function.");$("#"+o(this,N)+"-dialog [data-dismiss=modal]").length&&(h(this,pe,()=>{e()}),closeButtonsAction.click(o(this,pe)))}show(){this.$modalDialog.modal("show")}hide(){this.$modalDialog.modal("hide")}}st=new WeakMap,N=new WeakMap,hi=new WeakMap,Ce=new WeakMap,pe=new WeakMap,da=new WeakMap,ui=new WeakMap,gi=new WeakMap,yi=new WeakMap,pa=new WeakSet,Fo=function(e){if(!e||!Array.isArray(e))return;let t="";for(const i of e){switch(t=t+`<div data-group-context="${o(this,st)}">`,i.contentType){case E.INFO:t=t+c(this,ca,Lo).call(this,i);break;case E.TABLE:t=t+c(this,ha,Go).call(this,i);break;case E.FORMGROUP:t=t+c(this,ua,Wo).call(this,i);break}t=t+"</div>"}return t},ca=new WeakSet,Lo=function(e){return`<h5>${e.headline}</h5><p>${e.text}</p>`},ha=new WeakSet,Go=function(e){const t=`<h5>${e.headline}</h5>`,i=`<p>${e.text}</p>`;let a=new hr(o(this,st),o(this,N));o(this,hi).set(o(this,N),a),a.create(e);const r=a.getCreatedTableTemplate();return`${t}${e.text?i:""}${r}`},ua=new WeakSet,Wo=function(e){const t=`<h5>${e.headline}</h5>`;let i="";for(const a of e.contentItems){const r=new j(a.providedFeature,e.id);let s;switch(a.contentType){case E.INPUT_TEXTBOX:r.addTextElementWithLabel(a.label,a.attributes,a.properties),r._addFormFeedbackSection("Reset: Invalid input provided","Successfully changed."),s=r.getCreatedFormTemplate(!0);break;case E.INPUT_TEXTBOX_LABEL_PREPEND:r.addTextElementWithPrependLabel(a.label,a.attributes,a.properties),r._addFormFeedbackSection("Reset: Invalid input provided","Successfully changed."),s=r.getCreatedFormTemplate(!0);break;case E.BUTTON:s=`<button type="button" id="${a.providedFeature}" class="btn btn-outline-dark">${a.attributes.labelIcon?`<i class="${a.attributes.labelIcon}"></i> `:""}${a.label}</button>`;break;default:r.addTextElementWithLabel(a.label,a.attributes,a.properties),r._addFormFeedbackSection("Reset: Invalid input provided","Successfully changed."),s=r.getCreatedFormTemplate(!0);break}i=i+s}return`<hr>${t}<div id="${e.id}">${i}</div>`},ae=new WeakSet,fe=function(){this.$modalDialog.modal("hide"),this.$modalDialog.off(),this.$modalDialog.modal("dispose"),this.$modalDialog.remove()},ga=new WeakSet,zo=function(e){e.which==13};var K,C,k,Ae,ya,qo,ma,Ho,fa,Uo,ba,jo,Ea,Xo,Be,Ct,mi,ao,va,Vo,fi,oo,Ta,Ko,lt,Oi,De,St,xa,Jo,Ca,Yo,Sa,Qo,wa,Zo,Ia,en;class ur{constructor(e){p(this,ya);p(this,ma);p(this,fa);p(this,ba);p(this,Ea);p(this,Be);p(this,mi);p(this,va);p(this,fi);p(this,Ta);p(this,lt);p(this,De);p(this,xa);p(this,Ca);p(this,Sa);p(this,wa);p(this,Ia);p(this,K,void 0);p(this,C,void 0);p(this,k,new Map);p(this,Ae,new Map);if(!(e instanceof joint.dia.Graph))throw new TypeError("SystemEntityManager: The provided graph has to be a joint.dia.Graph element");h(this,K,e),h(this,C,new Rn("test")),c(this,ya,qo).call(this)}get getCurrentSystemEntity(){const e=JSON.parse(JSON.stringify(o(this,C)));return console.log(e),o(this,C)}}K=new WeakMap,C=new WeakMap,k=new WeakMap,Ae=new WeakMap,ya=new WeakSet,qo=function(){o(this,K).on("initialSystemName",e=>{o(this,C).setSystemName=e.systemName}),o(this,K).on("systemNameChanged",e=>{o(this,C).setSystemName=e.editedAppName}),o(this,K).on("startToscaTransformation",e=>{c(this,ma,Ho).call(this)})},ma=new WeakSet,Ho=function(){var t;if(h(this,k,new Map),h(this,Ae,new Map),o(this,C).resetAllIncludedSystemEntities(),c(this,fa,Uo).call(this),((t=o(this,k))==null?void 0:t.size)>0){c(this,wa,Zo).call(this);return}new sr(o(this,C)).convert()},fa=new WeakSet,Uo=function(){for(const e of o(this,K).getElements())c(this,ba,jo).call(this,e);for(const e of o(this,K).getLinks())c(this,Ea,Xo).call(this,e);c(this,Ta,Ko).call(this)},ba=new WeakSet,jo=function(e){let t="";switch(e.prop("entity/type")){case d.COMPONENT:t=c(this,Be,Ct).call(this,e,d.COMPONENT);break;case d.SERVICE:t=c(this,Be,Ct).call(this,e,d.SERVICE);break;case d.BACKING_SERVICE:t=c(this,Be,Ct).call(this,e,d.BACKING_SERVICE);break;case d.STORAGE_BACKING_SERVICE:t=c(this,Be,Ct).call(this,e,d.STORAGE_BACKING_SERVICE);break;case d.INFRASTRUCTURE:t=c(this,mi,ao).call(this,e);break;case d.DATA_AGGREGATE:t=c(this,fi,oo).call(this,e);break;case d.REQUEST_TRACE:t=c(this,xa,Jo).call(this,e);break;case d.BACKING_DATA:t=c(this,lt,Oi).call(this,e);break;default:return}if(!!t)try{o(this,C).addEntity(t)}catch(i){console.log(i)}},Ea=new WeakSet,Xo=function(e){let t="";switch(e.prop("entity/type")){case d.LINK:t=c(this,Ca,Yo).call(this,e);break;case d.DEPLOYMENT_MAPPING:t=c(this,Sa,Qo).call(this,e);break}if(!!t)try{o(this,C).addEntity(t)}catch(i){console.log(i)}},Be=new WeakSet,Ct=function(e,t){var m,f,T;const a=joint.util.groupBy(o(this,K).getConnectedLinks(e),x=>x.prop("entity/type"))[d.DEPLOYMENT_MAPPING];if(!a||a.length===0||a.length>1){const x=t===d.COMPONENT?"Component":t===d.SERVICE?"Service":t===d.BACKING_SERVICE?"Backing Service":"Storage Backing Service",w=`The ${x} entity is only valid if it is hosted by exactly one Infrastructure entity. However, the ${x} "${e.attr("label/textWrap/text")}" is hosted by none or several Infrastructure 
            entities and is, therefore, invalid.`,b=new B(t!=null?t:d.COMPONENT,A.INVALID_MODEL_ENTIY,e.attr("label/textWrap/text"),"Hosting Relation",w);return o(this,k).set(e.id,b),null}const r=a[0].getSourceElement().prop("entity/type")===d.INFRASTRUCTURE?a[0].getSourceElement():a[0].getTargetElement(),s=(m=o(this,C).getInfrastructureEntities.get(r.getModelId))!=null?m:c(this,mi,ao).call(this,r);if(!s)return null;let l;t===d.COMPONENT?l=new te(e.attr("label/textWrap/text"),e.id,s):t===d.SERVICE?l=new go(e.attr("label/textWrap/text"),e.id,s):t===d.BACKING_SERVICE?(l=new uo(e.attr("label/textWrap/text"),e.id,s),l.providedFunctionality=e.prop("entity/properties/providedFunctionality")):t===d.STORAGE_BACKING_SERVICE?(l=new yo(e.attr("label/textWrap/text"),e.id,s),l.properties={databaseName:e.prop("entity/properties/databaseName"),port:e.prop("entity/properties/port")}):l=new te(e.attr("label/textWrap/text"),e.id,s);let u=e.getEmbeddedCells();for(const x of u)switch(x.prop("entity/type")){case d.ENDPOINT:const w=c(this,De,St).call(this,x,d.ENDPOINT);if(!w)break;l.addEntity(w);break;case d.EXTERNAL_ENDPOINT:const b=c(this,De,St).call(this,x,d.EXTERNAL_ENDPOINT);if(!b)break;l.addEntity(b);break;case d.DATA_AGGREGATE:const v=(f=o(this,C).getDataAggregateEntities.get(x.attr("label/textWrap/text")))!=null?f:c(this,fi,oo).call(this,x,!0);if(!v)break;l.addEntity(v);break;case d.BACKING_DATA:const fo=(T=o(this,C).getBackingDataEntities.get(x.attr("label/textWrap/text")))!=null?T:c(this,lt,Oi).call(this,x);if(!fo)break;l.addEntity(fo);break}return l.position=e.position(),l.size=e.size(),l},mi=new WeakSet,ao=function(e){var a;let t=c(this,va,Vo).call(this,e);if(!t){const r=`A Storage Backing Service entity cannot be deployed with Component, Service or Backing Service entities on the same Infrastructure entity. However, the Infrastructure "${e.attr("label/textWrap/text")}" 
            currently deploys a Storage Backing Service with at least one other entity type and is, therefore, invalid.`,s=new B(d.INFRASTRUCTURE,A.INVALID_MODEL_ENTIY,e.attr("label/textWrap/text"),"Entity Type Deployments",r);return o(this,k).set(e.id,s),null}const i=e.getEmbeddedCells();if(i.length>0)for(const r of i)switch(r.prop("entity/type")){case d.BACKING_DATA:const s=(a=o(this,C).getBackingDataEntities.get(r.attr("label/textWrap/text")))!=null?a:c(this,lt,Oi).call(this,r);if(!s)return null;t.addBackingDataEntity(s);break}return t.position=e.position(),t.size=e.size(),t},va=new WeakSet,Vo=function(e){var r,s;let t=o(this,K).getConnectedLinks(e);if(t.length<=1)return((r=t[0].getTargetElement())==null?void 0:r.prop("entity/type"))!==d.STORAGE_BACKING_SERVICE||((s=t[0].getSourceElement())==null?void 0:s.prop("entity/type"))!==d.STORAGE_BACKING_SERVICE?new re(e.attr("label/textWrap/text"),e.id,we.DBMS):new re(e.attr("label/textWrap/text"),e.id,we.COMPUTE);let i=!1,a=!1;return t.forEach(l=>{var u,m,f,T,x,w;!(((u=l.getTargetElement())==null?void 0:u.prop("entity/type"))===d.INFRASTRUCTURE&&((m=l.getSourceElement())==null?void 0:m.prop("entity/type"))===d.INFRASTRUCTURE)&&((f=l.getTargetElement())==null?void 0:f.prop("entity/type"))!==d.STORAGE_BACKING_SERVICE&&((T=l.getSourceElement())==null?void 0:T.prop("entity/type"))!==d.STORAGE_BACKING_SERVICE&&(a=!0),(((x=l.getTargetElement())==null?void 0:x.prop("entity/type"))===d.STORAGE_BACKING_SERVICE||((w=l.getSourceElement())==null?void 0:w.prop("entity/type"))===d.STORAGE_BACKING_SERVICE)&&(i=!0)}),i&&a?null:i&&!a?new re(e.attr("label/textWrap/text"),e.id,we.DBMS):new re(e.attr("label/textWrap/text"),e.id,we.COMPUTE)},fi=new WeakSet,oo=function(e,t=!1){if(!e||!e.getParentCell()){const s=`A Data Aggregate entity is only valid if it is embedded in one of the component type entities. However, the Data Aggregate "${e.attr("label/textWrap/text")}" has no parent entity 
            and is, therefore, invalid.`,l=new B(d.DATA_AGGREGATE,A.INVALID_MODEL_ENTIY,e.attr("label/textWrap/text"),"Embedded Relation",s);return o(this,k).set(e.id,l),null}const i=new qi(e.attr("label/textWrap/text"),e.id),a=e.prop("entity/properties/embedded");let r=null;return"persisted".localeCompare(a.parentRelation)===0?o(this,C).getDataAggregateEntities.has(i.name)?o(this,C).getDataAggregateEntities.get(i.name).addPersistedByEntity(e.getParentCell().attr("label/textWrap/text")):(i.addPersistedByEntity(e.getParentCell().attr("label/textWrap/text")),r=i):t&&(r=i),o(this,Ae).has(i.name)||o(this,Ae).set(i.name,i),r},Ta=new WeakSet,Ko=function(){for(const e of o(this,Ae).values())if(!o(this,C).getDataAggregateEntities.has(e.getName)){const t=`A Data Aggregate entity has to be persisted by at least one component type entity, preferably a Storage Backing Service. However, the Data Aggreagte 
                "${e.getName}" is currently not persisted by any other entity and is, therefore, invalid.`,i=new B(d.DATA_AGGREGATE,A.INVALID_MODEL_ENTIY,e.getName,"Parent Relation",t);o(this,k).set(e.getModelId,i)}},lt=new WeakSet,Oi=function(e){if(!e||!e.getParentCell()){const a=`A Backing Data entity is only valid if it is embedded in one of the component type or infrastructure entities. However, the Backing Data "${e.attr("label/textWrap/text")}" 
            has no parent entity and is, therefore, invalid.`,r=new B(d.BACKING_DATA,A.INVALID_MODEL_ENTIY,e.attr("label/textWrap/text"),"Embedded Relation",a);return o(this,k).set(e.id,r),null}const t=e.prop("entity/properties/includedData");if(t.length<=0){const a=`A Backing Data entity has to include at least one data item. However, the Backing Data "${e.attr("label/textWrap/text")}" 
            has information included and is, therefore, invalid.`,r=new B(d.BACKING_DATA,A.MISSING_INFORMATION,e.attr("label/textWrap/text"),"Included Data",a);return o(this,k).set(e.id,r),null}const i=new It(e.id,e.attr("label/textWrap/text"),t);if(o(this,C).getBackingDataEntities.has(i.name))return null;try{return i}catch(a){console.log(a)}},De=new WeakSet,St=function(e,t){const i=t===d.ENDPOINT?"Endpoint":"External Endpoint";if(!e||!e.getParentCell()){const l=`An ${i} entity is only valid if it is embedded in one of the component type entities. However, the ${i} "${e.attr("label/textWrap/text")}" has no parent entity 
            and is, therefore, invalid.`,u=new B(t===d.ENDPOINT?d.ENDPOINT:d.EXTERNAL_ENDPOINT,A.INVALID_MODEL_ENTIY,e.attr("label/textWrap/text"),"Embedded Relation",l);return o(this,k).set(e.id,u),null}const a=e.prop("entity/properties/endpointType"),r=e.prop("entity/properties/endpointPath"),s=e.prop("entity/properties/port");if(!a||typeof a!="string"){const l=`An ${i} entity is only valid if it defines its type, e.g. POST or subscribes-to. However, the ${i} "${e.attr("label/textWrap/text")}" does not provide this information 
            and is, therefore, invalid.`,u=new B(t===d.ENDPOINT?d.ENDPOINT:d.EXTERNAL_ENDPOINT,A.MISSING_INFORMATION,e.attr("label/textWrap/text"),"Endpoint Type",l);return o(this,k).set(e.id,u),null}if(!r||typeof r!="string"){const l=`An ${i} entity is only valid if it specifies its URL path, e.g. /customers/{customerId}. However, the ${i} "${e.attr("label/textWrap/text")}" does not provide this information 
            and is, therefore, invalid.`,u=new B(t===d.ENDPOINT?d.ENDPOINT:d.EXTERNAL_ENDPOINT,A.MISSING_INFORMATION,e.attr("label/textWrap/text"),"Endpoint Path",l);return o(this,k).set(e.id,u),null}if(!s||isNaN(s)){const l=`An ${i} entity is only valid if it provides the port at which it is available, e.g. 8001. However, the ${i} "${e.attr("label/textWrap/text")}" does not provide this information 
            and is, therefore, invalid.`,u=new B(t===d.ENDPOINT?d.ENDPOINT:d.EXTERNAL_ENDPOINT,A.MISSING_INFORMATION,e.attr("label/textWrap/text"),"Port",l);return o(this,k).set(e.id,u),null}if(t===d.EXTERNAL_ENDPOINT){let l=new zi(e.id,a,r,s,e.getParentCell().attr("label/textWrap/text"));return l.position=e.position(),l.size=e.size(),l.label=e.attr("label/textWrap/text"),l}else{let l=new kt(e.id,a,r,s,e.getParentCell().attr("label/textWrap/text"));return l.position=e.position(),l.size=e.size(),l.label=e.attr("label/textWrap/text"),l}},xa=new WeakSet,Jo=function(e){const t=e.prop("entity/properties/referredEndpoint");if(!t||!t.trim()){const s=`A Request Trace entity is only valid if it specifies its referred External Endpoint entity. However, for the Request Trace "${e.attr("label/textWrap/text")}" 
            no External Endpoint was selected and it is, therefore, invalid.`,l=new B(d.REQUEST_TRACE,A.INVALID_MODEL_ENTIY,e.attr("label/textWrap/text"),"External Endpoint",s);return o(this,k).set(e.id,l),null}const i=e.prop("entity/properties/involvedLinks");if(!i||!i[0]||i[0].length<=0){const s=`A Request Trace entity is only valid if it specifies its involved Link entities. However, the Request Trace "${e.attr("label/textWrap/text")}" 
            does not provide any information about its involved Links and it is, therefore, invalid.`,l=new B(d.REQUEST_TRACE,A.INVALID_MODEL_ENTIY,e.attr("label/textWrap/text"),"Involved Links",s);return o(this,k).set(e.id,l),null}const a=c(this,De,St).call(this,o(this,K).getCell(t),d.EXTERNAL_ENDPOINT);if(!a)return null;const r=new eo(e.attr("label/textWrap/text"),e.id,a,i[0]);return r.position=e.position(),r.size=e.size(),r},Ca=new WeakSet,Yo=function(e){var u,m;const t=e.getSourceElement(),i=e.getTargetElement();if(!t&&i){const f="There exists a Link that is missing its source entity.",T=new B(d.LINK,A.INVALID_MODEL_ENTIY,"Target: "+i.attr("label/textWrap/text"),"Link Source Entity",f);return o(this,k).set(e.id,T),null}if(!i&&t){const f="There exists a Link that is missing its target entity.",T=new B(d.LINK,A.INVALID_MODEL_ENTIY,"Source: "+t.attr("label/textWrap/text"),"Link Target Entity ",f);return o(this,k).set(e.id,T),null}if(!i&&!t){const f="There exists a Link that is missing its source and target entity.",T=new B(d.LINK,A.INVALID_MODEL_ENTIY,e.id,"Link Source and Target Entity",f);return o(this,k).set(e.id,T),null}const a=e.prop("entity/properties/relationType"),r=o(this,C).getComponentEntities.get(t.id),s=(u=o(this,C).getDataAggregateEntities.get(i.attr("label/textWrap/text")))!=null?u:c(this,De,St).call(this,i,i.prop("entity/type"));if(!r||!s)return null;let l=new Hi(e.id,r,s);if(l.addRelationType(a),r&&r.addLinkEntity(l),o(this,C).getRequestTraceEntities)for(const f of o(this,C).getRequestTraceEntities.values())(m=f.getLinkEntityIds)!=null&&m.has(e.id)&&f.addLinkEntity(l);return l},Sa=new WeakSet,Qo=function(e){const t=e.getSourceElement(),i=e.getTargetElement();if(!t&&i){const s="There exists a Deployment Mapping that is missing its source entity.",l=new B(d.LINK,A.INVALID_MODEL_ENTIY,"Target: "+i.attr("label/textWrap/text"),"Deployment Mapping Source Entity",s);return o(this,k).set(e.id,l),null}if(!i&&t){const s="There exists a Deployment Mapping that is missing its target entity.",l=new B(d.LINK,A.INVALID_MODEL_ENTIY,"Source: "+t.attr("label/textWrap/text"),"Deployment Mapping Target Entity",s);return o(this,k).set(e.id,l),null}if(!i&&!t){const s="There exists a Deployment Mapping that is missing its source and target entity.",l=new B(d.LINK,A.INVALID_MODEL_ENTIY,e.id,"Deployment Mapping Source and Target Entity",s);return o(this,k).set(e.id,l),null}let a,r;return t.prop("entity/type")===d.INFRASTRUCTURE?(a=o(this,C).getInfrastructureEntities.get(t.id),i.prop("entity/type")===d.INFRASTRUCTURE?r=o(this,C).getInfrastructureEntities.get(i.id):r=o(this,C).getComponentEntities.get(i.id)):(a=o(this,C).getInfrastructureEntities.get(i.id),r=o(this,C).getComponentEntities.get(t.id)),!a||!r?null:new Za(e.id,r,a)},wa=new WeakSet,Zo=function(){let e=new se("invalidToscaModelItems-error","invalidToscaModelItems");const t=c(this,Ia,en).call(this);To.content.groups.forEach(i=>{String("invalid-model-elements-table").localeCompare(i.id)===0&&(i.tableRows=t)}),e.create(To),e.render("modals",!0,Nt.EXTRA_LARGE),e.show()},Ia=new WeakSet,en=function(){let e=new Array;for(const t of o(this,k).values())e.push({entityType:t.getAffectedEntityType,errorType:t.getErrorType,entity:t.getEntityName,affectedInformation:t.getAffectedInformation,message:t.getMessage});return e};const To={type:"modalDialog",header:{iconClass:"fa-solid fa-triangle-exclamation",type:"error",text:"Invalid Model Items",closeButton:!0},footer:{cancelButtonText:"Ok, understood"},content:{contentType:Y.GROUP_FORMS,groups:[{id:"invalid-model-elements-table",contentType:E.TABLE,headline:"Identified Error",text:`The following table shows all identified errors that prevent a valid TOSCA transformation. 
                Please fix the following error, and then try to restart the transformation process. `,tableColumnHeaders:[{text:"Entity Type"},{text:"Error Type"},{text:"Affected Entity"},{text:"Affected Information"},{text:"Message"}],tableRows:[]}]}},le="sans-serif",Et="icon/magnifying-glass-plus-solid.svg";joint.dia.Element.define("qualityModel.Component",{defaults:{size:{width:160,height:80},fontSize:14,fill:"white",stroke:"black",strokeWidth:2},size:{width:160,height:80},attrs:{body:{width:"calc(l)",height:"calc(0.5*l)",rx:2,ry:2,strokeDasharray:0,strokeWidth:2,stroke:"black",fill:"white",class:"entityShape"},label:{ref:"body",fill:"black",fontFamily:le,fontWeight:"Normal",fontSize:14,strokeWidth:0,textAnchor:"middle",textVerticalAnchor:"top",refX:"50%",refY:"10%",textWrap:{text:"Component"},class:"entityLabel"},icon:{title:"Expand to show included entities",ref:"body",href:Et,class:"expandEntityIcon",transform:"scale(calc(0.0018 * h))",refX:"50%",refY:"90%",xAlignment:"middle",yAlignment:"bottom",preserveAspectRatio:"xMidYMin",visibility:"hidden",event:"element:icon:pointerclick"}},collapsed:!1,entityTypeHidden:!1,entity:{type:d.COMPONENT}},{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"},{tagName:"image",selector:"icon"}]});joint.dia.Element.define("qualityModel.Service",{defaults:{size:{width:140,height:120},fontSize:14,fill:"white",stroke:"black",strokeWidth:2},size:{width:140,height:120},attrs:{body:{points:"calc(0.25 * l),0 calc(0.75 * l),0 calc(l),calc(0.4 * l) calc(0.75 * l),calc(0.8 * l) calc(0.25 * l),calc(0.8 * l) 0,calc(0.4 * l)",strokeDasharray:0,strokeWidth:2,stroke:"black",fill:"white",class:"entityShape"},label:{ref:"body",fill:"black",fontFamily:le,fontWeight:"Normal",fontSize:14,strokeWidth:0,textAnchor:"middle",textVerticalAnchor:"top",refX:"50%",refY:"10%",textWrap:{width:"80%",text:"Service"},class:"entityLabel"},icon:{title:"Expand to show included entities",ref:"body",href:Et,class:"expandEntityIcon",transform:"scale(calc(0.0014 * h))",refX:"50%",refY:"95%",xAlignment:"middle",yAlignment:"bottom",preserveAspectRatio:"xMidYMin",visibility:"hidden",event:"element:icon:pointerclick"}},collapsed:!1,entityTypeHidden:!1,entity:{type:d.SERVICE}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"},{tagName:"image",selector:"icon"}]});joint.dia.Element.define("qualityModel.BackingService",{defaults:{size:{width:200,height:120},fontSize:14,fill:"white",stroke:"black",strokeWidth:2},size:{width:200,height:120},attrs:{body:{points:"calc(0.5 * l),0 calc(l),calc(0.3 * l) calc(0.5 * l),calc(0.6 * l) 0,calc(0.3 * l)",strokeWidth:2,stroke:"black",fill:"white",class:"entityShape"},label:{ref:"body",fill:"black",fontFamily:le,fontWeight:"Normal",fontSize:14,strokeWidth:0,textAnchor:"middle",textVerticalAnchor:"top",refX:"50%",refY:"40%",textWrap:{text:"Backing Service"},class:"entityLabel"},icon:{title:"Expand to show included entities",ref:"body",href:Et,class:"expandEntityIcon",transform:"scale(calc(0.0013 * h))",refX:"49%",refY:"90%",xAlignment:"middle",yAlignment:"bottom",preserveAspectRatio:"xMidYMin",visibility:"hidden",event:"element:icon:pointerclick"}},collapsed:!1,entityTypeHidden:!1,entity:{type:d.BACKING_SERVICE,properties:{providedFunctionality:""}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"},{tagName:"image",selector:"icon"}]});joint.shapes.standard.Cylinder.define("qualityModel.StorageBackingService",{defaults:{size:{width:160,height:140},fontSize:14,fill:"white",stroke:"black",strokeWidth:2},size:{width:160,height:140},attrs:{body:{strokeWidth:2,stroke:"black",fill:"white",class:"entityShape"},top:{strokeWidth:2,stroke:"black",fill:"white",class:"entityShape"},label:{ref:"body",fill:"black",fontFamily:le,fontWeight:"Normal",fontSize:14,strokeWidth:0,textAnchor:"middle",textVerticalAnchor:"top",refY:"12%",textWrap:{width:"95%",text:"Storage Backing Service"},class:"entityLabel"},icon:{title:"Expand to show included entities",ref:"body",href:Et,class:"expandEntityIcon",transform:"scale(calc(0.0011 * h))",refX:"49%",refY:"95%",xAlignment:"middle",yAlignment:"bottom",preserveAspectRatio:"xMidYMin",visibility:"hidden",event:"element:icon:pointerclick"}},collapsed:!1,entityTypeHidden:!1,entity:{type:d.STORAGE_BACKING_SERVICE,properties:{databaseName:"",port:""}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"},{tagName:"image",selector:"icon"}]});joint.shapes.standard.Circle.define("qualityModel.Endpoint",{defaults:{size:{width:50,height:50},fontSize:11,fill:"white",stroke:"black",strokeWidth:2},size:{width:50,height:50},attrs:{body:{fill:"white",stroke:"black",strokeWidth:2,strokeDasharray:"0"},label:{fill:"black",fontFamily:le,fontWeight:"Normal",fontSize:14,strokeWidth:0,textAnchor:"middle",textVerticalAnchor:"middle",textWrap:{text:"Endpoint"}}},entityTypeHidden:!1,parentCollapsed:!1,entity:{type:d.ENDPOINT,isEmbedded:!1,properties:{endpointType:"",endpointPath:"",port:""}}},{markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}]});joint.shapes.standard.Circle.define("qualityModel.ExternalEndpoint",{defaults:{size:{width:50,height:50},fontSize:11,fill:"black",stroke:"black",strokeWidth:2},size:{width:50,height:50},attrs:{body:{fill:"black",stroke:"black",strokeWidth:2,strokeDasharray:"0"},label:{fill:"white",fontFamily:le,fontWeight:"Normal",fontSize:14,strokeWidth:0,textAnchor:"middle",textVerticalAnchor:"middle",textWrap:{text:"External Endpoint"}}},entityTypeHidden:!1,parentCollapsed:!1,entity:{type:d.EXTERNAL_ENDPOINT,isEmbedded:!1,properties:{endpointType:"",endpointPath:"",port:""}}},{markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}]});joint.dia.Element.define("qualityModel.Infrastructure",{defaults:{size:{width:180,height:90},fontSize:14,fill:"white",stroke:"black",strokeWidth:2},size:{width:180,height:90},attrs:{body:{points:"calc(0.15 * l),0 calc(0.85 * l),0 calc(l),calc(0.5 * l) 0,calc(0.5 * l)",strokeWidth:2,stroke:"black",fill:"white",class:"entityShape"},label:{ref:"body",fill:"black",fontFamily:le,fontWeight:"Normal",fontSize:14,strokeWidth:0,textAnchor:"middle",textVerticalAnchor:"top",refX:"50%",y:"calc(y + 10)",textWrap:{text:"Backing Service"},class:"entityLabel"},icon:{title:"Expand to show included entities",ref:"body",href:Et,class:"expandEntityIcon",transform:"scale(calc(0.0017 * h))",refX:"49%",refY:"90%",xAlignment:"middle",yAlignment:"bottom",preserveAspectRatio:"xMidYMin",visibility:"hidden",event:"element:icon:pointerclick"}},entityTypeHidden:!1,collapsed:!1,entity:{type:d.INFRASTRUCTURE}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"},{tagName:"image",selector:"icon"}]});joint.dia.Element.define("qualityModel.RequestTrace",{defaults:{size:{width:190,height:76},fontSize:14,fill:"white",stroke:"black",strokeWidth:2},size:{width:190,height:76},attrs:{body:{points:"0,0 calc(0.8 * l),0 calc(l),calc(0.2 * l) calc(0.8 * l),calc(0.4 * l) 0,calc(0.4 * l) calc(0.2 * l),calc(0.2 * l)",strokeWidth:2,stroke:"black",fill:"white",class:"entityShape"},label:{ref:"body",fill:"black",fontFamily:le,fontWeight:"Normal",fontSize:14,strokeWidth:0,textAnchor:"middle",textVerticalAnchor:"top",refX:"47%",refY:"10%",textWrap:{text:"Backing Service"},class:"entityLabel"},icon:{title:"Expand to show included entities",ref:"body",href:Et,class:"expandEntityIcon",transform:"scale(calc(0.0021 * h))",refX:"49%",refY:"90%",xAlignment:"middle",yAlignment:"bottom",preserveAspectRatio:"xMidYMin",visibility:"visible",event:"requestTrace:icon:pointerclick"}},entityTypeHidden:!1,collapsed:!0,entity:{type:d.REQUEST_TRACE,properties:{referredEndpoint:"",involvedLinks:[]}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"},{tagName:"image",selector:"icon"}]});const xo=joint.shapes.standard.Link.define("qualityModel.Link",{attrs:{root:{title:"Link"},line:{stroke:"black",strokeDasharray:"none",strokeWidth:2,strokeLineJoin:"round",targetMarker:{type:"path",d:"M 10 -5 0 0 10 5 z"}}},entityTypeHidden:!1,entity:{type:d.LINK,properties:{relationType:""}}}),Co=joint.shapes.standard.Link.define("qualityModel.DeploymentMapping",{attrs:{root:{title:"Deployment Mapping"},line:{stroke:"black",strokeDasharray:4,strokeLineJoin:"round",targetMarker:"none",markerEnd:"none"}},entityTypeHidden:!1,entity:{type:d.DEPLOYMENT_MAPPING}});joint.dia.Element.define("qualityModel.DataAggregate",{defaults:{size:{width:50,height:25},fontSize:13,fill:"white",stroke:"black",strokeWidth:2},size:{width:50,height:25},attrs:{body:{rx:"calc(l)",ry:"calc(0.5 * l)",cx:"calc(l)",cy:"calc(0.5 * l)",fill:"white",stroke:"black",strokeWidth:2,strokeDasharray:"0"},label:{ref:"body",fill:"black",fontFamily:le,fontWeight:"Normal",fontSize:14,strokeWidth:0,textAnchor:"middle",textVerticalAnchor:"middle",refX:"50%",refY:"50%",textWrap:{text:"Data Aggregate"}}},entityTypeHidden:!1,parentCollapsed:!1,entity:{type:d.DATA_AGGREGATE,isEmbedded:!1,properties:{assignedFamily:"",embedded:{parentId:"",parentRelation:""}}}},{markup:[{tagName:"ellipse",selector:"body"},{tagName:"text",selector:"label"}]});joint.dia.Element.define("qualityModel.BackingData",{defaults:{size:{width:100,height:60},fontSize:14,fill:"white",stroke:"black",strokeWidth:2},size:{width:100,height:60},attrs:{body:{d:"M 0 0 L calc(0.7 * l) 0 Q calc(l) 0 calc(l) calc(0.3 * l) Q calc(l) calc(0.6 * l) calc(0.7 * l) calc(0.6 * l) L 0 calc(0.6 * l) Z",fill:"white",stroke:"black",strokeWidth:2,strokeDasharray:"0"},label:{ref:"body",fill:"black",fontFamily:le,fontWeight:"Normal",fontSize:14,strokeWidth:0,textAnchor:"middle",textVerticalAnchor:"middle",refX:"50%",refY:"50%",textWrap:{text:"Backing Data"}}},entityTypeHidden:!1,parentCollapsed:!1,entity:{type:d.BACKING_DATA,isEmbedded:!1,properties:{includedData:[],assignedFamily:""}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}]});let gr=joint.linkTools.Remove.extend({name:"remove",children:[{tagName:"title",selector:"iconTooltip",textContent:"Remove entire entity"},{tagName:"circle",selector:"button",attributes:{r:7,fill:"#33334F",cursor:"pointer",class:"entityTool"}},{tagName:"path",selector:"icon",attributes:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,pointerEvents:"none"}}]});class tn extends joint.dia.ToolsView{constructor(t=!1){super({name:"ConnectionTools"});g(this,"use strict");g(this,"tools",[]);this.options.tools=[this.createRemoveTool(),this.createArrowHeadTool(),this.createSourceAnchorTool(),this.createTargetAnchorTool(),this.createVerticesTools(),this.createSegmentsTool()],t&&this.options.tools.push(this.createSourceArrowHeadTool()),this.tools=this.options.tools}createRemoveTool(){return new gr({focusOpacity:.5,distance:20,offset:-15})}createSourceArrowHeadTool(){return new joint.linkTools.SourceArrowhead({focusOpacity:.5})}createArrowHeadTool(){return new joint.linkTools.TargetArrowhead({focusOpacity:.5})}createSourceAnchorTool(){let t=new joint.linkTools.SourceAnchor({focusOpacity:.5});return t.options.customAnchorAttributes.r=4,t.options.defaultAnchorAttributes.r=5,t}createTargetAnchorTool(){return new joint.linkTools.TargetAnchor({focusOpacity:.5})}createSegmentsTool(){return new joint.linkTools.Segments({focusOpacity:.5})}createVerticesTools(){return new joint.linkTools.Vertices({focusOpacity:.5,vertexAdding:!1})}}const yr=joint.mvc.View.extend({className:"modelingArea",el:".visible-modeling-area",_paper:null,_currentSelection:"",_currentRequestTraceViewSelection:"",_hiddenEntities:new Set,options:{el:".visible-modeling-area",graph:null,paper:null},init(){if(!(this.options.graph instanceof joint.dia.Graph))throw new TypeError("ModelingArea: The provided graph has to be a joint.dia.Graph element");this._createModelingArea(),this.$document=$(this.el.ownerDocument);let n=new joint.dia.Paper({el:$("#jointPaper"),width:1200,height:3e3,gridSize:10,drawGrid:!0,model:this.options.graph,embeddingMode:!0,background:{color:"rgba(192, 192, 192, 0.3)"},async:!0,sorting:joint.dia.Paper.sorting.APPROX,cellNamespace:joint.shapes,routerNamespace:joint.routers,defaultLink:(e,t)=>this.defaultLink(e,t),defaultRouter:{name:"manhattan"},defaultConnector:{name:"rounded",args:{radius:4}},defaultConnectionPoint:{name:"boundary",args:{sticky:!0,stroke:!0}},linkView:joint.dia.LinkView.extend({pointerdblclick:function(e,t,i){this.addVertex(t,i)}}),validateConnection:(e,t,i,a,r,s)=>this.validateLinks(e,t,i,a,r,s),validateEmbedding:(e,t)=>this.validateEmbedding(e,t),validateUnembedding:e=>this.validateUnembedding(e),allowLink:(e,t)=>this.checkCreatedLink(e,t),interactive:{labelMove:!1,addLinkFromMagnet:!0,linkMove:!0,vertexAdd:!1},restrictTranslate:!0,markAvailable:!0,multiLinks:!1});this.options.paper=n,this._paper=n,this.configureHandlingPaperEvents()},_createModelingArea(){const n=`<div class="system-container" data-cursor=grab>
            <div class="system-container-modeling-area">
                <div class="paperArea">
                    <div id="jointPaper"></div>
                </div>
            </div>
        </div>`;$(".visible-modeling-area").append(n)},render(){return this._paper.render(),this},validateLinks(n,e,t,i,a,r){if(!n||!t)return this.handleSidebarLink(n,t,a,r);if(e&&i&&e===i||t&&n&&(t.model.isLink()||n.model.isLink())||n===t||this.checkIfConnectionAlreadyExists(n,t))return!1;if(!e||!i&&!e){if(t&&t.model.prop("entity/type")==d.ENDPOINT||t.model.prop("entity/type")==d.EXTERNAL_ENDPOINT)return this.connectableEntity(n)&&!t.model.isEmbeddedIn(n.model);if(t&&t.model.attributes.entity.type===d.INFRASTRUCTURE)return this.deployableEntity(n)}return a==="source"?!1:this.connectableEntity(n)?t.model.attributes.entity.type===d.ENDPOINT||t.model.attributes.entity.type===d.EXTERNAL_ENDPOINT?!t.model.isEmbeddedIn(n.model)&&t.model.getParentCell():t.model.attributes.entity.type===d.INFRASTRUCTURE:n.model.attributes.entity.type===d.INFRASTRUCTURE?this.deployableEntity(t):!1},handleSidebarLink(n,e,t,i){return!n&&e&&t==="target"?i.model.prop("entity/type")===d.DEPLOYMENT_MAPPING?e.model.attributes.entity.type===d.INFRASTRUCTURE:(e.model.attributes.entity.type===d.ENDPOINT||e.model.attributes.entity.type===d.EXTERNAL_ENDPOINT)&&e.model.getParentCell():!e&&n&&t==="source"?i.model.prop("entity/type")===d.LINK?this.connectableEntity(n):this.deployableEntity(n):!1},deployableEntity(n){return n.model.attributes.entity.type===d.COMPONENT||n.model.attributes.entity.type===d.SERVICE||n.model.attributes.entity.type===d.BACKING_SERVICE||n.model.attributes.entity.type===d.STORAGE_BACKING_SERVICE||n.model.attributes.entity.type===d.INFRASTRUCTURE},connectableEntity(n){return n.model.attributes.entity.type===d.COMPONENT||n.model.attributes.entity.type===d.SERVICE||n.model.attributes.entity.type===d.BACKING_SERVICE||n.model.attributes.entity.type===d.STORAGE_BACKING_SERVICE},checkIfConnectionAlreadyExists(n,e){let t=!1;return this.options.graph.getConnectedLinks(e.model).forEach(i=>{if(i.prop("target/id")===e.model.id&&i.prop("source/id")===n.model.id){t=!0;return}else if(i.prop("source/id")===e.model.id&&i.prop("target/id")===n.model.id){t=!0;return}}),t},validateEmbedding(n,e){switch(e.model.attributes.entity.type){case d.COMPONENT:case d.SERVICE:case d.BACKING_SERVICE:case d.STORAGE_BACKING_SERVICE:return this.checkIfConnectionAlreadyExists(n,e)?!1:n.model.attributes.entity.type===d.ENDPOINT||n.model.attributes.entity.type===d.EXTERNAL_ENDPOINT||n.model.attributes.entity.type===d.DATA_AGGREGATE||n.model.attributes.entity.type===d.BACKING_DATA;case d.INFRASTRUCTURE:return n.model.attributes.entity.type===d.BACKING_DATA;default:return!1}},validateUnembedding(n){return!n.model.attributes.entity.type===d.ENDPOINT||!n.model.attributes.entity.type===d.EXTERNAL_ENDPOINT||!n.model.attributes.entity.type===d.DATA_AGGREGATE||!n.model.attributes.entity.type===d.BACKING_DATA},checkCreatedLink(n,e){return n.targetBBox.x===0&&n.targetBBox.y===0||n.sourceBBox.x===0&&n.sourceBBox.y===0},defaultLink(n,e){return n.model.attributes.entity.type===d.INFRASTRUCTURE?new Co:new xo},getPaper(){return this._paper},configureHandlingPaperEvents(){this._paper.on({"element:pointerdown":function(n,e,t,i){this.hideTools();let a=this;this.model.getLinks().forEach(function(r){joint.highlighters.stroke.remove(r.findView(a))}),n.showTools()},"blank:pointerdown":function(n,e,t){this.hideTools();let i=this;this.model.getLinks().forEach(function(a){joint.highlighters.stroke.remove(a.findView(i))})},"element:contextmenu":function(n,e,t,i){n.showTools()},"link:pointerclick":function(n,e){if(n.unhighlight(),n.hasTools()){n.highlight(),n.showTools();return}n.highlight();let t=new tn;n.addTools(t)},"cell:highlight":function(n,e,t){n.model.isLink()&&(this.hideTools(),this.model.getLinks().forEach(function(i){if(i!==n.model){joint.highlighters.stroke.remove(i.findView(n.paper));return}}))},"link:connect":(n,e,t,i,a)=>this.configureLink(n,e,t,i,a),"element:icon:pointerclick":(n,e)=>this.onEntityCollapsed(e,n),"requestTrace:icon:pointerclick":(n,e,t,i)=>this.onShowRequestTraceIncludedEntities(n,e)}),this.listenTo(this.options.graph,"change:parent",n=>{n.prop("entity/isEmbedded",!0)})},onEntityCollapsed(n,e){n.stopPropagation(),e.model.prop("collapsed",!1),e.model.attr("icon/visibility","hidden"),e.model.getEmbeddedCells({deep:!0}).forEach(i=>{const r=i.prop("entityTypeHidden")?"hidden":"visible";i.attr("root/visibility",r,{isolate:!0}),i.prop("parentCollapsed",!1)})},onShowRequestTraceIncludedEntities(n,e){e.stopPropagation(),n.model.prop("collapsed",!1),n.model.attr("icon/visibility","hidden"),n.model.attr("body/fill","gold"),$("#exitRequestTraceView-button").show(),$("#exitRequestTraceView-button").click(r=>{this.onExitRequestTraceView(r)}),this._currentRequestTraceViewSelection=n.model;const t=n.model.prop("entity/properties/involvedLinks");let i=new Set(t[0]);if(i.add(n.model.id),i.add(n.model.prop("entity/properties/referredEndpoint")),t&&t.length>0)for(const r of t[0]){const s=this.options.graph.getCell(r);i.add(s.getTargetElement().id),i.add(s.getTargetElement().parent()),i.add(s.getSourceElement().id)}const a=this.options.graph.getCells();this._hiddenEntities=new Set;for(const r of a)i.has(r.id)||(this._hiddenEntities.add(r.id),r.attr("root/visibility","hidden",{isolate:!0}))},onExitRequestTraceView(n){var t,i,a;$("#exitRequestTraceView-button").hide(),(t=this._currentRequestTraceViewSelection)==null||t.attr("body/fill","white"),(i=this._currentRequestTraceViewSelection)==null||i.attr("icon/visibility","visible"),(a=this._currentRequestTraceViewSelection)==null||a.prop("collapsed",!0);const e=this.options.graph.getCells();for(const r of e)r.attr("root/visibility","visible",{isolate:!0})},configureLink(n,e,t,i,a){let r=n.model.attributes.source,s=n.model.attributes.target;if(n.model.prop("entity/type")===d.LINK&&t.model.prop("entity/type")===d.INFRASTRUCTURE){let l=new Co;n.model.source(r),n.model.target(s),n.model.set("type",l.prop("type")),n.model.attr("root",l.attr("root")),n.model.attr("line",l.attr("line")),n.model.prop("entity",l.prop("entity"),{previousType:d.LINK})}if(n.model.prop("entity/type")===d.DEPLOYMENT_MAPPING&&(t.model.prop("entity/type")===d.ENDPOINT||t.model.prop("entity/type")===d.EXTERNAL_ENDPOINT)){let l=new xo;n.model.source(r),n.model.target(s),n.model.set("type",l.prop("type")),n.model.attr("root",l.attr("root")),n.model.attr("line",l.attr("line")),n.model.prop("entity",l.prop("entity"),{previousType:d.DEPLOYMENT_MAPPING});return}!n.model.getSourceElement()||!n.model.getTargetElement()||n.model.prop("entity/type")===d.LINK||this.checkIfStorageBackingServiceConnected(n,t)},checkIfStorageBackingServiceConnected(n,e){var s;let t=((s=n.model.getSourceElement())==null?void 0:s.prop("entity/type"))===d.INFRASTRUCTURE?n.model.getSourceElement():e.model,i=e.model.graph.getConnectedLinks(t);if(i.length<=1)return;let a=!1,r=!1;i.forEach(l=>{var u,m,f,T,x,w;!(((u=l.getTargetElement())==null?void 0:u.prop("entity/type"))===d.INFRASTRUCTURE&&((m=l.getSourceElement())==null?void 0:m.prop("entity/type"))===d.INFRASTRUCTURE)&&((f=l.getTargetElement())==null?void 0:f.prop("entity/type"))!==d.STORAGE_BACKING_SERVICE&&((T=l.getSourceElement())==null?void 0:T.prop("entity/type"))!==d.STORAGE_BACKING_SERVICE&&(r=!0),(((x=l.getTargetElement())==null?void 0:x.prop("entity/type"))===d.STORAGE_BACKING_SERVICE||((w=l.getSourceElement())==null?void 0:w.prop("entity/type"))===d.STORAGE_BACKING_SERVICE)&&(a=!0)}),a&&r&&this.provideConnectionWarningDialog()},provideConnectionWarningDialog(){let n=new se("invalidToscaConnection-information","invalidToscaConnection");n.create(mr),n.render("modals",!0),n.show()}}),mr={type:"modalDialog",header:{iconClass:"fa-solid fa-triangle-exclamation",type:"warning",text:"Deployment Mapping Connection",closeButton:!0},footer:{cancelButtonText:"Ok, understood"},content:{contentType:Y.SINGLE_TEXTBLOCK,text:"You are currently deploying at least one Storage Backing Service entity with Component, Service or Backing Service entities on the same Infrastructure. Although the modeling is generally possible, you won't be able to transform it into the TOSCA format like this. If you want to transform it into the TOSCA format, you have to introduce a new Infrastructure entity between the Storage Backing Service and the current Infrastructure entity."}},Q=Object.freeze({BUTTON:"button",CHECKBOX:"checkbox",INPUT_TEXTBOX:"text",INPUT_NUMBERBOX:"number",INPUT_RANGE:"range"}),O={title:{text:"Application Settings",icon:"fa-solid fa-gear"},content:{Size:{id:"modeling-area-size",heading:"Modeling Area Size",sectionContent:{PaperWidth:{providedFeature:"paperWidth",name:"Width",icon:"fa-solid fa-ruler-horizontal",type:Q.INPUT_NUMBERBOX,defaultValue:1e3,min:100,helpText:"Due to the included content the value has to be greater than",additionalItems:[{text:"Reset",type:Q.BUTTON}]},PaperHeight:{providedFeature:"paperHeight",name:"Height",icon:"fa-solid fa-ruler-vertical",type:Q.INPUT_NUMBERBOX,defaultValue:3e3,min:100,helpText:"Due to the included content the value has to be greater than",additionalItems:[{text:"Reset",type:Q.BUTTON}]}}},Grid:{id:"modeling-area-grid",heading:"Modeling Area Grid",sectionContent:{Size:{providedFeature:"gridSize",name:"Size",icon:"",type:Q.INPUT_RANGE,defaultValue:10,min:1,max:50,additionalItems:[{text:"Reset",type:Q.BUTTON}]},Thickness:{providedFeature:"gridThickness",name:"Thickness",icon:"",type:Q.INPUT_RANGE,defaultValue:1,min:1,max:10,additionalItems:[{text:"Reset",type:Q.BUTTON}]}}}},cancelButton:{text:"Cancel"},saveButton:{icon:"fa-regular fa-floppy-disk",text:"Apply changes",action:function(){}}};var bi,Ei,ka,on,Na,nn,$a,rn,dt,Pi,pt,Mi,ct,Fi,Aa,sn;class an{constructor(){p(this,ka);p(this,Na);p(this,$a);p(this,dt);p(this,pt);p(this,ct);p(this,Aa);p(this,bi,void 0);p(this,Ei,"fa-solid fa-info");let e='<div class="modal" id="staticModal" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="modalTitle" aria-hidden="true"></div>';$("#app").append(e);let t='<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable"><div class="modal-content"></div></div>';$("#staticModal").append(t);let i='<div class="modal-header"></div>';$("#staticModal .modal-content").append(i);let a='<h5 class="modalTitleIcon modal-title"><i id="modalTitleIcon" class="'+o(this,Ei)+'"></i></h5>',r='<h5 class="modal-title" id="modalTitle"></h5>',s='<button type="button" id="closeModalButton" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';$("#staticModal .modal-header").append(a,r,s);let l='<div class="modal-body"></div>',u='<div class="modal-footer"></div>';$("#staticModal .modal-content").append(l,u);let m='<button id="modalCancelButton" type="button" class="btn btn-secondary" data-dismiss="modal" tabindex="0"></button>',f='<button id="modalSaveButton" type="button" class="btn btn-primary" tabindex="0"><i id="modalSaveButtonIcon"></i><span id="modalSaveButtonText"></span></button>';$("#staticModal .modal-footer").append(m,f),h(this,bi,"staticModalWindow"),this.hide(),$("#closeModalButton").click(()=>{this.resetDialog()}),$("#staticModal").keydown(T=>{c(this,Aa,sn).call(this,T)}),$("#staticModal button").on("click",()=>{$(":focus").blur()})}renderDialogBasics(e="",t="Cancel",i="",a="",r=""){c(this,dt,Pi).call(this,e),c(this,pt,Mi).call(this,t);let s='<div id="'+a+'-modalDialog" class="modalDialogActionContainer container-fluid"></div>';$(".modal-body").append(s),console.log(r),$(".modal-dialog-centered").addClass(r),c(this,ct,Fi).call(this,i)}renderDialog(e="",t="",i="Cancel",a=""){c(this,dt,Pi).call(this,e),c(this,pt,Mi).call(this,i);let r='<p id="modalBodyText"></p>';$(".modal-body").append(r),$("#modalBodyText").text(t),c(this,ct,Fi).call(this,a)}renderActionDialog(e="",t={},i="Cancel",a=""){c(this,dt,Pi).call(this,e),c(this,pt,Mi).call(this,i),c(this,ct,Fi).call(this,a);let r='<div class="modalDialogActionContainer container-fluid"></div>';$(".modal-body").append(r),Object.keys(t).forEach(l=>{let u='<div id="'+t[l].id+'-row"></div>';$(".modalDialogActionContainer").append(u);let m="<h5>"+t[l].heading+"</h5>";$("#"+t[l].id+"-row").append(m);let f='<div class="modalElementGroup" id="'+t[l].id+'-form"></div>';$("#"+t[l].id+"-row").append(f);let T=t[l].sectionContent;Object.keys(T).forEach(x=>{c(this,ka,on).call(this,T[x],t[l].id+"-form")})});let s="<hr>";$(".modalElementGroup:not(:last)").after(s)}show(){$("#staticModal button").on("click",()=>{$(":focus").blur()}),$("#staticModal").modal("show")}hide(){$("#staticModal").modal("hide")}destroyDialog(){$("#staticModal").modal("hide"),this.resetDialog()}resetDialog(){$("#staticModal input").off(),$("#staticModal button").off(),$("#modalTitleIcon").attr("data-type","normal"),$("#modalTitleIcon").removeClass(),$("#modalTitleIcon").addClass(o(this,Ei)),$("#modalTitle").text(""),$(".modal-body").empty(),$("#modalCancelButton").text("Cancel"),$("#modalSaveButtonIcon").removeClass(),$("#modalSaveButtonText").text("Save"),$("#modalSaveButton").click(()=>{this.hide()})}get getModalDialogId(){return o(this,bi)}}bi=new WeakMap,Ei=new WeakMap,ka=new WeakSet,on=function(e,t){if(!(e instanceof Object))return;let i='<form id="'+e.providedFeature+'-div" class="form-group"></form>';$("#"+t).append(i),e.type===Q.INPUT_NUMBERBOX||e.type===Q.INPUT_TEXTBOX?c(this,Na,nn).call(this,e):e.type===Q.INPUT_RANGE&&c(this,$a,rn).call(this,e)},Na=new WeakSet,nn=function(e){let t='<div id="'+e.providedFeature+'-inputGroup" class="input-group"></div>';$("#"+e.providedFeature+"-div").append(t);let i='<div class="input-group-prepend"><span id="'+e.providedFeature+'-inputGroupIconText" class="input-group-text"></span></div>';$("#"+e.providedFeature+"-inputGroup").append(i);let a='<i class="'+e.icon.trim()+'"></i>';$("#"+e.providedFeature+"-inputGroupIconText").append(a);let r='<span class="modalInputLabel">'+e.name+"</span>";$("#"+e.providedFeature+"-inputGroupIconText").append(r);let s='<input id="'+e.providedFeature+'" class="form-control">';$("#"+e.providedFeature+"-inputGroup").append(s),$("#"+e.providedFeature).attr({type:e.type,placeholder:"Default: "+e.defaultValue,value:e.defaultValue,"aria-describedby":e.providedFeature+"-helpText",min:e.min});let l='<small id="'+e.providedFeature+'-helpText" class="form-text text-muted">'+e.helpText+" "+e.min+"</small>";$("#"+e.providedFeature+"-inputGroup").append(l);for(const u of e.additionalItems){let m='<button id="'+e.providedFeature+'-resetButton" class="btn btn-outline-secondary" type="reset">'+u.text+"</button>";$("#"+e.providedFeature+"-helpText").before(m)}},$a=new WeakSet,rn=function(e){let t='<div id="'+e.providedFeature+'-inputGroup"></div>';$("#"+e.providedFeature+"-div").append(t);let i='<label for="'+e.providedFeature+'" class="align-baseline">'+e.name+':<span id="'+e.providedFeature+'-currentValue" class="rangeBoxCurrentValue ml-2 align-baseline badge badge-primary badge-pill">'+e.defaultValue+"</span></label>";$("#"+e.providedFeature+"-inputGroup").append(i);let a='<div id="'+e.providedFeature+'-inputRow" class="inputRow form-row"></div>';$("#"+e.providedFeature+"-inputGroup").append(a);let r='<input class="col px-md-2 form-control-range" id="'+e.providedFeature+'">';$("#"+e.providedFeature+"-inputRow").append(r),$("#"+e.providedFeature).attr({type:e.type,min:e.min,max:e.max,value:e.defaultValue,step:1}),$("#"+e.providedFeature).on("change input",s=>{$("#"+e.providedFeature+"-currentValue").text($("#"+e.providedFeature).val())});for(const s of e.additionalItems){let l='<button id="'+e.providedFeature+'-resetButton" class="btn btn-outline-secondary" type="reset">'+s.text+"</button>";$("#"+e.providedFeature+"-inputRow").append(l),$("#"+e.providedFeature+"-resetButton").addClass("ml-2 btn-sm")}},dt=new WeakSet,Pi=function(e=""){e instanceof Object?($("#modalTitleIcon").attr("data-type",e.type?e.type:"normal"),$("#modalTitleIcon").removeClass(),$("#modalTitleIcon").addClass(e.icon),$("#modalTitle").text(e.text)):$("#modalTitle").text(e)},pt=new WeakSet,Mi=function(e="Cancel"){$("#modalCancelButton").text(e),$("#modalCancelButton").click(()=>{this.resetDialog()})},ct=new WeakSet,Fi=function(e=""){if(!e||!(e instanceof Object)||!e.action){$("#modalSaveButton").css("display","none");return}if(e.action&&typeof e.action!="function")throw new TypeError("The provided action for the save button has to be a function.");$("#modalSaveButtonIcon").removeClass(),$("#modalSaveButtonIcon").addClass(e.icon),$("#modalSaveButtonText").text(" "+e.text),$("#modalSaveButton").click(()=>{e.action(),this.destroyDialog()})},Aa=new WeakSet,sn=function(e){if(e.which==13){let t=e.target.type==="number"?"modalSaveButton":e.target.id;$("#"+t).click(),e.preventDefault()}};var ht,ut,Re,wt,Ba,ln,gt,Li;class fr extends joint.mvc.View{constructor(t,i,a,r,s){if(!(i instanceof joint.dia.Paper))throw new TypeError("Toolbar: The provided current paper has to be a joint.dia.Paper element");super({className:"toolbar",el:t,paper:i,graph:i.model,appTools:a&&a.Tools?a.Tools:[],entityTools:a&&a.EntityConfig?a.EntityConfig:[],additionalRowToolsConfig:a&&a.ToolbarRowConfig?a.ToolbarRowConfig:[],toolbarButtonActionConfig:a&&a.ToolbarButtonActionConfig?a.ToolbarButtonActionConfig:{},currentSystemName:s,events:{"initialSystemName #appNameTitle":"setInitialSystemName","click #fullScreen-button":"toggleFullScreen","click #closefullScreen-button":"toggleFullScreen","click #fitActivePaperToContent-button":"fitActivePaperToContent","click #clearActivePaper-button":"clearActivePaper","click #printActivePaper-button":"printActivePaper","click #zoomOutPaper-button":"zoomOutPaper","click #zoomInPaper-button":"zoomInPaper","click #expandAll-button":"toggleEntityExpansion","click #collapseAll-button":"toggleEntityExpansion","click #applicationSettings-button":"editApplicationSettings","click #showEntityToolbarRow-button":"toggleEntityOptionsBar","click #hideEntityToolbarRow-button":"toggleEntityOptionsBar","click #convertModeledSystemEntityToJson-dropdownItemButton":"convertToJson","click #convertModeledSystemEntityToTosca-dropdownItemButton":"convertToTosca","click #changeGrid-button":"changeGrid",'click input[type="checkbox"]':"toggleEntityVisibility",mouseup:"removeFocusFromSelection","click #fitAllElementsToEmbedded-button":"fitAllElementsToEmbedded"}});p(this,Re);p(this,Ba);p(this,gt);g(this,"use strict");g(this,"currentSystemName","");g(this,"appTools",[]);g(this,"entityTools",[]);g(this,"additionalRowTools",[]);p(this,ht,{});p(this,ut,{});this.appTools=this.options.appTools,this.entityTools=this.options.entityTools,this.additionalRowTools=this.options.additionalRowToolsConfig,h(this,ut,this.options.toolbarButtonActionConfig),this.currentSystemName=this.options.currentSystemName,this.delegateEvents(),this.listenTo(this.options.graph,"add",this.entityAdded),this.listenTo(this.options.graph,"remove",this.entityRemoved),this.listenTo(this.options.graph,"change:entity",(l,u,m)=>{this.entityTypeChanged(m.previousType,u.type)}),this.listenTo(this.options.graph,"change:attrs",this.entityVisibilityChanged),h(this,ht,r instanceof an?r:{})}init(){}onRender(){}confirmUpdate(){}onSetTheme(t,i){}onRemove(){}render(){const t=new lr;t.addSystemTitle();for(const a of this.appTools)t.addButtonGroup(a);for(const a of this.entityTools)t.addEntityCheckboxTool(a.entityType,a.labelText,a.tooltipText);for(const a of this.additionalRowTools)switch(a.rowIndex){case 1:t.addAdditionalFirstRowConfigTool(a.tools);break;case 2:t.addAdditionalSecondRowConfigTool(a.tools);break;default:t.addAdditionalFirstRowConfigTool(a.tools);break}const i=t.getCreatedToolbarTemplate();return $("#appToolbarContainer").append(i),c(this,Ba,ln).call(this),$(".buttonInitialHide").hide(),$(".app-header-second-row").on("click",()=>{$(":focus").blur()}),this}toggleFullScreen(){joint.util.toggleFullScreen();let t="fullScreen-button",i="closefullScreen-button";$("#"+t).toggle(),$("#"+i).toggle()}fitActivePaperToContent(){this.options.paper.fitToContent({padding:joint.util.normalizeSides(25),minWidth:300,minHeight:250})}clearActivePaper(){const t=o(this,ut).clearActivePaper;if(t){let i=new se("extern-clear","clearActivePaper");i.create(t),i.render("modals",!0),i.configureSaveButtonAction(()=>{this.options.graph.clear()}),i.show()}else this.options.graph.clear()}changeGrid(){this.options.paper.clearGrid()}printActivePaper(){window.print()}zoomInPaper(){const t=this.options.paper.getComputedSize();this.options.paper.scale(1.5),this.options.paper.fitToContent({padding:50,minWidth:t.width,minHeight:t.height})}zoomOutPaper(){const t=this.options.paper.getComputedSize();this.options.paper.scale(1),this.options.paper.fitToContent({padding:50,minWidth:t.width,minHeight:t.height})}convertToJson(){let t=this.options.graph.toJSON(),i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(t))),i.setAttribute("download",`${this.currentSystemName}.json`),i.click()}convertToTosca(){const t=o(this,ut).convertToTosca;if(t){let i=new se("tosca-export","convertToTosca");i.create(t),i.render("modals",!0),i.configureSaveButtonAction(()=>{this.options.graph.trigger("startToscaTransformation")}),i.show()}}removeFocusFromSelection(t){t.button!==2&&t.target.id!=="appNameTitle"&&($('[data-toggle="tooltip"]').tooltip("hide"),$('[data-tooltip-toggle="tooltip"]').tooltip("hide"),document.activeElement.blur())}fitAllElementsToEmbedded(){let t=this.options.graph.getElements();for(const i of t)i.getEmbeddedCells("embeds").length!==0&&i.fitEmbeds({deep:!0,padding:10})}toggleEntityExpansion(t){this.options.graph.getElements().forEach(a=>{if(!a.attr("icon")||a.prop("entity/type")===d.REQUEST_TRACE)return;a.prop("collapsed",!!t.currentTarget.id.includes("collapse"));let r=t.currentTarget.id.includes("collapse")?"visible":"hidden",s=a.attr("root/visibility")==="hidden"?"hidden":r;a.attr("icon/visibility",s,{isolate:!0}),a.getEmbeddedCells({deep:!0}).forEach(u=>{const m=t.currentTarget.id.includes("collapse")?"hidden":"visible",T=u.prop("entityTypeHidden")?"hidden":m;u.attr("root/visibility",T,{isolate:!0}),u.prop("parentCollapsed","hidden".localeCompare(r)!==0)})})}toggleEntityOptionsBar(){$("#showEntityToolbarRow-button").toggle(),$("#hideEntityToolbarRow-button").toggle(),$("#additionalToolbar-groupDivider").toggle(),$(".app-header-second-row").toggle()}editApplicationSettings(){O.saveButton.action=()=>{let t=$("#"+O.content.Size.sectionContent.PaperWidth.providedFeature).val(),i=$("#"+O.content.Size.sectionContent.PaperHeight.providedFeature).val(),a=$("#"+O.content.Grid.sectionContent.Size.providedFeature).val(),r=$("#"+O.content.Grid.sectionContent.Thickness.providedFeature).val();this.options.paper.setDimensions(t,i),this.options.paper.setGridSize(a),this.options.paper.drawGrid({thickness:r})},O.content.Size.sectionContent.PaperWidth.min=this.options.paper.getFitToContentArea({padding:joint.util.normalizeSides(25)}).width,O.content.Size.sectionContent.PaperHeight.min=this.options.paper.getFitToContentArea({padding:joint.util.normalizeSides(25)}).height,O.content.Size.sectionContent.PaperWidth.defaultValue=this.options.paper.options.width,O.content.Size.sectionContent.PaperHeight.defaultValue=this.options.paper.options.height,O.content.Grid.sectionContent.Size.defaultValue=this.options.paper.options.gridSize,O.content.Grid.sectionContent.Thickness.defaultValue=this.options.paper._gridSettings[0].thickness,o(this,ht).renderActionDialog(O.title,O.content,O.cancelButton.text,O.saveButton),o(this,ht).show()}entityAdded(t){if(!t.attributes.entity||!Object.values(d).includes(t.attributes.entity.type)){console.error("Entity Type does not exist");return}c(this,Re,wt).call(this,t.attributes.entity.type,"add")}entityRemoved(t){if(!t.attributes.entity||!Object.values(d).includes(t.attributes.entity.type)){console.error("Entity Type does not exist");return}c(this,Re,wt).call(this,t.attributes.entity.type,"remove")}entityTypeChanged(t,i){if(!!t){if(!Object.values(d).includes(t)||!Object.values(d).includes(i)){console.error("Entity Type does not exist");return}c(this,Re,wt).call(this,t,"remove"),c(this,Re,wt).call(this,i,"add")}}updateEntityEventListener(t){const i=t.target.getAttribute("data-entity-type");$('.addingEntity[data-entity-type="'+i+'"]').removeClass("addingEntity"),$('.removingEntity[data-entity-type="'+i+'"]').removeClass("removingEntity")}toggleEntityVisibility(t){let i=t.target.value,a=$('.entityCheckBox[data-entity-type="'+i+'"]'),s=this.options.graph.getCells().filter(l=>l.attributes.entity.type===i);for(const l of s){let u=a.prop("checked")?"visible":"hidden";if(l.prop("entityTypeHidden",a.prop("checked")===!1),l.attr("icon")){let m=l.get("collapsed")===!0?"visible":"hidden",f=a.prop("checked")?m:"hidden";l.attr("icon/visibility",f,{isolate:!0})}l.prop("parentCollapsed")&&(u="hidden"),l.attr("root/visibility",u,{isolate:!0})}}entityVisibilityChanged(t,i,a){if(a.propertyPath&&a.propertyPath.includes("visibility")){let r=t.findView(this.options.paper);r.hideTools(),joint.highlighters.stroke.remove(r)}}setInitialSystemName(t){this.currentSystemName=t.systemName}}ht=new WeakMap,ut=new WeakMap,Re=new WeakSet,wt=function(t,i){let a=$('.numberOfEntities[data-entity-type="'+t+'"]'),r=a.text();if(i==="add")a.addClass("addingEntity"),a.text(parseInt(r)+1);else if(i==="remove"){a.addClass("removingEntity");const s=parseInt(r)-1>=0?parseInt(r)-1:0;a.text(s)}},Ba=new WeakSet,ln=function(){$(".numberOfEntities[data-entity-type]").on("animationend",this.updateEntityEventListener),$("#editApplicationNameBtn").on("click",()=>{c(this,gt,Li).call(this)}),$("#cancelEditApplicationNameBtn").on("click",()=>{$("#appNameTitle").val(this.currentSystemName),c(this,gt,Li).call(this)}),$("#submitEditApplicationNameBtn").on("click",()=>{let t=$("#appNameTitle").val();t?($("#appNameTitle").val(t),this.currentSystemName=t,$("#appNameTitle").trigger({type:"systemNameChanged",updatedSystemName:t}),this.options.graph.trigger("systemNameChanged",{editedAppName:t})):$("#appNameTitle").val(this.currentSystemName),c(this,gt,Li).call(this)}),$("#addNewSystemEntity").on("click",()=>{alert("Maybe TODO")}),$(".buttonDropDownGroup").on("show.bs.dropdown",function(){$('.toolbarDropdownButton[data-tooltip-toggle="tooltip"]').tooltip("hide")}),$(".buttonDropDownGroup").on("shown.bs.dropdown",function(){$('.toolbarDropdownButton[data-tooltip-toggle="tooltip"]').tooltip("hide")})},gt=new WeakSet,Li=function(){let t=$("#appNameTitle");t.attr("disabled")?t.attr("disabled",!1):t.attr("disabled",!0),$("#editApplicationNameBtn").toggle(),$("#cancelEditApplicationNameBtn").toggle(),$("#submitEditApplicationNameBtn").toggle()};let br=joint.elementTools.Button.extend({name:"clone-button",options:{markup:[{tagName:"title",selector:"iconTooltip",textContent:"Copy entity"},{tagName:"image",selector:"icon",attributes:{href:"icon/copy-solid.svg",fill:"black",transform:"translate(-6, -6) scale(0.1)",cursor:"pointer",class:"entityTool"}}],x:"100%",y:"100%",offset:{x:0,y:0},rotate:!0,action:function(n,e){let t=e.model.clone();t.position(e.model.position().x+20,e.model.position().y+20),e.model.graph.addCell(t);let i=t.prop("entity/type")===d.COMPONENT||t.prop("entity/type")===d.SERVICE||t.prop("entity/type")===d.BACKING_SERVICE||t.prop("entity/type")===d.STORAGE_BACKING_SERVICE||t.prop("entity/type")===d.INFRASTRUCTURE,a=new dn(i);var r=t.findView(e.paper);r.addTools(a),r.hideTools()}}}),Er=joint.elementTools.Connect.extend({name:"link",children:[{tagName:"title",selector:"iconTooltip",textContent:"Create a Link or Deployment Mapping to another entity"},{tagName:"image",selector:"icon",attributes:{href:"icon/arrows-split-up-and-left-solid.svg",fill:"white",transform:"scale(0.1) rotate(90)",cursor:"pointer",class:"entityTool"}}]}),vr=joint.elementTools.Remove.extend({name:"remove",children:[{tagName:"title",selector:"iconTooltip",textContent:"Remove entire entity"},{tagName:"circle",selector:"button",attributes:{r:7,fill:"black",cursor:"pointer",class:"entityTool"}},{tagName:"path",selector:"icon",attributes:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,pointerEvents:"none"}}]}),Tr=joint.elementTools.Button.extend({name:"collapse-button",options:{markup:[{tagName:"title",selector:"iconTooltip",textContent:"Collapse to hide embedded entities"},{tagName:"image",selector:"icon",attributes:{href:"icon/circle-minus-solid.svg",transform:"translate(-6, -6) scale(0.1)",cursor:"pointer",class:"entityTool"}}],x:"100%",y:"100%",offset:{x:0,y:0},rotate:!0,action:function(n,e){let t=e.model;t.attr("icon/visibility",!0,{isolate:!0}),t.prop("collapsed",!0),t.getEmbeddedCells({deep:!0}).forEach(a=>{a.attr("root/visibility","hidden",{isolate:!0}),a.prop("parentCollapsed",!0)})}}});class dn extends joint.dia.ToolsView{constructor(t=!1,i=!1){super({name:"EntityTools"});g(this,"use strict");g(this,"tools",[]);this.options.tools=[this.createBoundaryTool(),this.createRemoveTool(),this.createCopyTool()],t&&this.options.tools.push(this.createConnectTool()),i&&this.options.tools.push(this.createCollapseTool()),this.tools=this.options.tools}createBoundaryTool(){return new joint.elementTools.Boundary({padding:2,attributes:{fill:"none",stroke:"#FEB663","stroke-width":"3"}})}createRemoveTool(){return new vr({focusOpacity:.5,x:"0%",y:"0%",offset:{x:-11,y:-7}})}createConnectTool(){return new Er({focusOpacity:.5,x:"100%",y:"50%",offset:{x:22,y:-7},magnet:"body"})}createCopyTool(){return new br({focusOpacity:.5,x:"100%",y:"100%",offset:{x:12,y:5}})}createCollapseTool(){return new Tr({focusOpacity:.5,x:"0%",y:"100%",offset:{x:-12,y:7}})}}const xr=joint.mvc.View.extend({className:"entitySideBar",_entityShapeGraph:{},_entityShapePaper:{},entityRepresentations:{},_dragging:!1,options:{paper:null,graph:null,width:245,height:600,documentElement:null,sidebarEntityConfig:{},entityHighlightColour:"",entityTextHighlightColour:""},init(){var e,t;if(!(this.options.paper instanceof joint.dia.Paper))throw new TypeError("EntitySideBar: The provided current paper has to be a joint.dia.Paper element");let n=$(".entityShapes-sidebar-container").first();this.options.graph=this.options.paper.model,this.options.width=n&&n.innerWidth()?n.innerWidth():this.options.width,this.options.height=n&&n.innerHeight()?n.innerHeight():this.options.height,this.options.entityRepresentations=this.options.sidebarEntityConfig?this.options.sidebarEntityConfig:{},this.options.entityHighlightColour=(e=getComputedStyle(document.documentElement).getPropertyValue("--entitySidebar-highlighting-colour"))!=null?e:"darkorange",this.options.entityTextHighlightColour=(t=getComputedStyle(document.documentElement).getPropertyValue("--entitySidebar-textHighlighting-colour"))!=null?t:"darkorange",this.entityRepresentations=this.options.entityRepresentations,this.delegateEvents()},render(){return this.renderSidebar(),this.renderEntityShapes(),this},createEntitySidebarTemplate(){return`<div class="entitySidebar">
            <div class="user-select-none entityShapes-headline sticky-top">
            <div class="entityShapes-icon">
                <i class="fa-solid fa-shapes"></i>
            </div>
            <div class=entityShapes-text"">
                <span class="">Entity Shapes</span>
            </div>
        </div>
            <div class="entityShapes-container">
            <div class="entityShapes-paper"></div>
        </div>
        </div>`},renderSidebar(){this.options.documentElement.append(this.createEntitySidebarTemplate());let n=this.options.height-$(".entityShapes-headline").first().outerHeight(),e=$(".entityShapes-sidebar-container").first().css("backgroundColor").split(","),t=e[0].concat(",",e[1]).concat(",",e[2]).concat(", ","0)");this._entityShapeGraph=new joint.dia.Graph,this._entityShapePaper=new joint.dia.Paper({el:$(".entityShapes-paper"),width:Math.floor(this.options.width)>=244?Math.floor(this.options.width):244,height:Math.floor(n)>=547?Math.floor(n):547,gridSize:10,drawGrid:!1,model:this._entityShapeGraph,embeddingMode:!1,background:{color:t},interactive:!1,cellNamespace:joint.shapes}),this._entityShapePaper.render(),this.listenTo(this._entityShapePaper,"cell:mouseenter",this.highlightEntity),this.listenTo(this._entityShapePaper,"cell:mouseleave",this.unhighlightEntity),this.listenTo(this._entityShapePaper,"element:pointerclick",this.addEntity),this.listenTo(this._entityShapePaper,"requestTrace:icon:pointerclick",this.addEntity),this.listenTo(this._entityShapePaper,"link:pointerclick",this.addLink),this.listenTo(this._entityShapePaper,"cell:pointermove",(i,a,r)=>{this._dragging=!0})},renderEntityShapes(){Object.keys(this.entityRepresentations).forEach(n=>{this._entityShapeGraph.addCell(this.entityRepresentations[n].shape)})},addEntity(n){let e=this._entityShapeGraph.getCell(n.model.id),t=e.clone();t.resize(e.prop("defaults/size/width"),e.prop("defaults/size/height")),t.attr("label/fontSize",e.prop("defaults/fontSize")),t.removeAttr("root/title"),t.position(30,20),this.options.graph.addCell(t),this.addToolToEntity(t)},addLink(n){let t=this._entityShapeGraph.getCell(n.model.id).clone();t.attr("wrapper/cursor","pointer"),t.attr("wrapper/class","modelingArea-Connection"),t.attr("line/stroke","black"),t.removeAttr("root/title"),t.removeLabel(-1),t.prop("source",{x:30,y:30}),t.prop("target",{x:130,y:30}),this.options.graph.addCell(t);let i=new tn(!0);var a=t.findView(this.options.paper);a.addTools(i)},onDragEntity(n,e,t,i){if(!this._dragging)return;let r=this._entityShapeGraph.getCell(n.model.id).clone(),l=this.options.paper.localToPaperPoint(this.options.paper.pageToLocalPoint(t)).x-r.getBBox().width/2,u=$(".entityShapes-headline").first().outerHeight(),m=i+Math.floor(u),f=this.options.paper.localToPaperPoint(m),T=Math.abs(this.options.paper.pageOffset().y<0?this.options.paper.pageOffset().y:0),x=f.x+T-r.getBBox().height/2;r.position(l,x),this.options.graph.addCells([r]),this._dragging=!1,this.addToolToEntity(r)},addToolToEntity(n){if(n.isLink())return;let e=n.prop("entity/type")===d.COMPONENT||n.prop("entity/type")===d.SERVICE||n.prop("entity/type")===d.BACKING_SERVICE||n.prop("entity/type")===d.STORAGE_BACKING_SERVICE||n.prop("entity/type")===d.INFRASTRUCTURE,t=!!(n.prop("entity/type")===d.REQUEST_TRACE||e),i=new dn(e,t);var a=n.findView(this.options.paper);a.addTools(i),a.hideTools()},highlightEntity(n){if(n.model.isLink()){n.model.attr("line/stroke",this.options.entityHighlightColour),n.model.attr("text/fill",this.options.entityHighlightColour);return}n.$el.addClass("highlightEntity")},unhighlightEntity(n){if(n.model.isLink()){n.model.attr("line/stroke","black"),n.model.attr("text/fill","black");return}n.$el.removeClass("highlightEntity")},onRemove(){this._entityShapeGraph=null,this._entityShapePaper=null,this.entityRepresentations={},this.options.documentElement.empty()}});var _e,vi,D,Ti,ce,he,xi,yt,Gi,Da,pn,Ra,cn;class Cr{constructor(e,t,i,a){p(this,yt);p(this,Da);p(this,Ra);p(this,_e,"");p(this,vi,"");p(this,D,"");p(this,Ti,"");p(this,ce,[]);p(this,he,new Set);p(this,xi,!0);h(this,_e,t),h(this,vi,e),h(this,D,i),h(this,Ti,a)}create(e=""){let t='<div class="accordion" id="'+o(this,D)+'"></div>';$(o(this,vi)).append(t),$("#"+o(this,D)).append('<div id="'+e+'"><h6>'+o(this,Ti)+"</h6></div>"),this.changeVisibility(!1),$("#"+o(this,D)).keydown(i=>{c(this,Da,pn).call(this,i)})}addCollapsibleAccordionGroup(e="",t="",i=""){o(this,ce).push(e);let a='<div id="'+e+'-card" class="'+o(this,_e)+' card"></div>';$("#"+o(this,D)).append(a);let r='<div class="card-header" id="'+e+'-header"></div>';$("#"+e+"-card").append(r);let l='<h2 class="mb-0">'+('<button id="'+e+'-button" class="'+o(this,_e)+'-headlineButton btn btn-link btn-block text-left collapsed" type="button"><i class="'+o(this,_e)+"-iconHeadline "+t+'"></i> '+i+"</button>")+"</h2>";$("#"+e+"-header").append(l),$("#"+e+"-button").attr({"data-toggle":"collapse","data-target":"#collapse-"+e,"aria-expanded":"false","aria-controls":"collapse-"+e});let u='<div id="collapse-'+e+'" class="collapse" aria-labelledby="'+e+'-header" data-parent="#'+o(this,D)+'"></div>',m='<div id="'+e+'-card-body" class="card-body"></div>';$("#"+e+"-card").append(u),$("#collapse-"+e).append(m),$("#"+e+"-button").on("click",()=>{$(":focus").blur()})}addContentToAccordionGroup(e="",t=""){$("#"+e+"-card-body").append(t),$("#"+e+"-card-body").children().last().attr({"data-group-context":e,"data-group-id":e+"-card-body"})}emptyContentOfAccordionGroup(e="",t=[]){let i=$("[data-group-context="+e+"]");i.filter(r=>t.includes(i[r].id)===!1).detach()}changeVisibility(e=!0){if(h(this,xi,e),e){$("#"+o(this,D)).show();return}$("#"+o(this,D)).hide()}changeCollapsibleGroupVisibility(e,t=!0){t?($("#"+e+"-card").show(),o(this,he).delete(e)):($("#"+e+"-card").hide(),o(this,he).add(e)),c(this,yt,Gi).call(this)}changeVisibilityExceptGroupId(e,t=!0){t?o(this,ce).forEach(i=>{e!==i&&($("#"+i+"-card").show(),o(this,he).delete(i))}):o(this,ce).forEach(i=>{e!==i&&($("#"+i+"-card").hide(),o(this,he).add(i))}),c(this,yt,Gi).call(this)}showAllCollapsibleGroups(){o(this,ce).forEach(e=>{$("#"+e+"-card").show(),o(this,he).delete(e)}),c(this,yt,Gi).call(this)}}_e=new WeakMap,vi=new WeakMap,D=new WeakMap,Ti=new WeakMap,ce=new WeakMap,he=new WeakMap,xi=new WeakMap,yt=new WeakSet,Gi=function(){o(this,he).size===o(this,ce).length?this.changeVisibility(!1):o(this,xi)===!1&&this.changeVisibility(!0)},Da=new WeakSet,pn=function(e){if(e.which==13){if(c(this,Ra,cn).call(this),e.target.type==="button"){let t=e.target.id.replace("-button","");if(o(this,ce).includes(t)||e.target.id.includes("-enterButton"))return}e.target.getAttribute("data-property-type")==="entity"?$("#"+o(this,D)).trigger({type:"entitySpecificPropertyChanged",propertyId:e.target.id,originalTarget:e.target,orginalEvent:e}):$("#"+o(this,D)).trigger({type:"entityPropertyChanged",propertyId:e.target.id,propertyType:e.target.getAttribute("data-property-type"),originalTarget:e.target,orginalEvent:e}),e.preventDefault()}},Ra=new WeakSet,cn=function(){$("#"+o(this,D)+" .valid-feedback:visible").hide(),$("#"+o(this,D)+" .invalid-feedback:visible").hide(),$("#"+o(this,D)+" .is-valid").removeClass("is-valid"),$("#"+o(this,D)+" .is-invalid").removeClass("is-invalid")};const So=()=>'<defs><marker id="arrowHead" orient="auto" overflow="visible" markerUnits="userSpaceOnUse"><path id="v-66" stroke="black" fill="black" transform="rotate(180)" d="M 8 -4.5 0 0 8 4.5 z"></path></marker></defs>'+'<path d="M 1 8 L 27 8" marker-end="url(#arrowHead)" fill="none" stroke="black" stroke-dasharray="none" stroke-width="2" stroke-line-join="round" stroke-linejoin="round"</path>';var Se,oe,ue,_a,hn,Oa,un,Pa,gn;class Sr{constructor(e,t=""){p(this,_a);p(this,Oa);p(this,Pa);p(this,Se,"entity");p(this,oe,{});p(this,ue,{});g(this,"specificProperties",{referredEndpoint:{providedFeature:"referredEndpoint",contentType:E.DROPDOWN,label:"External Endpoint:",properties:{disabled:!1,required:!0},attributes:{placeholder:"Choose External Endpoint...",svgRepresentation:'<svg width="30" height="20"><circle id="request-trace-external-endpoint" cx="15" cy="9" r="4" stroke="black" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/></svg>',helpText:{text:"The referred External Endpoint."}}},involvedLinks:{providedFeature:"involvedLinks",contentType:E.TABLE_DIALOG,label:"Involved Links:",properties:{disabled:!1,required:!0},attributes:{svgRepresentation:'<svg width="35" height="20">'+So()+"</svg>",buttonText:"Add Link entities",buttonIconClass:"bi bi-window-plus"},buttonActionContent:{dialogSize:Nt.LARGE,dialogContent:{header:{svgRepresentation:'<svg width="35" height="20"><polygon points="0,0 28,0 35,7 28,14 0,14 7,7" transform="translate(0,1)" stroke-width="2" stroke="black" fill="white"></polygon></svg>',text:"Request Trace: ",closeButton:!1},footer:{cancelButtonText:"Cancel",saveButtonIconClass:"fa-regular fa-floppy-disk",saveButtonText:"Save"},content:{contentType:Y.GROUP_FORMS,groups:[{id:"involved-links-table",contentType:E.TABLE,headline:'Involved Links  ( <svg width="35" height="20">'+So()+"</svg>)",text:`The following table shows all Link entities that currently exist for this System. 
                                Invalid Links, such as non-connected ones or if they are connected to an Endpoint without
                                a parent entity cannot be selected and are thus deactived. By selecting the respective 
                                checkbox the Link entity will be added to this Request Trace. The selection at the beginning 
                                shows the currently saved state for this entity. Your changes won't be adopted until you 
                                clicked "Save". In case you cancel and change your entity selection, all your changes will be 
                                lost. While you keep the selection of this Request Trace entity, your changes will be remembered.`,tableColumnHeaders:[{text:"From"},{text:"To Endpoint"},{text:"Endpoint Parent"},{text:"Formerly Included"},{text:"Include"}],tableRows:[]}]}}}}});h(this,Se,t),h(this,oe,e)}renderProperties(e){const t=c(this,_a,hn).call(this);e.addContentToAccordionGroup(o(this,Se),t);const i=c(this,Oa,un).call(this);e.addContentToAccordionGroup(o(this,Se),i),$("#"+this.specificProperties.involvedLinks.providedFeature).click(()=>{o(this,ue).show()})}saveInvolvedLinks(e){const t=$("#involvedLinks-table input[data-entity-property=involvedLinks-included]:checked").get(),i=new Array(t.map(a=>a.value));e.getSelectedRequestTraceElement.prop("entity/properties/involvedLinks",i,{rewrite:!0,isolate:!0})}get getSelectedRequestTraceElement(){return o(this,oe)}}Se=new WeakMap,oe=new WeakMap,ue=new WeakMap,_a=new WeakSet,hn=function(){const e=this.specificProperties.referredEndpoint,t=new j(e.providedFeature,o(this,Se)),a=joint.util.groupBy(o(this,oe).graph.getElements(),l=>l.prop("entity/type"))[d.EXTERNAL_ENDPOINT],r=o(this,oe).prop("entity/properties/referredEndpoint"),s=a?a.map(l=>{let u="",m="",f=!0;return l.parent()?(u=l.graph.getCell(l.parent()).attr("label/textWrap/text"),m="validOption",f=!1):(f=!0,m="invalidOption"),{optionValue:l.id,optionText:l.attr("label/textWrap/text"),optionTitle:`${u?`(Parent: ${u})`:"no parent: invalid option"}`,optionRepresentationClass:`${m||""}`,disabled:f,selected:r?r===l.id:!1}}):[];return t.addDropdownElementWithLabelAndOptions(e.label,e.attributes,e.properties,s),t.getCreatedFormTemplate(!0)},Oa=new WeakSet,un=function(){const e=this.specificProperties.involvedLinks,t=new j(e.providedFeature,o(this,Se));t._addButtonElementWithLabel(e.label,e.attributes,e.properties);const i=t.getCreatedFormTemplate(!0);let a=e.buttonActionContent;const r=c(this,Pa,gn).call(this);return a.dialogContent.content.groups.forEach(s=>{String("involved-links-table").localeCompare(s.id)===0&&(s.tableRows=r)}),a.dialogContent.header.text+=` ${o(this,oe).attr("label/textWrap/text")}`,h(this,ue,new se("entity",e.providedFeature)),o(this,ue).create(a.dialogContent),o(this,ue).provideCloseButtonActionConfiguration("close"),o(this,ue).provideSaveButtonActionConfiguration(this.saveInvolvedLinks,"close",this),o(this,ue).render("modals",!0,a.dialogSize),i},Pa=new WeakSet,gn=function(){let e=o(this,oe).graph.getLinks();const t=new Set(o(this,oe).prop("entity/properties/involvedLinks")[0]);return e.filter(a=>a.prop("entity/type")===d.LINK).map(a=>{if(a.prop("entity/type")===d.DEPLOYMENT_MAPPING)return;let r=!0,s=!1,l="-";a.getTargetElement()&&a.getTargetElement().parent()?(l=a.graph.getCell(a.getTargetElement().parent()).attr("label/textWrap/text"),s=!0):s=!1,a.getSourceElement()&&a.getTargetElement()&&(r=!s);const u=a.getSourceElement()?a.getSourceElement().attr("label/textWrap/text"):"-",m=a.getTargetElement()?a.getTargetElement().attr("label/textWrap/text"):"-";return{from:u,to:m,parent:l,previous:{contentType:E.CHECKBOX_WITHOUT_LABEL,disabled:!0,checked:t.has(a.id),id:a.id},included:{contentType:E.CHECKBOX_WITHOUT_LABEL,disabled:r,checked:t.has(a.id),id:a.id},attributes:{representationClass:r?"invalidOption":"validOption",disabled:r}}})};const wr=()=>'<rect width="24" height="12" rx="2" ry="2" transform="translate(2.2, 2)" stroke-dasharray="0" stroke-width="2" stroke="black" fill="white"></rect>',Ir=()=>'<polygon points="5,0 15,0 20,8 15,16 5,16 0,8" transform="translate(7, 0.7)" stroke-dasharray="0" stroke-width="2" stroke="black" fill="white"></polygon>',kr=()=>'<polygon points="12.5,0 25,7.5 12.5,15 0,7.5" transform="translate(2, 0.8)" stroke-width="2" stroke="black" fill="white"></polygon>',Nr=()=>'<path transform="translate(6, 0.7) scale(0.27)" d="M 0 10 L 0 50 C 0 55.51784 17.928639999999998 60 40 60 C 62.07136 60 80 55.51784 80 50 L 80 10 C 80 4.4821599999999995 62.07136 0 40 0 C 17.928639999999998 0 0 4.4821599999999995 0 10 Z" stroke-width="5" stroke="black" fill="white"></path>'+'<ellipse transform="translate(6, 0.7) scale(0.27)" cy="10" ry="10" cx="40" rx="40" stroke-width="5" stroke="black" fill="white"></ellipse>',$r=()=>({type:"modalDialog",header:{iconClass:"fa-solid fa-triangle-exclamation",type:"warning",text:"Warning",closeButton:!0},footer:{cancelButtonText:"Ok, understood"},content:{contentType:Y.SINGLE_TEXTBLOCK,text:`You have to embed the Data Aggregate entity in a Component, Service, Backing Service or Storage Backing Service first
            before you can edit embedded properties.`}});var q,R,ge,Oe,J,mt,Ci,Ma,yn,Si,no,wi,ro,Fa,mn,La,fn,Ga,bn,Wa,En,za,vn;class Ar{constructor(e,t=""){p(this,Ma);p(this,Si);p(this,wi);p(this,Fa);p(this,La);p(this,Ga);p(this,Wa);p(this,za);p(this,q,"entity");p(this,R,{});p(this,ge,{});p(this,Oe,!1);p(this,J,!1);p(this,mt,"");p(this,Ci,new Array);g(this,"specificProperties",{chooseEditMode:{providedFeature:"dataAggregate-chooseEditMode",contentType:E.TOGGLE,labels:{headLabel:"<U>Edit Mode:</U>",leftLabel:"Original",rightLabel:"Embedded"},properties:{disabled:!1,required:!1,checked:!0},attributes:{helpText:{text:"Choose whether you want to modify the embedded element or the actual Data Aggregate entity."}}},"dataAggregate-parentRelation":{providedFeature:"dataAggregate-parentRelation",contentType:E.DROPDOWN,label:"Parent Relation:",properties:{disabled:!1,required:!0},attributes:{placeholder:"",svgRepresentation:"",helpText:{text:"How the entity is utilized by its parent."}},dropdownOptions:[{optionValue:Bi.USED,optionText:Bi.USED,selected:!0},{optionValue:Bi.PERSISTED,optionText:Bi.PERSISTED,selected:!1}]},"dataAggregate-assignedFamily":{providedFeature:"dataAggregate-assignedFamily",contentType:E.INPUT_TEXTBOX,label:`Assigned <span><svg width="30" height="20">${Tt()}</svg></span>\u2013 Family:`,properties:{disabled:!0,readonly:!0,required:!1},attributes:{placeholder:"No family assigned",provideEditButton:!1}},"dataAggregate-familyConfig":{providedFeature:"dataAggregate-familyConfig",contentType:E.TABLE_DIALOG,label:"\u2013 Family:",properties:{disabled:!1,required:!1},attributes:{svgRepresentation:`<svg width="30" height="20">${Tt()}</svg>`,buttonText:"Edit Family",buttonIconClass:"fa-solid fa-pencil"},buttonActionContent:{dialogSize:Nt.LARGE,dialogContent:{header:{svgRepresentation:`<svg width="30" height="20">${Tt()}</svg>`,text:"Data Aggregate Family: ",closeButton:!1},footer:{cancelButtonText:"Cancel",saveButtonIconClass:"fa-regular fa-floppy-disk",saveButtonText:"Save"},content:{contentType:Y.GROUP_FORMS,groups:[{id:"dataAggregate-familyConfig-table",contentType:E.TABLE,headline:'Included Data Aggregate entities  ( <svg width="30" height="20">'+Tt()+"</svg>)",text:`The following table shows all existing Data Aggregate entities within this System. You can select which ones of the following Data Aggregate entities you want to include in this
                                family. Note that if you select a Data Aggregate and save your changes, the labels of the selected Data Aggregate entities might change since they have to be equal to the family name.
                                Additionally, if you deselect entities that have previously been part of this family, their label will be reset to "Data Aggregate". However, your changes won't be adopted until you 
                                clicked "Save". In case you cancel and change your entity selection, all your changes will be lost. While you keep the selection of this Data Aggregate entity, your changes will be remembered.`,tableColumnHeaders:[{text:"Name"},{text:"Family Name"},{text:"Parent"},{text:"Formerly Included"},{text:"Include"}],tableRows:[]}]}}}}});var i,a;h(this,q,t),h(this,R,e),h(this,J,!!((i=o(this,R))!=null&&i.parent())),h(this,mt,(a=o(this,R))==null?void 0:a.parent()),h(this,Oe,o(this,J)),o(this,R).on("change:parent",(r,s)=>{c(this,Ga,bn).call(this,r,s,this)})}renderProperties(e){const t=c(this,Ma,yn).call(this);e.addContentToAccordionGroup(o(this,q),t);const i=c(this,Si,no).call(this),a=c(this,wi,ro).call(this),r=c(this,Fa,mn).call(this),s=`<div id="dataAggregate-embeddedProps" data-group-context="${o(this,q)}">${i}${a}</div>`,l=`<div id="dataAggregate-originalProps" data-group-context="${o(this,q)}">${r}</div>`;e.addContentToAccordionGroup(o(this,q),`${s}`),e.addContentToAccordionGroup(o(this,q),`${l}`),(!o(this,J)||!o(this,Oe))&&$("#dataAggregate-embeddedProps").hide(),o(this,Oe)&&(e.changeCollapsibleGroupVisibility("label",!1),$("#dataAggregate-originalProps").hide()),$("#"+this.specificProperties.chooseEditMode.providedFeature).on("change checked",u=>{c(this,Wa,En).call(this,u,e,this)}),$("#"+this.specificProperties["dataAggregate-familyConfig"].providedFeature).click(()=>{o(this,ge).show()})}saveFamilyConfig(e){const i=$("#dataAggregate-familyConfig-table input[data-entity-property=dataAggregate-familyConfig-included]:checked").get().map(l=>l.value),r=$("#dataAggregate-familyConfig-table input[data-entity-property=dataAggregate-familyConfig-included]:not(:checked)").get().map(l=>l.value),s=e.getSelectedDataAggregateElement.attr("label/textWrap/text");for(const l of e.getDataAggregateList)i.includes(l.id)&&(s.localeCompare(l.attr("label/textWrap/text"))!==0&&l.attr("label/textWrap/text",s),l.prop("entity/properties/assignedFamily",s)),r.includes(l.id)&&(s.localeCompare(l.attr("label/textWrap/text"))===0&&l.attr("label/textWrap/text","Data Aggregate"),l.prop("entity/properties/assignedFamily",""))}get getCurrentParentId(){return o(this,mt)}get getDataAggregateList(){return o(this,Ci)}get getSelectedDataAggregateElement(){return o(this,R)}set setCurrentParentId(e){h(this,mt,e),h(this,J,!!e)}set setEmbeddedMode(e){h(this,Oe,e)}}q=new WeakMap,R=new WeakMap,ge=new WeakMap,Oe=new WeakMap,J=new WeakMap,mt=new WeakMap,Ci=new WeakMap,Ma=new WeakSet,yn=function(){const e=this.specificProperties.chooseEditMode,t=new j(e.providedFeature,o(this,q));return e.properties.checked=o(this,J),t.addSwitchElementWithLabels(e.labels,e.attributes,e.properties),t.getCreatedFormTemplate(!0)},Si=new WeakSet,no=function(){const e=this.specificProperties["dataAggregate-parentRelation"],t=new j(e.providedFeature,o(this,q));if(o(this,J)){const i=o(this,R).prop("entity/properties/embedded");i.parentId&&i.parentId===o(this,R).parent()?e.dropdownOptions.forEach(a=>{a.optionValue.localeCompare(i.parentRelation.toLowerCase())===0&&(a.selected=!0)}):o(this,R).prop("entity/properties/embedded",{parentId:"",parentRelation:""},{rewrite:!0,isolate:!0})}return e.properties.disabled=!o(this,J),e.attributes.svgRepresentation=c(this,za,vn).call(this),t.addDropdownElementWithLabelAndOptions(e.label,e.attributes,e.properties,e.dropdownOptions),t.getCreatedFormTemplate(!0,"before")},wi=new WeakSet,ro=function(){const e=this.specificProperties["dataAggregate-assignedFamily"],t=new j(e.providedFeature,o(this,q)),i=o(this,R).prop("entity/properties/assignedFamily");return e.attributes.value=i!=null?i:"",e.attributes.title=i||e.attributes.placeholder,t.addTextElementWithLabel(e.label,e.attributes,e.properties),t.getCreatedFormTemplate(!0)},Fa=new WeakSet,mn=function(){const e=this.specificProperties["dataAggregate-familyConfig"],t=new j(e.providedFeature,o(this,q));t._addButtonElementWithLabel(e.label,e.attributes,e.properties);let i=e.buttonActionContent;const a=c(this,La,fn).call(this);return i.dialogContent.content.groups.forEach(r=>{String("dataAggregate-familyConfig-table").localeCompare(r.id)===0&&(r.tableRows=a)}),i.dialogContent.header.text+=` ${o(this,R).attr("label/textWrap/text")}`,h(this,ge,new se("entity",e.providedFeature)),o(this,ge).create(i.dialogContent),o(this,ge).provideCloseButtonActionConfiguration("close"),o(this,ge).provideSaveButtonActionConfiguration(this.saveFamilyConfig,"close",this),o(this,ge).render("modals",!0,i.dialogSize),t.getCreatedFormTemplate(!0,"before")},La=new WeakSet,fn=function(){return o(this,R).graph.getElements().filter(i=>i.prop("entity/type")===d.DATA_AGGREGATE).map(i=>{o(this,Ci).push(i);let a=!0;const r=i.getParentCell();let s="-";r&&(a=!1,s=r.attr("label/textWrap/text"));let l=i.attr("label/textWrap/text").localeCompare(o(this,R).attr("label/textWrap/text"))===0;return{name:i.attr("label/textWrap/text")?i.attr("label/textWrap/text"):"-",familyName:i.prop("entity/properties/assignedFamily")?i.prop("entity/properties/assignedFamily"):"-",parent:s,previous:{contentType:E.CHECKBOX_WITHOUT_LABEL,disabled:!0,checked:l,id:i.id},included:{contentType:E.CHECKBOX_WITHOUT_LABEL,disabled:a,checked:l,id:i.id},attributes:{representationClass:a?"invalidOption":"validOption",disabled:a}}})},Ga=new WeakSet,bn=function(e,t,i){var r,s;if(!t||i.getCurrentParentId&&i.getCurrentParentId.localeCompare(t)===0)return;if(!e.parent()){$("#dataAggregate-embeddedProps").hide(),e.prop("entity/properties/embedded",{parentId:"",parentRelation:""},{rewrite:!0,isolate:!0}),i.setCurrentParentId="";return}i.setCurrentParentId=t,$("#dataAggregate-embeddedProps").empty();const a=c(r=i,Si,no).call(r)+c(s=i,wi,ro).call(s);$("#dataAggregate-embeddedProps").append(a),$("#"+i.specificProperties.chooseEditMode.providedFeature).click()},Wa=new WeakSet,En=function(e,t,i){if($("#"+i.specificProperties.chooseEditMode.providedFeature+"-leftLabel").toggleClass("text-muted"),e.target.checked){if(!o(this,J)){let a=new se("dataAggregate-editMode","change-dataAggregate-editMode");a.create($r()),a.render("modals",!0),a.show(),$("#"+e.target.id).prop("checked",!1);return}i.setEmbeddedMode=!0,t.changeCollapsibleGroupVisibility("label",!1),$("#dataAggregate-embeddedProps").show(),$("#dataAggregate-originalProps").hide()}else i.setEmbeddedMode=!1,t.changeCollapsibleGroupVisibility("label",!0),$("#dataAggregate-embeddedProps").hide(),$("#dataAggregate-originalProps").show()},za=new WeakSet,vn=function(){if(!o(this,J))return"";switch(o(this,R).graph.getCell(o(this,R).parent()).prop("entity/type")){case d.COMPONENT:return`<svg width="30" height="20">${wr()}</svg>`;case d.SERVICE:return`<svg width="30" height="20">${Ir()}</svg>`;case d.BACKING_SERVICE:return`<svg width="30" height="20">${kr()}</svg>`;case d.STORAGE_BACKING_SERVICE:return`<svg width="30" height="20">${Nr()}</svg>`;default:return""}};const Br=()=>({type:"modalDialog",header:{iconClass:"fa-solid fa-triangle-exclamation",type:"warning",text:"Warning",closeButton:!0},footer:{cancelButtonText:"Ok, understood"},content:{contentType:Y.SINGLE_TEXTBLOCK,text:`You have to embed the Backing Data entity in a Component, Service, Backing Service, Storage Backing Service or Infrastructure first
            before you can edit embedded properties.`}});var H,U,ye,ne,Pe,me,ft,Ii,qa,Tn,ki,so,Ha,xn,Ni,lo,Ua,Cn,ja,Sn,Xa,wn,ho,Rr,Va,In;class Dr{constructor(e,t=""){p(this,qa);p(this,ki);p(this,Ha);p(this,Ni);p(this,Ua);p(this,ja);p(this,Xa);p(this,ho);p(this,Va);p(this,H,"entity");p(this,U,{});p(this,ye,{});p(this,ne,{});p(this,Pe,!1);p(this,me,!1);p(this,ft,"");p(this,Ii,new Array);g(this,"specificProperties",{chooseEditMode:{providedFeature:"backingData-chooseEditMode",contentType:E.TOGGLE,labels:{headLabel:"<U>Edit Mode:</U>",leftLabel:"Original",rightLabel:"Embedded"},properties:{disabled:!1,required:!1,checked:!0},attributes:{helpText:{text:"Choose whether you want to modify the embedded element or the actual Backing Data entity."}}},"backingData-includedData":{providedFeature:"backingData-includedData",contentType:E.TABLE_DIALOG,label:"Included Data:",properties:{disabled:!1,required:!1},attributes:{buttonText:"Edit Included Data",buttonIconClass:"fa-solid fa-pencil"},buttonActionContent:{dialogSize:Nt.LARGE,dialogContent:{header:{svgRepresentation:`<svg width="30" height="20">${Fe()}</svg>`,text:"Backing Data Included Data: ",closeButton:!1},footer:{cancelButtonText:"Cancel",saveButtonIconClass:"fa-regular fa-floppy-disk",saveButtonText:"Save"},content:{contentType:Y.GROUP_FORMS,groups:[{id:"backingData-includedData-table",contentType:E.TABLE,headline:'Included Backing Data entities  ( <svg width="30" height="20">'+Fe()+"</svg>)",text:`The following table shows all data elements included in this Backing Data entity. In case you want to add a new entry, the following section provides two text element boxes you can use to 
                                provide the information and then add it using the plus button. However, your changes won't be saved or adopted until you clicked "Save". In case you cancel and change your entity selection, all 
                                your changes will be lost. While you keep the selection of this Backing Data entity, your changes will be remembered.`,tableColumnHeaders:[{text:"Key"},{text:"Value"}],tableRows:[]},{id:"backingData-includedData-form",contentType:E.FORMGROUP,headline:"Add New Data Item",contentItems:[{providedFeature:"includedData-key",contentType:E.INPUT_TEXTBOX_LABEL_PREPEND,label:"Key",properties:{disabled:!1,required:!0},attributes:{labelIcon:"fa-solid fa-key",placeholder:"e.g. My_SQL_Password",helpText:{text:"The key that identifies the following value item."},provideEditButton:!1,provideEnterButton:!1}},{providedFeature:"includedData-value",contentType:E.INPUT_TEXTBOX_LABEL_PREPEND,label:"Value",properties:{disabled:!1,required:!0},attributes:{labelIcon:"bi bi-chat-square-text-fill",placeholder:"e.g. mysqlpw",helpText:{text:"The value of this data item."},provideEditButton:!1,provideEnterButton:!1}},{providedFeature:"includedData-submit",contentType:E.BUTTON,label:"Submit",properties:{disabled:!1,required:!0},attributes:{labelIcon:"fa-solid fa-plus"}}]}]}}}},"backingData-assignedFamily":{providedFeature:"backingData-assignedFamily",contentType:E.INPUT_TEXTBOX,label:`Assigned <span><svg width="30" height="20">${Fe()}</svg></span>\u2013 Family:`,properties:{disabled:!0,readonly:!0,required:!1},attributes:{placeholder:"No family assigned",provideEditButton:!1}},"backingData-familyConfig":{providedFeature:"backingData-familyConfig",contentType:E.TABLE_DIALOG,label:"\u2013 Family:",properties:{disabled:!1,required:!1},attributes:{svgRepresentation:`<svg width="30" height="20">${Fe()}</svg>`,buttonText:"Edit Family",buttonIconClass:"fa-solid fa-pencil"},buttonActionContent:{dialogSize:Nt.LARGE,dialogContent:{header:{svgRepresentation:`<svg width="30" height="20">${Fe()}</svg>`,text:"Backing Data Family: ",closeButton:!1},footer:{cancelButtonText:"Cancel",saveButtonIconClass:"fa-regular fa-floppy-disk",saveButtonText:"Save"},content:{contentType:Y.GROUP_FORMS,groups:[{id:"backingData-familyConfig-table",contentType:E.TABLE,headline:"Included Data",text:`The following table shows all existing Backing Data entities within this System. You can select which ones of the following Backing Data entities you want to include in this
                                family. Note that if you select a Backing Data and save your changes, the labels of the selected Backing Data entities might change since they have to be equal to the family name.
                                Additionally, if you deselect entities that have previously been part of this family, their label will be reset to "Backing Data". However, your changes won't be adopted until you 
                                clicked "Save". In case you cancel and change your entity selection, all your changes will be lost. While you keep the selection of this Backing Data entity, your changes will be remembered.`,tableColumnHeaders:[{text:"Name"},{text:"Family Name"},{text:"Parent"},{text:"Formerly Included"},{text:"Include"}],tableRows:[]}]}}}}});var i,a;h(this,H,t),h(this,U,e),h(this,me,!!((i=o(this,U))!=null&&i.parent())),h(this,ft,(a=o(this,U))==null?void 0:a.parent()),h(this,Pe,o(this,me))}renderProperties(e){const t=c(this,qa,Tn).call(this);e.addContentToAccordionGroup(o(this,H),t);const i=c(this,ki,so).call(this),a=c(this,Ni,lo).call(this),r=c(this,Ua,Cn).call(this),s=`<div id="backingData-embeddedProps" data-group-context="${o(this,H)}">${i}${a}</div>`,l=`<div id="backingData-originalProps" data-group-context="${o(this,H)}">${r}</div>`;e.addContentToAccordionGroup(o(this,H),`${s}`),e.addContentToAccordionGroup(o(this,H),`${l}`),(!o(this,me)||!o(this,Pe))&&$("#backingData-embeddedProps").hide(),o(this,Pe)&&(e.changeCollapsibleGroupVisibility("label",!1),$("#backingData-originalProps").hide()),$("#"+this.specificProperties.chooseEditMode.providedFeature).on("change checked",u=>{c(this,Va,In).call(this,u,e,this)}),$("#"+this.specificProperties["backingData-familyConfig"].providedFeature).click(()=>{o(this,ye).show()}),$("#"+this.specificProperties["backingData-includedData"].providedFeature).click(()=>{o(this,ne).show()}),$("#includedData-submit").click(()=>{c(this,Xa,wn).call(this,this)})}saveFamilyConfig(e){const i=$("#backingData-familyConfig-table input[data-entity-property=backingData-familyConfig-included]:checked").get().map(l=>l.value),r=$("#backingData-familyConfig-table input[data-entity-property=backingData-familyConfig-included]:not(:checked)").get().map(l=>l.value),s=e.getSelectedBackingDataElement.attr("label/textWrap/text");for(const l of e.getBackingDataList)i.includes(l.id)&&(s.localeCompare(l.attr("label/textWrap/text"))!==0&&l.attr("label/textWrap/text",s),l.prop("entity/properties/assignedFamily",s)),r.includes(l.id)&&(s.localeCompare(l.attr("label/textWrap/text"))===0&&l.attr("label/textWrap/text","Backing Data"),l.prop("entity/properties/assignedFamily",""))}saveIncludedDataItems(e){let t=new Array,i=$("#backingData-includedData-table").find("tr");i.length>0&&i.each((a,r)=>{let s=$(r).find("[data-table-context=key]").text(),l=$(r).find("[data-table-context=value]").text();s&&l&&t.push({key:s,value:l})}),e.getSelectedBackingDataElement.prop("entity/properties/includedData",t)}get getCurrentParentId(){return o(this,ft)}get getBackingDataList(){return o(this,Ii)}get getModalDialogIncludedData(){return o(this,ne)}get getSelectedBackingDataElement(){return o(this,U)}set setCurrentParentId(e){h(this,ft,e),h(this,me,!!e)}set setEmbeddedMode(e){h(this,Pe,e)}}H=new WeakMap,U=new WeakMap,ye=new WeakMap,ne=new WeakMap,Pe=new WeakMap,me=new WeakMap,ft=new WeakMap,Ii=new WeakMap,qa=new WeakSet,Tn=function(){const e=this.specificProperties.chooseEditMode,t=new j(e.providedFeature,o(this,H));return e.properties.checked=o(this,me),t.addSwitchElementWithLabels(e.labels,e.attributes,e.properties),t.getCreatedFormTemplate(!0)},ki=new WeakSet,so=function(){const e=this.specificProperties["backingData-includedData"],t=new j(e.providedFeature,o(this,H));t._addButtonElementWithLabel(e.label,e.attributes,e.properties);let i=e.buttonActionContent;const a=c(this,Ha,xn).call(this);return i.dialogContent.content.groups.forEach(r=>{String("dataAggregate-familyConfig-table").localeCompare(r.id)===0&&(r.tableRows=a)}),i.dialogContent.header.text+=` ${o(this,U).attr("label/textWrap/text")}`,h(this,ne,new se("entity",e.providedFeature)),o(this,ne).create(i.dialogContent),o(this,ne).provideCloseButtonActionConfiguration("close"),o(this,ne).provideSaveButtonActionConfiguration(this.saveIncludedDataItems,"close",this),o(this,ne).render("modals",!0,i.dialogSize),t.getCreatedFormTemplate(!0,"before")},Ha=new WeakSet,xn=function(){return o(this,U).prop("entity/properties/includedData").map(i=>(console.log(i),{key:i.key,value:i.value}))},Ni=new WeakSet,lo=function(){const e=this.specificProperties["backingData-assignedFamily"],t=new j(e.providedFeature,o(this,H)),i=o(this,U).prop("entity/properties/assignedFamily");return e.attributes.value=i!=null?i:"",e.attributes.title=i||e.attributes.placeholder,t.addTextElementWithLabel(e.label,e.attributes,e.properties),t.getCreatedFormTemplate(!0)},Ua=new WeakSet,Cn=function(){const e=this.specificProperties["backingData-familyConfig"],t=new j(e.providedFeature,o(this,H));t._addButtonElementWithLabel(e.label,e.attributes,e.properties);let i=e.buttonActionContent;const a=c(this,ja,Sn).call(this);return i.dialogContent.content.groups.forEach(r=>{String("backingData-familyConfig-table").localeCompare(r.id)===0&&(r.tableRows=a)}),i.dialogContent.header.text+=` ${o(this,U).attr("label/textWrap/text")}`,h(this,ye,new se("entity",e.providedFeature)),o(this,ye).create(i.dialogContent),o(this,ye).provideCloseButtonActionConfiguration("close"),o(this,ye).provideSaveButtonActionConfiguration(this.saveFamilyConfig,"close",this),o(this,ye).render("modals",!0,i.dialogSize),t.getCreatedFormTemplate(!0,"before")},ja=new WeakSet,Sn=function(){return o(this,U).graph.getElements().filter(i=>i.prop("entity/type")===d.BACKING_DATA).map(i=>{o(this,Ii).push(i);let a=!0;const r=i.getParentCell();let s="-";r&&(a=!1,s=r.attr("label/textWrap/text"));let l=i.attr("label/textWrap/text").localeCompare(o(this,U).attr("label/textWrap/text"))===0;return{name:i.attr("label/textWrap/text")?i.attr("label/textWrap/text"):"-",familyName:i.prop("entity/properties/assignedFamily")?i.prop("entity/properties/assignedFamily"):"-",parent:s,previous:{contentType:E.CHECKBOX_WITHOUT_LABEL,disabled:!0,checked:l,id:i.id},included:{contentType:E.CHECKBOX_WITHOUT_LABEL,disabled:a,checked:l,id:i.id},attributes:{representationClass:a?"invalidOption":"validOption",disabled:a}}})},Xa=new WeakSet,wn=function(e){const t=e.getModalDialogIncludedData.getIncludedTable(this.specificProperties["backingData-includedData"].providedFeature),i=$("#includedData-key").val(),a=$("#includedData-value").val();if(!i||!a)return;const r=t.createRow({key:i,value:a});$("#backingData-includedData-tableBody").append(r),$("#includedData-key").val(""),$("#includedData-value").val("")},ho=new WeakSet,Rr=function(e,t,i){var r,s;if(!t||i.getCurrentParentId&&i.getCurrentParentId.localeCompare(t)===0)return;i.setCurrentParentId=t,$("#backingData-embeddedProps").empty();const a=c(r=i,ki,so).call(r)+c(s=i,Ni,lo).call(s);$("#backingData-embeddedProps").append(a),$("#"+i.specificProperties.chooseEditMode.providedFeature).click()},Va=new WeakSet,In=function(e,t,i){if($("#"+i.specificProperties.chooseEditMode.providedFeature+"-leftLabel").toggleClass("text-muted"),e.target.checked){if(!o(this,me)){let a=new se("backingData-editMode","change-backingData-editMode");a.create(Br()),a.render("modals",!0),a.show(),$("#"+e.target.id).prop("checked",!1);return}i.setEmbeddedMode=!0,t.changeCollapsibleGroupVisibility("label",!1),$("#backingData-embeddedProps").show(),$("#backingData-originalProps").hide()}else i.setEmbeddedMode=!1,t.changeCollapsibleGroupVisibility("label",!0),$("#backingData-embeddedProps").hide(),$("#backingData-originalProps").show()};const _r=joint.mvc.View.extend({className:"detailsSideBar",_previousDataAggregateSelection:"",_previousBackingDataSelection:"",_currentColourSelection:"",_currentEntitySelection:{},_propertyDetailsContainer:{},options:{paper:null,graph:null,detailsSidebarConfig:{}},events:{"change #data-aggregate":"dataAggregateSelectionChanged","change #backing-data":"backingDataSelectionChanged","entityPropertyChanged #entireDetailsAccordion":"handlePropertyChanged","entitySpecificPropertyChanged #entireDetailsAccordion":"handleEntityPropertyChanged","change #referredEndpoint":"handleRequestTraceExternalEndpointChanged","change #dataAggregate-parentRelation":"handleDataAggregateParentRelationChanged"},init(){if(!(this.options.paper instanceof joint.dia.Paper))throw new TypeError("DetailsSideBar: The provided current paper has to be a joint.dia.Paper element");this.options.graph=this.options.paper.model},render(){return this.renderGeneralItems(),this.renderGeneralProperties(),this.options.graph.on("add",this.addedEntity,this),this.options.graph.on("remove",this.removedEntity,this),this},renderEntitySelectionProperties(n){this._currentEntitySelection!==n&&($("#modals").empty(),this._currentEntitySelection=n,this.setCurrentValues(),this.renderEntitySpecificProperties(),this.listenTo(this._currentEntitySelection,"change:position",this.updateElementPosition))},hideEntitySelectionProperties(){this.stopListening(this._currentEntitySelection),this._currentEntitySelection=null,this._propertyDetailsContainer.changeVisibility(!1),$("#modals").empty(),this._currentColourSelection&&(this._currentColourSelection.attr({body:{fill:this._currentColourSelection.prop("defaults/fill"),stroke:this._currentColourSelection.prop("defaults/stroke"),strokeWidth:this._currentColourSelection.prop("defaults/strokeWidth")}}),this._currentColourSelection=null)},renderGeneralItems(){let n='<div class="sameEntityHighlighting"></div>';$(this.el).append(n),$(".sameEntityHighlighting").append('<div id="entityHighlightingTitle"><h6>Entity Highlighting</h6></div>'),$(".sameEntityHighlighting").append('<form class="sameEntityHighlighting-Form"></form>'),this.options.detailsSidebarConfig.EntityHighlighting.forEach(e=>{this.renderEntitySelectionHighlighting(e.type,e.labelText,e.svgRepresentation)})},renderEntitySelectionHighlighting(n="",e="",t=""){let i='<fieldset id="'+n+'-fieldset"></fieldset>';$(".sameEntityHighlighting-Form").append(i);let a='<div id="'+n+'-highlightingGroup" class="form-group"></div>';$("#"+n+"-fieldset").append(a);let r='<label id="'+n+'-label" for="'+n+'"><span>'+t+"</span>"+e+"</label>";$("#"+n+"-highlightingGroup").append(r);let s='<select class="entityHighlightingOption custom-select" id="'+n+'"></select>';$("#"+n+"-highlightingGroup").append(s);let l='<option value="">Choose existing entity...</option>';$("#"+n).append(l),$("#"+n+"-fieldset").prop("disabled",!0)},renderGeneralProperties(){this._propertyDetailsContainer=new Cr(this.el,"detailsSidebar","entireDetailsAccordion","Entity Properties"),this._propertyDetailsContainer.create("otherEntityDetailsTitle");let n=this.options.detailsSidebarConfig.GeneralProperties;Object.keys(n).forEach(e=>{this.renderPropertyGroups(e,n[e].iconClass,n[e].headline)})},renderPropertyGroups(n="",e="",t=""){this._propertyDetailsContainer.addCollapsibleAccordionGroup(n,e,t);for(const i of this.options.detailsSidebarConfig.GeneralProperties[n].options){if(i.contentType===E.INFO){this.renderPropertyInformation(n,i.providedFeature,i.content);continue}this.renderPropertyForm(n,i.providedFeature,i.label,i.contentType,i.attributes,i.properties)}},renderPropertyInformation(n="",e="",t=""){let i=t.iconClass?'<i class="'+t.iconClass+'" style="margin-right: 10px;"></i>':"",a='<p id="'+e+'" class="text-muted">'+i+t.text+"</p>";this._propertyDetailsContainer.addContentToAccordionGroup(n,a)},renderPropertyForm(n="",e="",t="",i="",a={},r={}){const s=new j(e,n);switch(i){case E.TEXTAREA:s._addTextAreaElementWithLabel(t,a,r),s._addFormFeedbackSection("Reset: Invalid input provided","Successfully changed.");const m=s.getCreatedFormTemplate(!0);this._propertyDetailsContainer.addContentToAccordionGroup(n,m),s.configureEnterButtonBehaviour();return;case E.INPUT_NUMBERBOX:s.addNumberElementWithLabel(t,a,r),s._addFormFeedbackSection("Reset: Invalid input provided","Successfully changed.");const f=s.getCreatedFormTemplate(!0);this._propertyDetailsContainer.addContentToAccordionGroup(n,f),s.configureEnterButtonBehaviour();return;case E.INPUT_TEXTBOX:s.addTextElementWithLabel(t,a,r),s._addFormFeedbackSection("Reset: Invalid input provided","Successfully changed.");const T=s.getCreatedFormTemplate(!0);this._propertyDetailsContainer.addContentToAccordionGroup(n,T),s.configureEnterButtonBehaviour();return;case E.CHECKBOX:s._addCheckboxElementWithLabel(t,a,r),s._addFormFeedbackSection("Reset: Invalid input provided","Successfully changed.");const x=s.getCreatedFormTemplate(!0,"",!0);this._propertyDetailsContainer.addContentToAccordionGroup(n,x),s.configureEnterButtonBehaviour();return;case E.DROPDOWN:s.addDropdownElementWithLabelAndOptions(t,a,r,new Array),s._addFormFeedbackSection("Reset: Invalid input provided","Successfully changed.");const w=s.getCreatedFormTemplate(!0);this._propertyDetailsContainer.addContentToAccordionGroup(n,w),s.configureEnterButtonBehaviour();return;case E.INPUT_LIST:s._addDataListElementWithLabel(t,a,r,new Array),s._addFormFeedbackSection("Reset: Invalid input provided","Successfully changed.");const b=s.getCreatedFormTemplate(!0);this._propertyDetailsContainer.addContentToAccordionGroup(n,b),s.configureEnterButtonBehaviour();return}let l=new j(e,n),u=l.create(!0);switch(this._propertyDetailsContainer.addContentToAccordionGroup(n,u),i){case E.INPUT_RANGE:l.addInputRangeElementWithLabel(t,a,r);break;default:l.addInputTextElementWithLabel(t,a,r);break}l.addFormFeedbackSection("Reset: Invalid input provided","Successfully changed.")},setCurrentValues(){this._currentEntitySelection.isElement()&&this.setGeneralPropertiesValues(),this._propertyDetailsContainer.changeVisibility(),this._currentEntitySelection.isLink()?this._propertyDetailsContainer.changeVisibilityExceptGroupId("entity",!1):this._currentEntitySelection.prop("entity/isEmbedded")&&this._currentEntitySelection.prop("entity/isEmbedded")===!0?this._propertyDetailsContainer.changeCollapsibleGroupVisibility("position",!1):this._propertyDetailsContainer.showAllCollapsibleGroups()},setGeneralPropertiesValues(){Object.keys(_).forEach(n=>{let e=_[n],t=e.isProperty?this._currentEntitySelection.prop(e.modelPath):this._currentEntitySelection.attr(e.modelPath);if(n==="entity-aspect-ratio"){const i=this._currentEntitySelection.prop("defaults/size");let a=" (h ~ "+(i.height/i.width).toFixed(2)+" * w).";$("#entity-height-helpText").text(e.helpText+a);return}$("#"+n).val(t),$("#"+n).trigger("change")})},renderEntitySpecificProperties(){switch(this._emptyEntitySpecificProperties(),this._currentEntitySelection.prop("entity/type")){case d.REQUEST_TRACE:new Sr(this._currentEntitySelection,"entity").renderProperties(this._propertyDetailsContainer);const e=this._currentEntitySelection.prop("entity/properties/referredEndpoint");e&&this._highlightElement(this._currentEntitySelection.graph.getCell(e)),this._propertyDetailsContainer.changeCollapsibleGroupVisibility("entity",!0);return;case d.DATA_AGGREGATE:new Ar(this._currentEntitySelection,"entity").renderProperties(this._propertyDetailsContainer),this._propertyDetailsContainer.changeCollapsibleGroupVisibility("entity",!0);return;case d.BACKING_DATA:new Dr(this._currentEntitySelection,"entity").renderProperties(this._propertyDetailsContainer),this._propertyDetailsContainer.changeCollapsibleGroupVisibility("entity",!0);return}for(const n of Object.keys(bo)){let e=bo[n];if(e.type===this._currentEntitySelection.prop("entity/type")){if(e.specificProperties==0){this._propertyDetailsContainer.changeCollapsibleGroupVisibility("entity",!1);break}for(const t of e.specificProperties){this.renderPropertyForm("entity",t.providedFeature,t.label,t.contentType,t.attributes,t.properties);let i=this._currentEntitySelection.prop("entity/properties/"+t.providedFeature);$("#"+t.providedFeature).val(i)}this._propertyDetailsContainer.changeCollapsibleGroupVisibility("entity",!0);break}}},_emptyEntitySpecificProperties(){let n=[];this.options.detailsSidebarConfig.GeneralProperties.entity.options.forEach(e=>{n.push(e.providedFeature)}),this._propertyDetailsContainer.emptyContentOfAccordionGroup("entity",n)},addedEntity(n){n.prop("entity/type")==d.DATA_AGGREGATE?this._addDropDownOption(d.DATA_AGGREGATE,n.attr("label/textWrap/text"),n.cid,n.id):n.prop("entity/type")==d.BACKING_DATA&&this._addDropDownOption(d.BACKING_DATA,n.attr("label/textWrap/text"),n.cid,n.id)},removedEntity(n){n.prop("entity/type")==d.DATA_AGGREGATE?this._removeDropDownOption(d.DATA_AGGREGATE,n.id):n.prop("entity/type")==d.BACKING_DATA&&this._removeDropDownOption(d.BACKING_DATA,n.id),this._currentEntitySelection&&n.id===this._currentEntitySelection.id&&this.hideEntitySelectionProperties()},_addDropDownOption(n,e,t,i){let a='<option value="'+i+'">'+e+" (CID: "+t+")</option>";$("#"+n).append(a),$("#"+n+"-fieldset").prop("disabled")&&($("#"+n+"-fieldset").prop("disabled",!1),$("#"+n+"-highlightingRepresentation").css("opacity",1))},_removeDropDownOption(n,e){$("#"+n+" option").filter("[value="+e+"]").remove(),$("#"+n+" option").length<=1&&($("#"+n+"-fieldset").prop("disabled",!0),$("#"+n+"-highlightingRepresentation").css("opacity",.4))},dataAggregateSelectionChanged(n){if(this._previousDataAggregateSelection&&this._previousDataAggregateSelection.attr("body/fill","white"),!joint.util.isEmpty(n.target.value)){if(this._previousDataAggregateSelection=this.options.graph.getCell(n.target.value),!this._previousDataAggregateSelection)throw new Error("The chosen Data Aggregate entity does not exist.");let e=this.options.detailsSidebarConfig.EntityHighlighting.find(t=>t.type==d.DATA_AGGREGATE);this._previousDataAggregateSelection.attr("body/fill",e.highlightColour)}},backingDataSelectionChanged(n){if(this._previousBackingDataSelection&&this._previousBackingDataSelection.attr("body/fill","white"),!joint.util.isEmpty(n.target.value)){if(this._previousBackingDataSelection=this.options.graph.getCell(n.target.value),!this._previousBackingDataSelection)throw new Error("The chosen Backing Data entity does not exist.");let e=this.options.detailsSidebarConfig.EntityHighlighting.find(t=>t.type==d.BACKING_DATA);this._previousBackingDataSelection.attr("body/fill",e.highlightColour)}},handlePropertyChanged(n){let e=$("#"+n.propertyId),t=e.val();if(this._validateNewPropertyValue(t,_[n.propertyId])===!1){let i=_[n.propertyId].isProperty?this._currentEntitySelection.prop(_[n.propertyId].modelPath):this._currentEntitySelection.attr(_[n.propertyId].modelPath);e.val(i),e.trigger("change"),$("#"+n.originalTarget.parentElement.parentElement.id+" .invalid-feedback").show(),e.addClass("is-invalid");return}if(_[n.propertyId].hasProvidedMethod)switch(n.propertyType){case"position":const i=this._currentEntitySelection.position(),a=this.options.paper.getArea();let r=i.x,s=i.y;n.propertyId.split("-").includes("x")?r=Number(t):n.propertyId.split("-").includes("y")&&(s=Number(t)),this._currentEntitySelection.position(r,s,{deep:!0,restrictedArea:a});break;case"size":const l=this._currentEntitySelection.size();let u=l.width,m=l.height;n.propertyId.split("-").includes("width")?u=Number(t):n.propertyId.split("-").includes("height")&&(m=Number(t));const f=this._currentEntitySelection.prop("defaults/size"),T=f.height/f.width;m=Number((T*u).toFixed(2)),console.log(this._currentEntitySelection.prop("defaults/size")),console.log(u+" "+m),this._currentEntitySelection.resize(u,m,{deep:!0})}else if(_[n.propertyId].isProperty)this._currentEntitySelection.prop(_[n.propertyId].modelPath,t);else{if(this._currentEntitySelection.prop("entity/type")===d.BACKING_DATA&&"entity-text".localeCompare(n.propertyId)===0&&this._currentEntitySelection.prop("entity/properties/assignedFamily")){const i=this.options.graph.getElements().filter(a=>a.prop("entity/type")===d.BACKING_DATA&&a.attr(_[n.propertyId].modelPath).localeCompare(this._currentEntitySelection.attr(_[n.propertyId].modelPath))===0);for(const a of i)a.attr(_[n.propertyId].modelPath,t)}else if(this._currentEntitySelection.prop("entity/type")===d.DATA_AGGREGATE&&"entity-text".localeCompare(n.propertyId)===0&&this._currentEntitySelection.prop("entity/properties/assignedFamily")){const i=this.options.graph.getElements().filter(a=>a.prop("entity/type")===d.DATA_AGGREGATE&&a.attr(_[n.propertyId].modelPath).localeCompare(this._currentEntitySelection.attr(_[n.propertyId].modelPath))===0);for(const a of i)a.attr(_[n.propertyId].modelPath,t)}this._currentEntitySelection.attr(_[n.propertyId].modelPath,t)}$("#"+n.originalTarget.parentElement.parentElement.id+" .valid-feedback").show(),e.addClass("is-valid")},handleEntityPropertyChanged(n){let e=$("#"+n.propertyId).val();this._currentEntitySelection.prop("entity/properties/"+n.propertyId,e),$("#"+n.originalTarget.parentElement.parentElement.id+" .valid-feedback").show(),$("#"+n.propertyId).addClass("is-valid")},handleRequestTraceExternalEndpointChanged(n){if(!joint.util.isEmpty(n.target.value)){const e=this.options.graph.getCell(n.target.value);if(!e&&e.isLink())throw new Error("The chosen External Endpoint entity does not exist.");this._highlightElement(e),this._currentEntitySelection.prop("entity/properties/referredEndpoint",n.target.value),$("#"+n.target.id).addClass("is-valid")}},handleDataAggregateParentRelationChanged(n){!joint.util.isEmpty(n.target.value)&&this._currentEntitySelection.parent()&&(this._currentEntitySelection.prop("entity/properties/embedded",{parentId:this._currentEntitySelection.parent(),parentRelation:n.target.value},{rewrite:!0,isolate:!0}),$("#"+n.target.id).addClass("is-valid"))},updateElementPosition(n){if($("#collapse-position").hasClass("show")===!1)return;let e=n.position();$("#entity-x-position").val(e.x),$("#entity-y-position").val(e.y)},_highlightElement(n){this._currentColourSelection=n,this._currentColourSelection.attr({body:{stroke:cr.entityHighlighting,strokeWidth:3}})},_validateNewPropertyValue(n,e){if(!n||n<=0)return!1;if(e.minPath){let t=this._currentEntitySelection.prop(e.minPath);return n>=t}return e.min?n>=Number(e.min):!0},close(){}}),Or={Component:{index:1,shape:new joint.shapes.qualityModel.Component({position:{x:20,y:26},size:{width:100,height:45},attrs:{root:{title:"cna.qualityModel.Component"},body:{class:"entityHighlighting"},label:{fontSize:11,textWrap:{text:"Component"}}}})},Service:{index:2,shape:new joint.shapes.qualityModel.Service({position:{x:145,y:18},size:{width:80,height:45},attrs:{root:{title:"cna.qualityModel.Service"},body:{class:"entityHighlighting"},label:{fontSize:11,textWrap:{text:"Service"}}}})},BackingService:{index:3,shape:new joint.shapes.qualityModel.BackingService({position:{x:20,y:100},size:{width:100,height:45},attrs:{root:{title:"cna.qualityModel.BackingService"},body:{class:"entityHighlighting"},label:{fontSize:11,textWrap:{text:"Backing Service"}}}})},StorageBackingService:{index:4,shape:new joint.shapes.qualityModel.StorageBackingService({position:{x:145,y:100},size:{width:80,height:60},attrs:{root:{title:"cna.qualityModel.StorageBackingService"},body:{class:"entityHighlighting"},label:{fontSize:11,textWrap:{text:"Storage Backing Service"}}}})},Endpoint:{index:5,shape:new joint.shapes.qualityModel.Endpoint({position:{x:41,y:182},size:{width:55,height:55},attrs:{root:{title:"cna.qualityModel.Endpoint"},body:{class:"entityHighlighting"},label:{fontSize:11,textWrap:{text:"Endpoint"}}}})},ExternalEndpoint:{index:6,shape:new joint.shapes.qualityModel.ExternalEndpoint({position:{x:155,y:182},size:{width:55,height:55},attrs:{root:{title:"cna.qualityModel.ExternalEndpoint"},body:{class:"entityHighlighting"},label:{fontSize:11,textWrap:{text:"External Endpoint"}}}})},Infrastructure:{index:7,shape:new joint.shapes.qualityModel.Infrastructure({position:{x:20,y:264},size:{width:100,height:45},attrs:{root:{title:"cna.qualityModel.Infrastructure"},body:{class:"entityHighlighting"},label:{fontSize:11,textWrap:{text:"Infrastructure"}}}})},DataAggregate:{index:8,shape:new joint.shapes.qualityModel.DataAggregate({position:{x:140,y:264},size:{width:45,height:25},attrs:{root:{title:"cna.qualityModel.DataAggregate"},body:{class:"entityHighlighting"},label:{fontSize:11,textWrap:{text:"Data Aggregate"}}}})},RequestTrace:{index:9,shape:new joint.shapes.qualityModel.RequestTrace({position:{x:18,y:348},size:{width:110,height:45},attrs:{root:{title:"cna.qualityModel.RequestTrace"},body:{class:"entityHighlighting"},label:{fontSize:11,textWrap:{text:"Request Trace"}}}})},BackingData:{index:10,shape:new joint.shapes.qualityModel.BackingData({position:{x:147,y:346},size:{width:80,height:60},attrs:{root:{title:"cna.qualityModel.BackingData"},body:{class:"entityHighlighting"},label:{fontSize:11,textWrap:{text:"Backing Data"}}}})},Link:{index:11,shape:new joint.shapes.qualityModel.Link({source:{x:20,y:434},target:{x:120,y:434},labels:[{attrs:{rect:{fill:"none"},text:{text:"Link"}},position:{ref:"text",offset:18}}],attrs:{root:{title:"cna.qualityModel.Link"},wrapper:{cursor:"move",class:"sidebarConnection"}}})},DeploymentMapping:{index:12,shape:new joint.shapes.qualityModel.DeploymentMapping({source:{x:145,y:434},target:{x:225,y:434},labels:[{attrs:{rect:{fill:"none"},text:{text:joint.util.breakText("Deployment Mapping",{width:"100"})}},position:{ref:"text",offset:22}}],attrs:{root:{title:"cna.qualityModel.DeploymentMapping"},wrapper:{cursor:"move",class:"sidebarConnection"}}})}},Pr=joint.mvc.View.extend({className:"modelingAppMainView",mainPaper:null,options:{modelingAreaGraph:null,currentSystemName:""},init(){if(!(this.options.modelingAreaGraph instanceof joint.dia.Graph))throw new TypeError("ModelingAppMainView: The provided graph has to be a joint.dia.Graph element");this.initializeModelingArea(this.options.modelingAreaGraph),this.initializeToolbar(this.mainPaper),this.initializeEntitySidebar(this.mainPaper),this.initializeDetailsSidebar(this.mainPaper)},initializeModelingArea(n){if(!(n instanceof joint.dia.Graph))throw new TypeError("ModelingAppMainView: The provided graph has to be a joint.dia.Graph element");let e=new yr({graph:n});e.render(),this.mainPaper=e.getPaper()},initializeToolbar(n){if(!(n instanceof joint.dia.Paper))throw new TypeError("ModelingAppMainView: The provided paper has to be a joint.dia.Paper element");let e=new an;new fr(this.$(".app-header"),n,dr,e,this.options.currentSystemName).render()},initializeEntitySidebar(n){if(!(n instanceof joint.dia.Paper))throw new TypeError("ModelingAppMainView: The provided paper has to be a joint.dia.Paper element");new xr({paper:n,documentElement:this.$(".entityShapes-sidebar-container"),sidebarEntityConfig:Or}).render()},initializeDetailsSidebar(n){if(!(n instanceof joint.dia.Paper))throw new TypeError("ModelingAppMainView: The provided paper has to be a joint.dia.Paper element");const e=new _r({el:this.$(".details-container"),paper:n,detailsSidebarConfig:pr});e.render(),this.listenTo(this.mainPaper,"cell:pointerdown",t=>{e.renderEntitySelectionProperties(t.model)}),this.listenTo(this.mainPaper,"blank:pointerdown",()=>{e.hideEntitySelectionProperties()}),this.listenTo(this.mainPaper,"blank:contextmenu",()=>{e.hideEntitySelectionProperties()})}});var bt,Me,$i,Ka,kn,Ja,Nn,Ai,po;class Mr{constructor(){p(this,Ka);p(this,Ja);p(this,Ai);g(this,"use strict");p(this,bt,"");p(this,Me,null);p(this,$i,null);h(this,Me,new joint.dia.Graph),h(this,$i,new ur(o(this,Me)))}renderInto(e){const t=new Dn;e.insertAdjacentHTML("beforeend",t.getApplicationFrameTemplate()),document.getElementById("app").addEventListener("openModelingApplicationOverlay",()=>{document.getElementById("init-overlay").style.display="block",$("#appToolbarContainer button").attr("disabled",!0)}),document.getElementById("createNewDiagramBtn").onclick=()=>{document.getElementById("init-firstInformation").style.display="none",document.getElementById("startModelingForm").style.display="block"},c(this,Ka,kn).call(this),c(this,Ja,Nn).call(this,t.getApplicationNameElementId),new Pr({el:"#app",modelingAreaGraph:o(this,Me),currentSystemName:this.getCurrentSystemName}),this.getCurrentSystemName&&$("#appNameTitle").val(this.getCurrentSystemName),$("#appNameTitle").on("systemNameChanged",i=>{this.setCurrentSystemName=i.updatedSystemName}),$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip(),$('[data-tooltip-toggle="tooltip"]').tooltip()})}getModeledSystemEntity(){return o(this,$i).getCurrentSystemEntity}get getCurrentSystemName(){return o(this,bt)}set setCurrentSystemName(e){!e||(o(this,bt)||($("#appNameTitle").trigger({type:"initialSystemName",systemName:e}),o(this,Me).trigger("initialSystemName",{systemName:e})),h(this,bt,e))}}bt=new WeakMap,Me=new WeakMap,$i=new WeakMap,Ka=new WeakSet,kn=function(){document.getElementById("startModelingBtn").onclick=()=>{c(this,Ai,po).call(this)}},Ja=new WeakSet,Nn=function(e){document.getElementById(e).addEventListener("keydown",t=>{var i;((i=t.key)==null?void 0:i.localeCompare("Enter"))===0&&(t.preventDefault(),c(this,Ai,po).call(this))})},Ai=new WeakSet,po=function(){let e=$("#applicationNameInputField").val(),t=$("#init-overlay .needs-validation");for(const i of t)i.classList.add("was-validated");!e||(this.setCurrentSystemName=e,$("#appNameTitle").val(e),$("#init-overlay").toggle(),$("#appToolbarContainer button").attr("disabled",!1))};class Fr{renderInto(e){e.insertAdjacentHTML("beforeend",this.getHomepageCreatedTemplate())}getHomepageCreatedTemplate(){return`<div class="jumbotron jumbotron-fluid text-center">
        <div class="container-fluid">
            <h1>Welcome</h1>
            <p>This web application includes a prototypical implementation of a modeling application. Please select the "Modeling Application" Tab in case you want to try it out.</p>
        </div>
    </div>
    <div class="container-fluid h-100">
    <div>`}}const We=document.querySelector("main"),mo=new Mr,co=new Fr,Lr=document.querySelectorAll("a[data-entry-module]"),Wi=new Map;for(const n of Lr)Wi.set(n.dataset.menuIndex,n.parentNode),n.addEventListener("click",async e=>{e.preventDefault();const t=document.querySelector("li.active");t==null||t.classList.remove("active"),n.parentNode.classList.add("active"),We.innerHTML="",document.title="CNA Modeling:",n.dataset.entryModule.includes("ModelingApp")?(mo.renderInto(We),sessionStorage.setItem("currentMenuSelectionIndex",n.dataset.menuIndex),Gr(),document.title+=" Modeling Application"):(co.renderInto(We),sessionStorage.setItem("currentMenuSelectionIndex",n.dataset.menuIndex),document.title+=" Home")});window.onload=()=>{var n,e,t,i;switch(document.title="CNA Modeling:",sessionStorage.getItem("currentMenuSelectionIndex")){case"1":(n=Wi.get("1"))==null||n.classList.add("active"),co.renderInto(We),document.title+=" Home",sessionStorage.setItem("currentMenuSelectionIndex","1");break;case"2":(e=Wi.get("2"))==null||e.classList.add("active"),mo.renderInto(We),document.title+=" Modeling Application",sessionStorage.setItem("currentMenuSelectionIndex","2");const a=new Event("openModelingApplicationOverlay");(t=document.getElementById("app"))==null||t.dispatchEvent(a);break;default:(i=Wi.get("1"))==null||i.classList.add("active"),co.renderInto(We),document.title+=" Home",sessionStorage.setItem("currentMenuSelectionIndex","1");break}};const Gr=()=>{var n;if(!sessionStorage.getItem("reloadModelingApplication")){const e=new Event("openModelingApplicationOverlay");(n=document.getElementById("app"))==null||n.dispatchEvent(e),sessionStorage.setItem("reloadModelingApplication",!0)}};document.querySelector("a.navbar-brand").addEventListener("click",n=>{console.log(mo.getModeledSystemEntity())});
